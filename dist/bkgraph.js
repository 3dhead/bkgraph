/**
 * almond 0.2.5 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

// (c) 2010-2013 Thomas Fuchs

// Zepto.js may be freely distributed under the MIT license.

/*!
 * ZRender, a high performance canvas library.
 *  
 * Copyright (c) 2013, Baidu Inc.
 * All rights reserved.
 * 
 * LICENSE
 * https://github.com/ecomfe/zrender/blob/master/LICENSE.txt
 */

/**
 * ETPL (Enterprise Template)
 * Copyright 2013 Baidu Inc. All rights reserved.
 *
 * @file 模板引擎
 * @author errorrik(errorrik@gmail.com)
 *         otakustay(otakustay@gmail.com)
 */

/*!
 * Sizzle CSS Selector Engine v@VERSION
 * http://sizzlejs.com/
 *
 * Copyright 2008, 2014 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: @DATE
 */

(function(e){typeof define!="undefined"&&define.amd?define(["exports"],e):e(window.bkgraph={})})(function(e){var t,n,r;(function(e){function d(e,t){return h.call(e,t)}function v(e,t){var n,r,i,s,o,u,a,f,c,h,p=t&&t.split("/"),d=l.map,v=d&&d["*"]||{};if(e&&e.charAt(0)===".")if(t){p=p.slice(0,p.length-1),e=p.concat(e.split("/"));for(f=0;f<e.length;f+=1){h=e[f];if(h===".")e.splice(f,1),f-=1;else if(h===".."){if(f===1&&(e[2]===".."||e[0]===".."))break;f>0&&(e.splice(f-1,2),f-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((p||v)&&d){n=e.split("/");for(f=n.length;f>0;f-=1){r=n.slice(0,f).join("/");if(p)for(c=p.length;c>0;c-=1){i=d[p.slice(0,c).join("/")];if(i){i=i[r];if(i){s=i,o=f;break}}}if(s)break;!u&&v&&v[r]&&(u=v[r],a=f)}!s&&u&&(s=u,o=a),s&&(n.splice(0,o,s),e=n.join("/"))}return e}function m(t,n){return function(){return s.apply(e,p.call(arguments,0).concat([t,n]))}}function g(e){return function(t){return v(t,e)}}function y(e){return function(t){a[e]=t}}function b(t){if(d(f,t)){var n=f[t];delete f[t],c[t]=!0,i.apply(e,n)}if(!d(a,t)&&!d(c,t))throw new Error("No "+t);return a[t]}function w(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function E(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=Object.prototype.hasOwnProperty,p=[].slice;o=function(e,t){var n,r=w(e),i=r[0];return e=r[1],i&&(i=v(i,t),n=b(i)),i?n&&n.normalize?e=n.normalize(e,g(t)):e=v(e,t):(e=v(e,t),r=w(e),i=r[0],e=r[1],i&&(n=b(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return m(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:E(e)}}},i=function(t,n,r,i){var s,l,h,p,v,g=[],w;i=i||t;if(typeof r=="function"){n=!n.length&&r.length?["require","exports","module"]:n;for(v=0;v<n.length;v+=1){p=o(n[v],i),l=p.f;if(l==="require")g[v]=u.require(t);else if(l==="exports")g[v]=u.exports(t),w=!0;else if(l==="module")s=g[v]=u.module(t);else if(d(a,l)||d(f,l)||d(c,l))g[v]=b(l);else{if(!p.p)throw new Error(t+" missing "+l);p.p.load(p.n,m(i,!0),y(l),{}),g[v]=a[l]}}h=r.apply(a[t],g);if(t)if(s&&s.exports!==e&&s.exports!==a[t])a[t]=s.exports;else if(h!==e||!w)a[t]=h}else t&&(a[t]=r)},t=n=s=function(t,n,r,a,f){return typeof t=="string"?u[t]?u[t](n):b(o(t,n).f):(t.splice||(l=t,n.splice?(t=n,n=r,r=null):t=e),n=n||function(){},typeof r=="function"&&(r=a,a=f),a?i(e,t,n,r):setTimeout(function(){i(e,t,n,r)},4),s)},s.config=function(e){return l=e,l.deps&&s(l.deps,l.callback),s},r=function(e,t,n){t.splice||(n=t,t=[]),!d(a,e)&&!d(f,e)&&(f[e]=[e,t,n])},r.amd={jQuery:!0}})(),r("text",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),r("text!bkgraph/util/asciiEcharts",[],function(){return"███████╗ ██████╗██╗  ██╗ █████╗ ██████╗ ████████╗███████╗\n██╔════╝██╔════╝██║  ██║██╔══██╗██╔══██╗╚══██╔══╝██╔════╝\n█████╗  ██║     ███████║███████║██████╔╝   ██║   ███████╗\n██╔══╝  ██║     ██╔══██║██╔══██║██╔══██╗   ██║   ╚════██║\n███████╗╚██████╗██║  ██║██║  ██║██║  ██║   ██║   ███████║\n╚══════╝ ╚═════╝╚═╝  ╚═╝╚═╝  ╚═╝╚═╝  ╚═╝   ╚═╝   ╚══════╝"}),r("zrender/core/util",["require"],function(e){function r(e){return e&&e.nodeType===1&&typeof e.nodeName=="string"}function i(e,s){if(typeof e=="object"&&e!==null){var o=e;if(e instanceof Array){o=[];for(var u=0,a=e.length;u<a;u++)o[u]=s?i(e[u],s):e[u]}else if(!t[n.call(e)]&&!r(e)){o={};for(var f in e)e.hasOwnProperty(f)&&(o[f]=s?i(e[f],s):e[u])}return o}return e}function s(e,i,o,u){typeof u=="undefined"&&(u=!0);if(!e)return;for(var a in i)if(i.hasOwnProperty(a)){var f=e[a];if(u&&typeof f=="object"&&!t[n.call(f)]&&!r(f))s(e[a],i[a],o,u);else if(o||!(a in e))e[a]=i[a]}return e}function u(){return o||(o=document.createElement("canvas").getContext("2d")),o}function a(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function f(e,t){function r(){}var n=e.prototype;r.prototype=t.prototype,e.prototype=new r;for(var i in n)e.prototype[i]=n[i];e.constructor=e}function l(e){if(!e)return;return typeof e=="string"?!1:typeof e.length=="number"}var t={"[object Function]":1,"[object RegExp]":1,"[object Date]":1,"[object Error]":1,"[object CanvasGradient]":1},n=Object.prototype.toString,o;return{inherits:f,clone:i,merge:s,getContext:u,indexOf:a,isArrayLike:l}}),r("zrender/config",[],function(){var e={EVENT:{RESIZE:"resize",CLICK:"click",DBLCLICK:"dblclick",MOUSEWHEEL:"mousewheel",MOUSEMOVE:"mousemove",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",GLOBALOUT:"globalout",DRAGSTART:"dragstart",DRAGEND:"dragend",DRAGENTER:"dragenter",DRAGOVER:"dragover",DRAGLEAVE:"dragleave",DROP:"drop",touchClickDelay:300},debugMode:0,devicePixelRatio:Math.max(window.devicePixelRatio||1,1)};return e}),r("zrender/core/log",["require","../config"],function(e){var t=e("../config");return function(){if(t.debugMode===0)return;if(t.debugMode==1)for(var e in arguments)throw new Error(arguments[e]);else if(t.debugMode>1)for(var e in arguments)console.log(arguments[e])}}),r("zrender/core/guid",[],function(){var e=2311;return function(){return"zr_"+e++}}),r("zrender/core/env",[],function(){function e(e){var t=this.os={},n=this.browser={},r=e.match(/Web[kK]it[\/]{0,1}([\d.]+)/),i=e.match(/(Android);?[\s\/]+([\d.]+)?/),s=e.match(/(iPad).*OS\s([\d_]+)/),o=e.match(/(iPod)(.*OS\s([\d_]+))?/),u=!s&&e.match(/(iPhone\sOS)\s([\d_]+)/),a=e.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),f=a&&e.match(/TouchPad/),l=e.match(/Kindle\/([\d.]+)/),c=e.match(/Silk\/([\d._]+)/),h=e.match(/(BlackBerry).*Version\/([\d.]+)/),p=e.match(/(BB10).*Version\/([\d.]+)/),d=e.match(/(RIM\sTablet\sOS)\s([\d.]+)/),v=e.match(/PlayBook/),m=e.match(/Chrome\/([\d.]+)/)||e.match(/CriOS\/([\d.]+)/),g=e.match(/Firefox\/([\d.]+)/),y=e.match(/MSIE ([\d.]+)/),b=r&&e.match(/Mobile\//)&&!m,w=e.match(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/)&&!m,y=e.match(/MSIE\s([\d.]+)/);if(n.webkit=!!r)n.version=r[1];return i&&(t.android=!0,t.version=i[2]),u&&!o&&(t.ios=t.iphone=!0,t.version=u[2].replace(/_/g,".")),s&&(t.ios=t.ipad=!0,t.version=s[2].replace(/_/g,".")),o&&(t.ios=t.ipod=!0,t.version=o[3]?o[3].replace(/_/g,"."):null),a&&(t.webos=!0,t.version=a[2]),f&&(t.touchpad=!0),h&&(t.blackberry=!0,t.version=h[2]),p&&(t.bb10=!0,t.version=p[2]),d&&(t.rimtabletos=!0,t.version=d[2]),v&&(n.playbook=!0),l&&(t.kindle=!0,t.version=l[1]),c&&(n.silk=!0,n.version=c[1]),!c&&t.android&&e.match(/Kindle Fire/)&&(n.silk=!0),m&&(n.chrome=!0,n.version=m[1]),g&&(n.firefox=!0,n.version=g[1]),y&&(n.ie=!0,n.version=y[1]),b&&(e.match(/Safari/)||!!t.ios)&&(n.safari=!0),w&&(n.webview=!0),y&&(n.ie=!0,n.version=y[1]),t.tablet=!!(s||v||i&&!e.match(/Mobile/)||g&&e.match(/Tablet/)||y&&!e.match(/Phone/)&&e.match(/Touch/)),t.phone=!!(!t.tablet&&!t.ipod&&(i||u||a||h||p||m&&e.match(/Android/)||m&&e.match(/CriOS\/([\d.]+)/)||g&&e.match(/Mobile/)||y&&e.match(/Touch/))),{browser:n,os:t,canvasSupported:document.createElement("canvas").getContext?!0:!1}}return e(navigator.userAgent)}),r("zrender/mixin/Eventful",["require"],function(e){var t=Array.prototype.slice,n=function(){this._handlers={}};return n.prototype={constructor:n,one:function(e,t,n){var r=this._handlers;return!t||!e?this:(r[e]||(r[e]=[]),r[e].push({h:t,one:!0,ctx:n||this}),this)},on:function(e,t,n){var r=this._handlers;return!t||!e?this:(r[e]||(r[e]=[]),r[e].push({h:t,one:!1,ctx:n||this}),this)},off:function(e,t){var n=this._handlers;if(!e)return this._handlers={},this;if(t){if(n[e]){var r=[];for(var i=0,s=n[e].length;i<s;i++)n[e][i]["h"]!=t&&r.push(n[e][i]);n[e]=r}n[e]&&n[e].length===0&&delete n[e]}else delete n[e];return this},trigger:function(e){if(this._handlers[e]){var n=arguments,r=n.length;r>3&&(n=t.call(n,1));var i=this._handlers[e],s=i.length;for(var o=0;o<s;){switch(r){case 1:i[o].h.call(i[o].ctx);break;case 2:i[o].h.call(i[o].ctx,n[1]);break;case 3:i[o].h.call(i[o].ctx,n[1],n[2]);break;default:i[o].h.apply(i[o].ctx,n)}i[o].one?(i.splice(o,1),s--):o++}}return this},triggerWithContext:function(e){if(this._handlers[e]){var n=arguments,r=n.length;r>4&&(n=t.call(n,1,n.length-1));var i=n[n.length-1],s=this._handlers[e],o=s.length;for(var u=0;u<o;){switch(r){case 1:s[u].h.call(i);break;case 2:s[u].h.call(i,n[1]);break;case 3:s[u].h.call(i,n[1],n[2]);break;default:s[u].h.apply(i,n)}s[u].one?(s.splice(u,1),o--):u++}}return this}},n}),r("zrender/core/event",["require","../mixin/Eventful"],function(e){function n(e){return e.zrenderX||e.offsetX||e.layerX||e.clientX||0}function r(e){return e.zrenderY||e.offsetY||e.layerY||e.clientY||0}function i(e){return e.zrenderDelta!=null&&e.zrenderDelta||e.wheelDelta!=null&&e.wheelDelta||e.detail!=null&&-e.detail}var t=e("../mixin/Eventful"),s=typeof window.addEventListener=="function"?function(e){e.preventDefault(),e.stopPropagation(),e.cancelBubble=!0}:function(e){e.returnValue=!1,e.cancelBubble=!0};return{getX:n,getY:r,getDelta:i,stop:s,Dispatcher:t}}),r("zrender/core/vector",[],function(){var e=typeof Float32Array=="undefined"?Array:Float32Array,t={create:function(t,n){var r=new e(2);return r[0]=t||0,r[1]=n||0,r},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e},clone:function(t){var n=new e(2);return n[0]=t[0],n[1]=t[1],n},set:function(e,t,n){return e[0]=t,e[1]=n,e},add:function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e},scaleAndAdd:function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e},sub:function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e},len:function(e){return Math.sqrt(this.lenSquare(e))},lenSquare:function(e){return e[0]*e[0]+e[1]*e[1]},mul:function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e},div:function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]},scale:function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e},normalize:function(e,n){var r=t.len(n);return r===0?(e[0]=0,e[1]=0):(e[0]=n[0]/r,e[1]=n[1]/r),e},distance:function(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))},distanceSquare:function(e,t){return(e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])},negate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e},lerp:function(e,t,n,r){return e[0]=t[0]+r*(n[0]-t[0]),e[1]=t[1]+r*(n[1]-t[1]),e},applyTransform:function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i+n[4],e[1]=n[1]*r+n[3]*i+n[5],e},min:function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e},max:function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e}};return t.length=t.len,t.lengthSquare=t.lenSquare,t.dist=t.distance,t.distSquare=t.distanceSquare,t}),r("zrender/Handler",["require","./config","./core/env","./core/event","./core/util","./core/vector","./mixin/Eventful"],function(e){function c(e,t,n){l?e.addEventListener(t,n):e.attachEvent("on"+t,n)}function h(e,t,n){l?e.removeEventListener(t,n):e.detachEvent("on"+t,n)}function p(e){return"_"+e+"Handler"}function d(e,t){if(e.zrenderFixed)return e;if(!t){e=e||window.event;var n=e.toElement||e.relatedTarget||e.srcElement||e.target;n&&(e.zrenderX=e.offsetX||e.layerX||0+n.offsetLeft,e.zrenderY=e.offsetY||e.layerY||0+n.offsetTop)}else{var r=e.type!="touchend"?e.targetTouches[0]:e.changedTouches[0];if(r){var i=this.painter._domRoot.getBoundingClientRect();e.zrenderX=r.clientX-i.left,e.zrenderY=r.clientY-i.top}}return e.zrenderFixed=1,e}function m(e,t){return function(n){return e.call(t,n)}}function g(e,t){return function(n,r,i){return e.call(t,n,r,i)}}function y(e){var t=a.length;while(t--){var n=a[t];e[p(n)]=m(v[n],e)}}var t=e("./config"),n=e("./core/env"),r=e("./core/event"),i=e("./core/util"),s=e("./core/vector"),o=t.EVENT,u=e("./mixin/Eventful"),a=["resize","click","dblclick","mousewheel","mousemove","mouseout","mouseup","mousedown","touchstart","touchend","touchmove"],f=[{x:10},{x:-20},{x:10,y:10},{y:-20}],l=!!window.addEventListener,v={resize:function(e){e=e||window.event,this._lastHover=null,this._isMouseDown=0,this.trigger(o.RESIZE,e)},click:function(e){e=d(e);var t=this._lastHover;(t||!t)&&this._clickTimes<5&&this._dispatchAgency(t,o.CLICK,e),this._mousemoveHandler(e)},dblclick:function(e){e=d(e);var t=this._lastHover;(t||!t)&&this._clickTimes<5&&this._dispatchAgency(t,o.DBLCLICK,e),this._mousemoveHandler(e)},mousewheel:function(e){e=d(e),this._dispatchAgency(this._lastHover,o.MOUSEWHEEL,e),this._mousemoveHandler(e)},mousemove:function(e){e=d(e),this._lastX=this._mouseX,this._lastY=this._mouseY,this._mouseX=r.getX(e),this._mouseY=r.getY(e);var t=this._mouseX-this._lastX,n=this._mouseY-this._lastY;this._processDragStart(e),this._hasfound=0,this._event=e,this._iterateAndFindHover();if(!this._hasfound){if(!this._draggingTarget||this._lastHover&&this._lastHover!=this._draggingTarget)this._processOutShape(e),this._processDragLeave(e);this._lastHover=null}var i="default",s=this._draggingTarget,u=this._lastHover;if(s)s.drift(t,n),this._clickTimes++;else if(this._isMouseDown){var a=!1;a&&this.painter.refresh()}s||this._hasfound&&u.draggable?i="move":this._hasfound&&(i="pointer"),this.root.style.cursor=i,this._dispatchAgency(u,o.MOUSEMOVE,e)},mouseout:function(e){e=d(e);var t=e.toElement||e.relatedTarget;if(t!=this.root)while(t&&t.nodeType!=9){if(t==this.root){this._mousemoveHandler(e);return}t=t.parentNode}e.zrenderX=this._lastX,e.zrenderY=this._lastY,this.root.style.cursor="default",this._isMouseDown=0,this._processOutShape(e),this._processDrop(e),this._processDragEnd(e),this.trigger(o.GLOBALOUT,e)},mousedown:function(e){this._clickTimes=0;if(this._lastDownButton==2){this._lastDownButton=e.button,this._mouseDownTarget=null;return}this._lastMouseDownMoment=new Date,e=d(e),this._isMouseDown=1,this._mouseDownTarget=this._lastHover,this._dispatchAgency(this._lastHover,o.MOUSEDOWN,e),this._lastDownButton=e.button},mouseup:function(e){e=d(e),this.root.style.cursor="default",this._isMouseDown=0,this._mouseDownTarget=null,this._dispatchAgency(this._lastHover,o.MOUSEUP,e),this._processDrop(e),this._processDragEnd(e)},touchstart:function(e){e=d(e,!0),this._lastTouchMoment=new Date,this._mobileFindFixed(e),this._mousedownHandler(e)},touchmove:function(e){e=d(e,!0),this._mousemoveHandler(e),this._isDragging&&r.stop(e)},touchend:function(e){e=d(e,!0),this._mouseupHandler(e);var t=new Date;t-this._lastTouchMoment<o.touchClickDelay&&(this._mobileFindFixed(e),this._clickHandler(e),t-this._lastClickMoment<o.touchClickDelay/2&&(this._dblclickHandler(e),this._lastHover&&r.stop(e)),this._lastClickMoment=t),this.painter.clearHover()}},b=function(e,t,r){u.call(this),this.root=e,this.storage=t,this.painter=r,this._lastX=this._lastY=this._mouseX=this._mouseY=0,y(this),c(window,"resize",this._resizeHandler);if(n.os.tablet||n.os.phone)c(e,"touchstart",this._touchstartHandler),c(e,"touchmove",this._touchmoveHandler),c(e,"touchend",this._touchendHandler),c(e,"mouseout",this._mouseoutHandler);else{for(var i=0;i<a.length;i++){var s=a[i];s.indexOf("touch")<0&&c(e,s,this[p(s)])}c(e,"DOMMouseScroll",this._mousewheelHandler)}};return b.prototype={constructor:b,on:function(e,t,n){return this.on(e,t,n),this},off:function(e,t){return this.off(e,t),this},trigger:function(e,t){switch(e){case o.RESIZE:case o.CLICK:case o.DBLCLICK:case o.MOUSEWHEEL:case o.MOUSEMOVE:case o.MOUSEDOWN:case o.MOUSEUP:case o.MOUSEOUT:this["_"+e+"Handler"](t)}},dispose:function(){var e=this.root;h(window,"resize",this._touchstartHandler);for(var t=0;t<v.length;t++){var n=v[t];h(e,n,this[p(n)])}h(e,"DOMMouseScroll",this._mousewheelHandler),this.root=this.storage=this.painter=null,this.un()},_processDragStart:function(e){var t=this._lastHover;if(this._isMouseDown&&t&&t.draggable&&!this._draggingTarget&&this._mouseDownTarget==t){if(t.dragEnableTime&&new Date-this._lastMouseDownMoment<t.dragEnableTime)return;var n=t;this._draggingTarget=n,this._isDragging=1,this._dispatchAgency(n,o.DRAGSTART,e),this.painter.refresh()}},_processDragEnter:function(e){this._draggingTarget&&this._dispatchAgency(this._lastHover,o.DRAGENTER,e,this._draggingTarget)},_processDragOver:function(e){this._draggingTarget&&this._dispatchAgency(this._lastHover,o.DRAGOVER,e,this._draggingTarget)},_processDragLeave:function(e){this._draggingTarget&&this._dispatchAgency(this._lastHover,o.DRAGLEAVE,e,this._draggingTarget)},_processDrop:function(e){this._draggingTarget&&(this._draggingTarget.dirty(),this.painter.refresh(),this._dispatchAgency(this._lastHover,o.DROP,e,this._draggingTarget))},_processDragEnd:function(e){this._draggingTarget&&(this._dispatchAgency(this._draggingTarget,o.DRAGEND,e),this._lastHover=null),this._isDragging=0,this._draggingTarget=null},_processOverShape:function(e){this._dispatchAgency(this._lastHover,o.MOUSEOVER,e)},_processOutShape:function(e){this._dispatchAgency(this._lastHover,o.MOUSEOUT,e)},_dispatchAgency:function(e,t,n,r){var i="on"+t,s={type:t,event:n,target:e,cancelBubble:!1},o=e;r&&(s.dragged=r);while(o){o[i]&&(s.cancelBubble=o[i].call(o,s)),o.trigger(t,s),o=o.parent;if(s.cancelBubble)break}if(e)s.cancelBubble||this.trigger(t,s);else if(!r){var u={type:t,event:n};this.trigger(t,u),this.painter.eachOtherLayer(function(e){typeof e[i]=="function"&&e[i].call(e,u),e.trigger&&e.trigger(t,u)})}},_iterateAndFindHover:function(){var e=this.storage.getDisplayList();for(var t=e.length-1;t>=0;t--)if(this._isHover(e[t],this._mouseX,this._mouseY))break},_mobileFindFixed:function(e){this._lastHover=null,this._mouseX=e.zrenderX,this._mouseY=e.zrenderY,this._event=e,this._iterateAndFindHover();for(var t=0;!this._lastHover&&t<f.length;t++){var n=f[t];n.x&&(this._mouseX+=n.x),n.y&&(this._mouseY+=n.y),this._iterateAndFindHover()}this._lastHover&&(e.zrenderX=this._mouseX,e.zrenderY=this._mouseY)},_isHover:function(e,t,n){if(this._draggingTarget&&this._draggingTarget==e||e.isSilent())return!1;var r=this._event;if(e.contain(t,n)){e.hoverable;var i=e.parent;while(i){if(i.clipPath&&!i.clipPath.contain(t,n))return console.log(i.clipPath.contain(t,n)),!1;i=i.parent}return this._lastHover!=e&&(this._processOutShape(r),this._processDragLeave(r),this._lastHover=e,this._processOverShape(r),this._processDragEnter(r)),this._processDragOver(r),this._hasfound=1,!0}return!1}},i.merge(b.prototype,u.prototype,!0),b}),r("zrender/core/matrix",[],function(){var e=typeof Float32Array=="undefined"?Array:Float32Array,t={create:function(){var n=new e(6);return t.identity(n),n},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},mul:function(e,t,n){return e[0]=t[0]*n[0]+t[2]*n[1],e[1]=t[1]*n[0]+t[3]*n[1],e[2]=t[0]*n[2]+t[2]*n[3],e[3]=t[1]*n[2]+t[3]*n[3],e[4]=t[0]*n[4]+t[2]*n[5]+t[4],e[5]=t[1]*n[4]+t[3]*n[5]+t[5],e},translate:function(e,t,n){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4]+n[0],e[5]=t[5]+n[1],e},rotate:function(e,t,n){var r=t[0],i=t[2],s=t[4],o=t[1],u=t[3],a=t[5],f=Math.sin(n),l=Math.cos(n);return e[0]=r*l+o*f,e[1]=-r*f+o*l,e[2]=i*l+u*f,e[3]=-i*f+l*u,e[4]=l*s+f*a,e[5]=l*a-f*s,e},scale:function(e,t,n){var r=n[0],i=n[1];return e[0]=t[0]*r,e[1]=t[1]*i,e[2]=t[2]*r,e[3]=t[3]*i,e[4]=t[4]*r,e[5]=t[5]*i,e},invert:function(e,t){var n=t[0],r=t[2],i=t[4],s=t[1],o=t[3],u=t[5],a=n*o-s*r;return a?(a=1/a,e[0]=o*a,e[1]=-s*a,e[2]=-r*a,e[3]=n*a,e[4]=(r*u-o*i)*a,e[5]=(s*i-n*u)*a,e):null},mulVector:function(e,t,n){var r=t[0],i=t[2],s=t[4],o=t[1],u=t[3],a=t[5];return e[0]=n[0]*r+n[1]*i+s,e[1]=n[0]*o+n[1]*u+a,e}};return t}),r("zrender/mixin/Transformable",["require","../core/matrix","../core/vector"],function(e){function o(e){return e>-s&&e<s}function u(e){return e>s||e<-s}var t=e("../core/matrix"),n=e("../core/vector"),r=[0,0],i=t.translate,s=5e-5,a=function(){this.position||(this.position=[0,0]),typeof this.rotation=="undefined"&&(this.rotation=[0,0,0]),this.scale||(this.scale=[1,1,0,0]),this.needLocalTransform=!1,this.needTransform=!1};return a.prototype={constructor:a,updateNeedTransform:function(){this.needLocalTransform=u(this.rotation[0])||u(this.position[0])||u(this.position[1])||u(this.scale[0]-1)||u(this.scale[1]-1)},updateTransform:function(){this.updateNeedTransform();var e=this.parent&&this.parent.needTransform;this.needTransform=this.needLocalTransform||e;if(!this.needTransform)return;var n=this.transform||t.create();t.identity(n);if(this.needLocalTransform){var s=this.scale,o=this.rotation,a=this.position;if(u(s[0])||u(s[1])){r[0]=-s[2]||0,r[1]=-s[3]||0;var f=u(r[0])||u(r[1]);f&&i(n,n,r),t.scale(n,n,s),f&&(r[0]=-r[0],r[1]=-r[1],i(n,n,r))}if(o instanceof Array){if(o[0]!==0){r[0]=-o[1]||0,r[1]=-o[2]||0;var f=u(r[0])||u(r[1]);f&&i(n,n,r),t.rotate(n,n,o[0]),f&&(r[0]=-r[0],r[1]=-r[1],i(n,n,r))}}else o!==0&&t.rotate(n,n,o);(u(a[0])||u(a[1]))&&i(n,n,a)}e&&(this.needLocalTransform?t.mul(n,this.parent.transform,n):t.copy(n,this.parent.transform)),this.transform=n,this.invTransform=this.invTransform||t.create(),t.invert(this.invTransform,n)},setTransform:function(e){if(this.needTransform){var t=this.transform;e.transform(t[0],t[1],t[2],t[3],t[4],t[5])}},lookAt:function(){var e=n.create();return function(r){this.transform||(this.transform=t.create());var i=this.transform;n.sub(e,r,this.position);if(o(e[0])&&o(e[1]))return;n.normalize(e,e);var s=this.scale;i[2]=e[0]*s[1],i[3]=e[1]*s[1],i[0]=e[1]*s[0],i[1]=-e[0]*s[0],i[4]=this.position[0],i[5]=this.position[1],this.decomposeTransform()}}(),decomposeTransform:function(){if(!this.transform)return;var e=this.transform,t=e[0]*e[0]+e[1]*e[1],n=this.position,r=this.scale,i=this.rotation;u(t-1)&&(t=Math.sqrt(t));var s=e[2]*e[2]+e[3]*e[3];u(s-1)&&(s=Math.sqrt(s)),n[0]=e[4],n[1]=e[5],r[0]=t,r[1]=s,r[2]=r[3]=0,i[0]=Math.atan2(-e[1]/s,e[0]/t),i[1]=i[2]=0},transformCoordToLocal:function(e,n){var r=[e,n];return this.needTransform&&this.invTransform&&t.mulVector(r,this.invTransform,r),r},transformCoordToGlobal:function(e,n){var r=[e,n];return this.needTransform&&this.transform&&t.mulVector(r,this.transform,r),r}},a}),r("zrender/graphic/Group",["require","../core/guid","../core/util","../mixin/Transformable","../mixin/Eventful"],function(e){var t=e("../core/guid"),n=e("../core/util"),r=e("../mixin/Transformable"),i=e("../mixin/Eventful"),s=function(e){e=e||{},this.id=e.id||t();for(var n in e)this[n]=e[n];this.clipShape=null,this._children=[],this.__storage=null,this.__dirty=!0,r.call(this),i.call(this)};return s.prototype={constructor:s,type:"group",ignore:!1,children:function(){return this._children.slice()},childAt:function(e){return this._children[e]},addElement:function(e){if(e==this)return;if(e.parent==this)return;e.parent&&e.parent.removeChild(e),this._children.push(e),e.parent=this;var t=this.__storage;t&&t!==e.__storage&&(t.addToMap(e),e instanceof s&&e.addChildrenToStorage(t)),this.__zr&&this.__zr.refreshNextFrame()},removeElement:function(e){var t=n.indexOf(this._children,e);t>=0&&this._children.splice(t,1),e.parent=null;var r=this.__storage;r&&(r.delFromMap(e.id),e instanceof s&&e.delChildrenFromStorage(r)),this.__zr&&this.__zr.refreshNextFrame()},clearChildren:function(){for(var e=0;e<this._children.length;e++){var t=this._children[e];this.__storage&&(this.__storage.delFromMap(t.id),t instanceof s&&t.delChildrenFromStorage(this.__storage))}this._children.length=0},eachChild:function(e,t){var n=!!t;for(var r=0;r<this._children.length;r++){var i=this._children[r];n?e.call(t,i):e(i)}},traverse:function(e,t){var n=!!t;for(var r=0;r<this._children.length;r++){var i=this._children[r];n?e.call(t,i):e(i),i.type==="group"&&i.traverse(e,t)}},addChildrenToStorage:function(e){for(var t=0;t<this._children.length;t++){var n=this._children[t];e.addToMap(n),n instanceof s&&n.addChildrenToStorage(e)}},delChildrenFromStorage:function(e){for(var t=0;t<this._children.length;t++){var n=this._children[t];e.delFromMap(n.id),n instanceof s&&n.delChildrenFromStorage(e)}},dirty:function(){this.__dirty=!0,this.__zr&&this.__zr.refreshNextFrame()},animate:function(e,t){if(this.__zr)return this.__zr.animate(this,e,t)}},n.merge(s.prototype,r.prototype,!0),n.merge(s.prototype,i.prototype,!0),s}),r("zrender/Storage",["require","./core/util","./graphic/Group"],function(e){function r(e,t){return e.zlevel==t.zlevel?e.z==t.z?e.__renderidx-t.__renderidx:e.z-t.z:e.zlevel-t.zlevel}var t=e("./core/util"),n=e("./graphic/Group"),i=function(){this._elements={},this._roots=[],this._displayList=[],this._displayListLen=0};return i.prototype={constructor:i,getDisplayList:function(e){return e&&this.updateDisplayList(),this._displayList},updateDisplayList:function(){this._displayListLen=0;var e=this._roots,t=this._displayList;for(var n=0,i=e.length;n<i;n++){var s=e[n];this._updateAndAddDisplayable(s)}t.length=this._displayListLen;for(var n=0,i=t.length;n<i;n++)t[n].__renderidx=n;t.sort(r)},_updateAndAddDisplayable:function(e,t){if(e.ignore)return;e.updateTransform();if(e.type=="group"){var n=e.clipPath,r=e._children;n&&(n.parent=e,n.updateTransform(),t?(t=t.slice(),t.push(n)):t=[n]);for(var i=0;i<r.length;i++){var s=r[i];s.__dirty=e.__dirty||s.__dirty,this._updateAndAddDisplayable(s,t)}e.__dirty=!1}else e.__clipPaths=t,this._displayList[this._displayListLen++]=e},addRoot:function(e){if(this._elements[e.id])return;e instanceof n&&e.addChildrenToStorage(this),this.addToMap(e),this._roots.push(e)},delRoot:function(e){if(e==null){for(var r=0;r<this._roots.length;r++){var i=this._roots[r];i instanceof n&&i.delChildrenFromStorage(this)}this._elements={},this._roots=[],this._displayList=[],this._displayListLen=0;return}if(e instanceof Array){for(var r=0,s=e.length;r<s;r++)this.delRoot(e[r]);return}var o;typeof e=="string"?o=this._elements[e]:o=e;var u=t.indexOf(this._roots,o);u>=0&&(this.delFromMap(o.id),this._roots.splice(u,1),o instanceof n&&o.delChildrenFromStorage(this))},addToMap:function(e){return e instanceof n&&(e.__storage=this),e.dirty(),this._elements[e.id]=e,this},get:function(e){return this._elements[e]},delFromMap:function(e){var t=this._elements,r=t[e];return r&&(delete t[e],r instanceof n&&(r.__storage=null)),this},dispose:function(){this._elements=this._renderList=this._roots=null}},i}),r("zrender/animation/easing",{Linear:function(e){return e},QuadraticIn:function(e){return e*e},QuadraticOut:function(e){return e*(2-e)},QuadraticInOut:function(e){return(e*=2)<1?.5*e*e:-0.5*(--e*(e-2)-1)},CubicIn:function(e){return e*e*e},CubicOut:function(e){return--e*e*e+1},CubicInOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},QuarticIn:function(e){return e*e*e*e},QuarticOut:function(e){return 1- --e*e*e*e},QuarticInOut:function(e){return(e*=2)<1?.5*e*e*e*e:-0.5*((e-=2)*e*e*e-2)},QuinticIn:function(e){return e*e*e*e*e},QuinticOut:function(e){return--e*e*e*e*e+1},QuinticInOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},SinusoidalIn:function(e){return 1-Math.cos(e*Math.PI/2)},SinusoidalOut:function(e){return Math.sin(e*Math.PI/2)},SinusoidalInOut:function(e){return.5*(1-Math.cos(Math.PI*e))},ExponentialIn:function(e){return e===0?0:Math.pow(1024,e-1)},ExponentialOut:function(e){return e===1?1:1-Math.pow(2,-10*e)},ExponentialInOut:function(e){return e===0?0:e===1?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)},CircularIn:function(e){return 1-Math.sqrt(1-e*e)},CircularOut:function(e){return Math.sqrt(1- --e*e)},CircularInOut:function(e){return(e*=2)<1?-0.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},ElasticIn:function(e){var t,n=.1,r=.4;return e===0?0:e===1?1:(!n||n<1?(n=1,t=r/4):t=r*Math.asin(1/n)/(2*Math.PI),-(n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*2*Math.PI/r)))},ElasticOut:function(e){var t,n=.1,r=.4;return e===0?0:e===1?1:(!n||n<1?(n=1,t=r/4):t=r*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*e)*Math.sin((e-t)*2*Math.PI/r)+1)},ElasticInOut:function(e){var t,n=.1,r=.4;return e===0?0:e===1?1:(!n||n<1?(n=1,t=r/4):t=r*Math.asin(1/n)/(2*Math.PI),(e*=2)<1?-0.5*n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*2*Math.PI/r):n*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*2*Math.PI/r)*.5+1)},BackIn:function(e){var t=1.70158;return e*e*((t+1)*e-t)},BackOut:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},BackInOut:function(e){var t=2.5949095;return(e*=2)<1?.5*e*e*((t+1)*e-t):.5*((e-=2)*e*((t+1)*e+t)+2)},BounceIn:function(e){return 1-easing.BounceOut(1-e)},BounceOut:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},BounceInOut:function(e){return e<.5?easing.BounceIn(e*2)*.5:easing.BounceOut(e*2-1)*.5+.5}}),r("zrender/animation/Clip",["require","./easing"],function(e){function n(e){this._targetPool=e.target||{},this._targetPool instanceof Array||(this._targetPool=[this._targetPool]),this._life=e.life||1e3,this._delay=e.delay||0,this._startTime=(new Date).getTime()+this._delay,this._endTime=this._startTime+this._life*1e3,this.loop=typeof e.loop=="undefined"?!1:e.loop,this.gap=e.gap||0,this.easing=e.easing||"Linear",this.onframe=e.onframe,this.ondestroy=e.ondestroy,this.onrestart=e.onrestart}var t=e("./easing");return n.prototype={step:function(e){var n=(e-this._startTime)/this._life;if(n<0)return;n=Math.min(n,1);var r=typeof this.easing=="string"?t[this.easing]:this.easing,i=typeof r=="function"?r(n):n;return this.fire("frame",i),n==1?this.loop?(this.restart(),"restart"):(this._needsRemove=!0,"destroy"):null},restart:function(){var e=(new Date).getTime(),t=(e-this._startTime)%this._life;this._startTime=(new Date).getTime()-t+this.gap,this._needsRemove=!1},fire:function(e,t){for(var n=0,r=this._targetPool.length;n<r;n++)this["on"+e]&&this["on"+e](this._targetPool[n],t)},constructor:n},n}),r("zrender/tool/color",["require","../core/util"],function(e){function f(e){r=e}function l(){r=i}function c(e,t){return e|=0,t=t||r,t[e%t.length]}function h(e){s=e}function p(){o=s}function d(){return s}function v(e,r,i,s,o,u,a){n||(n=t.getContext());var f=n.createRadialGradient(e,r,i,s,o,u);for(var l=0,c=a.length;l<c;l++)f.addColorStop(a[l][0],a[l][1]);return f.__nonRecursion=!0,f}function m(e,r,i,s,o){n||(n=t.getContext());var u=n.createLinearGradient(e,r,i,s);for(var a=0,f=o.length;a<f;a++)u.addColorStop(o[a][0],o[a][1]);return u.__nonRecursion=!0,u}function g(e,t,n){e=S(e),t=S(t),e=F(e),t=F(t);var r=[],i=(t[0]-e[0])/n,s=(t[1]-e[1])/n,o=(t[2]-e[2])/n,u=(t[3]-e[3])/n;for(var a=0,f=e[0],l=e[1],c=e[2],h=e[3];a<n;a++)r[a]=b([R(Math.floor(f),[0,255]),R(Math.floor(l),[0,255]),R(Math.floor(c),[0,255]),h.toFixed(4)-0],"rgba"),f+=i,l+=s,c+=o,h+=u;return f=t[0],l=t[1],c=t[2],h=t[3],r[a]=b([f,l,c,h],"rgba"),r}function y(e,t){var n=[],r=e.length;t===undefined&&(t=20);if(r===1)n=g(e[0],e[0],t);else if(r>1)for(var i=0,s=r-1;i<s;i++){var o=g(e[i],e[i+1],t);i<s-1&&o.pop(),n=n.concat(o)}return n}function b(e,t){t=t||"rgb";if(e&&(e.length===3||e.length===4)){e=q(e,function(e){return e>1?Math.ceil(e):e});if(t.indexOf("hex")>-1)return"#"+((1<<24)+(e[0]<<16)+(e[1]<<8)+ +e[2]).toString(16).slice(1);if(t.indexOf("hs")>-1){var n=q(e.slice(1,3),function(e){return e+"%"});e[1]=n[0],e[2]=n[1]}return t.indexOf("a")>-1?(e.length===3&&e.push(1),e[3]=R(e[3],[0,1]),t+"("+e.slice(0,4).join(",")+")"):t+"("+e.slice(0,3).join(",")+")"}}function w(e){e=_(e),e.indexOf("rgba")<0&&(e=S(e));var t=[],n=0;return e.replace(/[\d.]+/g,function(e){n<3?e|=0:e=+e,t[n++]=e}),t}function E(e,t){if(!U(e))return e;var n=F(e),r=n[3];return typeof r=="undefined"&&(r=1),e.indexOf("hsb")>-1?n=z(n):e.indexOf("hsl")>-1&&(n=W(n)),t.indexOf("hsb")>-1||t.indexOf("hsv")>-1?n=V(n):t.indexOf("hsl")>-1&&(n=$(n)),n[3]=r,b(n,t)}function S(e){return E(e,"rgba")}function x(e){return E(e,"rgb")}function T(e){return E(e,"hex")}function N(e){return E(e,"hsva")}function C(e){return E(e,"hsv")}function k(e){return E(e,"hsba")}function L(e){return E(e,"hsb")}function A(e){return E(e,"hsla")}function O(e){return E(e,"hsl")}function M(e){for(var t in a)if(T(a[t])===T(e))return t;return null}function _(e){return String(e).replace(/\s+/g,"")}function D(e){a[e]&&(e=a[e]),e=_(e),e=e.replace(/hsv/i,"hsb");if(/^#[\da-f]{3}$/i.test(e)){e=parseInt(e.slice(1),16);var t=(e&3840)<<8,n=(e&240)<<4,r=e&15;e="#"+((1<<24)+(t<<4)+t+(n<<4)+n+(r<<4)+r).toString(16).slice(1)}return e}function P(e,t){if(!U(e))return e;var n=t>0?1:-1;typeof t=="undefined"&&(t=0),t=Math.abs(t)>1?1:Math.abs(t),e=x(e);var r=F(e);for(var i=0;i<3;i++)n===1?r[i]=r[i]*(1-t)|0:r[i]=(255-r[i])*t+r[i]|0;return"rgb("+r.join(",")+")"}function H(e){if(!U(e))return e;var t=F(S(e));return t=q(t,function(e){return 255-e}),b(t,"rgb")}function B(e,t,n){if(!U(e)||!U(t))return e;typeof n=="undefined"&&(n=.5),n=1-R(n,[0,1]);var r=n*2-1,i=F(S(e)),s=F(S(t)),o=i[3]-s[3],u=((r*o===-1?r:(r+o)/(1+r*o))+1)/2,a=1-u,f=[];for(var l=0;l<3;l++)f[l]=i[l]*u+s[l]*a;var c=i[3]*n+s[3]*(1-n);return c=Math.max(0,Math.min(1,c)),i[3]===1&&s[3]===1?b(f,"rgb"):(f[3]=c,b(f,"rgba"))}function j(){return"#"+(Math.random().toString(16)+"0000").slice(2,8)}function F(e){e=D(e);var t=e.match(u);if(t===null)throw new Error("The color format error");var n,r,i=[],s;if(t[2])n=t[2].replace("#","").split(""),s=[n[0]+n[1],n[2]+n[3],n[4]+n[5]],i=q(s,function(e){return R(parseInt(e,16),[0,255])});else if(t[4]){var o=t[4].split(",");r=o[3],s=o.slice(0,3),i=q(s,function(e){return e=Math.floor(e.indexOf("%")>0?parseInt(e,0)*2.55:e),R(e,[0,255])}),typeof r!="undefined"&&i.push(R(parseFloat(r),[0,1]))}else if(t[5]||t[6]){var a=(t[5]||t[6]).split(","),f=parseInt(a[0],0)/360,l=a[1],c=a[2];r=a[3],i=q([l,c],function(e){return R(parseFloat(e)/100,[0,1])}),i.unshift(f),typeof r!="undefined"&&i.push(R(parseFloat(r),[0,1]))}return i}function I(e,t){if(!U(e))return e;t===null&&(t=1);var n=F(S(e));return n[3]=R(Number(t).toFixed(4),[0,1]),b(n,"rgba")}function q(e,t){if(typeof t!="function")throw new TypeError;var n=e?e.length:0;for(var r=0;r<n;r++)e[r]=t(e[r]);return e}function R(e,t){return e<=t[0]?e=t[0]:e>=t[1]&&(e=t[1]),e}function U(e){return e instanceof Array||typeof e=="string"}function z(e){var t=e[0],n=e[1],r=e[2],i,s,o;if(n===0)i=r*255,s=r*255,o=r*255;else{var u=t*6;u===6&&(u=0);var a=u|0,f=r*(1-n),l=r*(1-n*(u-a)),c=r*(1-n*(1-(u-a))),h=0,p=0,d=0;a===0?(h=r,p=c,d=f):a===1?(h=l,p=r,d=f):a===2?(h=f,p=r,d=c):a===3?(h=f,p=l,d=r):a===4?(h=c,p=f,d=r):(h=r,p=f,d=l),i=h*255,s=p*255,o=d*255}return[i,s,o]}function W(e){var t=e[0],n=e[1],r=e[2],i,s,o;if(n===0)i=r*255,s=r*255,o=r*255;else{var u;r<.5?u=r*(1+n):u=r+n-n*r;var a=2*r-u;i=255*X(a,u,t+1/3),s=255*X(a,u,t),o=255*X(a,u,t-1/3)}return[i,s,o]}function X(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),6*n<1?e+(t-e)*6*n:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}function V(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,i=Math.min(t,n,r),s=Math.max(t,n,r),o=s-i,u=s,a,f;if(o===0)a=0,f=0;else{f=o/s;var l=((s-t)/6+o/2)/o,c=((s-n)/6+o/2)/o,h=((s-r)/6+o/2)/o;t===s?a=h-c:n===s?a=1/3+l-h:r===s&&(a=2/3+c-l),a<0&&(a+=1),a>1&&(a-=1)}return a*=360,f*=100,u*=100,[a,f,u]}function $(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,i=Math.min(t,n,r),s=Math.max(t,n,r),o=s-i,u=(s+i)/2,a,f;if(o===0)a=0,f=0;else{u<.5?f=o/(s+i):f=o/(2-s-i);var l=((s-t)/6+o/2)/o,c=((s-n)/6+o/2)/o,h=((s-r)/6+o/2)/o;t===s?a=h-c:n===s?a=1/3+l-h:r===s&&(a=2/3+c-l),a<0&&(a+=1),a>1&&(a-=1)}return a*=360,f*=100,u*=100,[a,f,u]}function J(e){return e.match(u)}var t=e("../core/util"),n,r=["#ff9277"," #dddd00"," #ffc877"," #bbe3ff"," #d5ffbb","#bbbbff"," #ddb000"," #b0dd00"," #e2bbff"," #ffbbe3","#ff7777"," #ff9900"," #83dd00"," #77e3ff"," #778fff","#c877ff"," #ff77ab"," #ff6600"," #aa8800"," #77c7ff","#ad77ff"," #ff77ff"," #dd0083"," #777700"," #00aa00","#0088aa"," #8400dd"," #aa0088"," #dd0000"," #772e00"],i=r,s="rgba(255,255,0,0.5)",o=s,u=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,a={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#0ff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000",blanchedalmond:"#ffebcd",blue:"#00f",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#0ff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#f0f",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#0f0",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#f0f",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#f00",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#fff",whitesmoke:"#f5f5f5",yellow:"#ff0",yellowgreen:"#9acd32"};return{customPalette:f,resetPalette:l,getColor:c,getHighlightColor:d,customHighlight:h,resetHighlight:p,getRadialGradient:v,getLinearGradient:m,getGradientColors:y,getStepColors:g,reverse:H,mix:B,lift:P,trim:_,random:j,toRGB:x,toRGBA:S,toHex:T,toHSL:O,toHSLA:A,toHSB:L,toHSBA:k,toHSV:C,toHSVA:N,toName:M,toColor:b,toArray:w,alpha:I,getData:F,validate:J}}),r("zrender/animation/Animation",["require","./Clip","../tool/color","../core/util","../core/event","../core/log"],function(e){function l(e,t){return e[t]}function c(e,t,n){e[t]=n}function h(e,t,n){return(t-e)*n+e}function p(e,t,n){return n>.5?t:e}function d(e,t,n,r,i){var s=e.length;if(i==1)for(var o=0;o<s;o++)r[o]=h(e[o],t[o],n);else{var u=e[0].length;for(var o=0;o<s;o++)for(var a=0;a<u;a++)r[o][a]=h(e[o][a],t[o][a],n)}}function v(e,t,n,r,i,s,o,u,a){var f=e.length;if(a==1)for(var l=0;l<f;l++)u[l]=m(e[l],t[l],n[l],r[l],i,s,o);else{var c=e[0].length;for(var l=0;l<f;l++)for(var h=0;h<c;h++)u[l][h]=m(e[l][h],t[l][h],n[l][h],r[l][h],i,s,o)}}function m(e,t,n,r,i,s,o){var u=(n-e)*.5,a=(r-t)*.5;return(2*(t-n)+u+a)*o+(-3*(t-n)-2*u-a)*s+u*i+t}function g(e){if(o(e)){var t=e.length;if(o(e[0])){var n=[];for(var r=0;r<t;r++)n.push(a.call(e[r]));return n}return a.call(e)}return e}function y(e){return e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.floor(e[2]),"rgba("+e.join(",")+")"}var t=e("./Clip"),n=e("../tool/color"),r=e("../core/util"),i=e("../core/event").Dispatcher,s=e("../core/log"),o=r.isArrayLike,u=window.requestAnimationFrame||window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){setTimeout(e,16)},a=Array.prototype.slice,f=function(e){e=e||{},this.stage=e.stage||{},this.onframe=e.onframe||function(){},this._clips=[],this._running=!1,this._time=0,i.call(this)};f.prototype={add:function(e){this._clips.push(e)},remove:function(e){var t=r.indexOf(this._clips,e);t>=0&&this._clips.splice(t,1)},_update:function(){var e=(new Date).getTime(),t=e-this._time,n=this._clips,r=n.length,i=[],s=[];for(var o=0;o<r;o++){var u=n[o],a=u.step(e);a&&(i.push(a),s.push(u))}for(var o=0;o<r;)n[o]._needsRemove?(n[o]=n[r-1],n.pop(),r--):o++;r=i.length;for(var o=0;o<r;o++)s[o].fire(i[o]);this._time=e,this.onframe(t),this.trigger("frame",t),this.stage.update&&this.stage.update()},start:function(){function t(){e._running&&(u(t),e._update())}var e=this;this._running=!0,this._time=(new Date).getTime(),u(t)},stop:function(){this._running=!1},clear:function(){this._clips=[]},animate:function(e,t){t=t||{};var n=new b(e,t.loop,t.getter,t.setter);return n.animation=this,n},constructor:f},r.merge(f.prototype,i.prototype,!0);var b=function(e,t,n,r){this._tracks={},this._target=e,this._loop=t||!1,this._getter=n||l,this._setter=r||c,this._clipCount=0,this._delay=0,this._doneList=[],this._onframeList=[],this._clipList=[]};return b.prototype={when:function(e,t){var n=this._tracks;for(var r in t){if(!n[r]){n[r]=[];var i=this._getter(this._target,r);if(i==null){s("Invalid property "+r);continue}e!==0&&n[r].push({time:0,value:g(i)})}n[r].push({time:parseInt(e,10),value:t[r]})}return this},during:function(e){return this._onframeList.push(e),this},start:function(e){var r=this,i=this._setter,s=this._getter,u=e==="spline",a=function(){r._clipCount--;if(r._clipCount===0){r._tracks={};var e=r._doneList.length;for(var t=0;t<e;t++)r._doneList[t].call(r)}},f=function(f,l){var c=f.length;if(!c)return;var g=f[0].value,b=o(g),w=!1,E=!1,S=b&&o(g[0])?2:1,x;f.sort(function(e,t){return e.time-t.time});if(!c)return;x=f[c-1].time;var T=[],N=[];for(var C=0;C<c;C++){T.push(f[C].time/x);var k=f[C].value;typeof k=="string"&&(n.validate(k)?(k=n.toArray(k),w=!0):E=!0),N.push(k)}var L=0,A=0,O,C,M,_,D,P,H;if(w)var B=[0,0,0,0];var j=function(e,t){if(t<A){O=Math.min(L+1,c-1);for(C=O;C>=0;C--)if(T[C]<=t)break;C=Math.min(C,c-2)}else{for(C=L;C<c;C++)if(T[C]>t)break;C=Math.min(C-1,c-2)}L=C,A=t;var n=T[C+1]-T[C];if(n===0)return;M=(t-T[C])/n;if(u){D=N[C],_=N[C===0?C:C-1],P=N[C>c-2?c-1:C+1],H=N[C>c-3?c-1:C+2];if(b)v(_,D,P,H,M,M*M,M*M*M,s(e,l),S);else{var o;if(w)o=v(_,D,P,H,M,M*M,M*M*M,B,1),o=y(B);else{if(E)return p(D,P,M);o=m(_,D,P,H,M,M*M,M*M*M)}i(e,l,o)}}else if(b)d(N[C],N[C+1],M,s(e,l),S);else{var o;if(w)d(N[C],N[C+1],M,B,1),o=y(B);else{if(E)return p(N[C],N[C+1],M);o=h(N[C],N[C+1],M)}i(e,l,o)}for(C=0;C<r._onframeList.length;C++)r._onframeList[C](e,t)},F=new t({target:r._target,life:x,loop:r._loop,delay:r._delay,onframe:j,ondestroy:a});e&&e!=="spline"&&(F.easing=e),r._clipList.push(F),r._clipCount++,r.animation.add(F)};for(var l in this._tracks)f(this._tracks[l],l);return this},stop:function(){var e=this._clipList;for(var t=0;t<e.length;t++){var n=e[t];this.animation.remove(n)}e.length=0},delay:function(e){return this._delay=e,this},done:function(e){return e&&this._doneList.push(e),this}},f}),r("zrender/core/curve",["require","./vector"],function(e){function d(e){return e>-a&&e<a}function v(e){return e>a||e<-a}function m(e,t,n,r,i){var s=1-i;return s*s*(s*e+3*i*t)+i*i*(i*r+3*s*n)}function g(e,t,n,r,i){var s=1-i;return 3*(((t-e)*s+2*(n-t)*i)*s+(r-n)*i*i)}function y(e,t,n,r,i,s){var a=r+3*(t-n)-e,c=3*(n-t*2+e),h=3*(t-e),p=e-i,v=c*c-3*a*h,m=c*h-9*a*p,g=h*h-3*c*p,y=0;if(d(v)&&d(m))if(d(c))s[0]=0;else{var b=-h/c;b>=0&&b<=1&&(s[y++]=b)}else{var w=m*m-4*v*g;if(d(w)){var E=m/v,b=-c/a+E,S=-E/2;b>=0&&b<=1&&(s[y++]=b),S>=0&&S<=1&&(s[y++]=S)}else if(w>0){var x=u(w),T=v*c+1.5*a*(-m+x),N=v*c+1.5*a*(-m-x);T<0?T=-o(-T,l):T=o(T,l),N<0?N=-o(-N,l):N=o(N,l);var b=(-c-(T+N))/(3*a);b>=0&&b<=1&&(s[y++]=b)}else{var C=(2*v*c-3*a*m)/(2*u(v*v*v)),k=Math.acos(C)/3,L=u(v),A=Math.cos(k),b=(-c-2*L*A)/(3*a),S=(-c+L*(A+f*Math.sin(k)))/(3*a),O=(-c+L*(A-f*Math.sin(k)))/(3*a);b>=0&&b<=1&&(s[y++]=b),S>=0&&S<=1&&(s[y++]=S),O>=0&&O<=1&&(s[y++]=O)}}return y}function b(e,t,n,r,i){var s=6*n-12*t+6*e,o=9*t+3*r-3*e-9*n,a=3*t-3*e,f=0;if(d(o)){if(v(s)){var l=-a/s;l>=0&&l<=1&&(i[f++]=l)}}else{var c=s*s-4*o*a;if(d(c))i[0]=-s/(2*o);else if(c>0){var h=u(c),l=(-s+h)/(2*o),p=(-s-h)/(2*o);l>=0&&l<=1&&(i[f++]=l),p>=0&&p<=1&&(i[f++]=p)}}return f}function w(e,t,n,r,i,s){var o=(t-e)*i+e,u=(n-t)*i+t,a=(r-n)*i+n,f=(u-o)*i+o,l=(a-u)*i+u,c=(l-f)*i+f;s[0]=e,s[1]=o,s[2]=f,s[3]=c,s[4]=c,s[5]=l,s[6]=a,s[7]=r}function E(e,t,n,i,s,o,f,l,d,v,g){var y,b=.005,w=Infinity,E,S,x,T;c[0]=d,c[1]=v;for(var N=0;N<1;N+=.05)h[0]=m(e,n,s,f,N),h[1]=m(t,i,o,l,N),x=r(c,h),x<w&&(y=N,w=x);w=Infinity;for(var C=0;C<32;C++){if(b<a)break;E=y-b,S=y+b,h[0]=m(e,n,s,f,E),h[1]=m(t,i,o,l,E),x=r(h,c),E>=0&&x<w?(y=E,w=x):(p[0]=m(e,n,s,f,S),p[1]=m(t,i,o,l,S),T=r(p,c),S<=1&&T<w?(y=S,w=T):b*=.5)}return g&&(g[0]=m(e,n,s,f,y),g[1]=m(t,i,o,l,y)),u(w)}function S(e,t,n,r){var i=1-r;return i*(i*e+2*r*t)+r*r*n}function x(e,t,n,r){return 2*((1-r)*(t-e)+r*(n-t))}function T(e,t,n,r,i){var s=e-2*t+n,o=2*(t-e),a=e-r,f=0;if(d(s)){if(v(o)){var l=-a/o;l>=0&&l<=1&&(i[f++]=l)}}else{var c=o*o-4*s*a;if(d(c)){var l=-o/(2*s);l>=0&&l<=1&&(i[f++]=l)}else if(c>0){var h=u(c),l=(-o+h)/(2*s),p=(-o-h)/(2*s);l>=0&&l<=1&&(i[f++]=l),p>=0&&p<=1&&(i[f++]=p)}}return f}function N(e,t,n){var r=e+n-2*t;return r===0?.5:(e-t)/r}function C(e,t,n,r,i){var s=(t-e)*r+e,o=(n-t)*r+t,u=(o-s)*r+s;i[0]=e,i[1]=s,i[2]=u,i[3]=u,i[4]=o,i[5]=n}function k(e,t,n,i,s,o,f,l,d){var v,m=.005,g=Infinity;c[0]=f,c[1]=l;for(var y=0;y<1;y+=.05){h[0]=S(e,n,s,y),h[1]=S(t,i,o,y);var b=r(c,h);b<g&&(v=y,g=b)}g=Infinity;for(var w=0;w<32;w++){if(m<a)break;var E=v-m,x=v+m;h[0]=S(e,n,s,E),h[1]=S(t,i,o,E);var b=r(h,c);if(E>=0&&b<g)v=E,g=b;else{p[0]=S(e,n,s,x),p[1]=S(t,i,o,x);var T=r(p,c);x<=1&&T<g?(v=x,g=T):m*=.5}}return d&&(d[0]=S(e,n,s,v),d[1]=S(t,i,o,v)),u(g)}var t=e("./vector"),n=t.create,r=t.distSquare,i=Math.min,s=Math.max,o=Math.pow,u=Math.sqrt,a=1e-4,f=u(3),l=1/3,c=n(),h=n(),p=n();return{cubicAt:m,cubicDerivativeAt:g,cubicRootAt:y,cubicExtrema:b,cubicSubdivide:w,cubicProjectPoint:E,quadraticAt:S,quadraticDerivativeAt:x,quadraticRootAt:T,quadraticExtremum:N,quadraticSubdivide:C,quadraticProjectPoint:k}}),r("zrender/core/bbox",["require","./vector","./curve"],function(e){var t=e("./vector"),n=e("./curve"),r={},i=Math.min,s=Math.max,o=Math.sin,u=Math.cos,a=t.create(),f=t.create(),l=t.create(),c=Math.PI*2;return r.fromPoints=function(e,t,n){if(e.length===0)return;var r=e[0],i=r[0],s=r[0],o=r[1],u=r[1],a;for(a=1;a<e.length;a++)r=e[a],r[0]<i&&(i=r[0]),r[0]>s&&(s=r[0]),r[1]<o&&(o=r[1]),r[1]>u&&(u=r[1]);t[0]=i,t[1]=o,n[0]=s,n[1]=u},r.fromLine=function(e,t,n,r,o,u){o[0]=i(e,n),o[1]=i(t,r),u[0]=s(e,n),u[1]=s(t,r)},r.fromCubic=function(e,t,r,o,u,a,f,l,c,h){var p=[],d=[],v=n.cubicExtrema,m=n.cubicAt,g,y,b,w,E,S=v(e,r,u,f,p);for(E=0;E<S;E++)p[E]=m(e,r,u,f,p[E]);S=v(t,o,a,l,d);for(E=0;E<S;E++)d[E]=m(t,o,a,l,d[E]);p.push(e,f),d.push(t,l),g=i.apply(null,p),y=s.apply(null,p),b=i.apply(null,d),w=s.apply(null,d),c[0]=g,c[1]=b,h[0]=y,h[1]=w},r.fromQuadratic=function(e,t,r,o,u,a,f,l){var c=n.quadraticExtremum,h=n.quadraticAt,p=s(i(c(e,r,u),1),0),d=s(i(c(t,o,a),1),0),v=h(e,r,u,p),m=h(t,o,a,d);f[0]=i(e,u,v),f[1]=i(t,a,m),l[0]=s(e,u,v),l[1]=s(t,a,m)},r.fromArc=function(e,n,r,i,s,h,p,d,v){var m=t.min,g=t.max;if(Math.abs(s-h)>=c){d[0]=e-r,d[1]=n-i,v[0]=e+r,v[1]=n+i;return}a[0]=u(s)*r+e,a[1]=o(s)*i+n,f[0]=u(h)*r+e,f[1]=o(h)*i+n,m(d,a,f),g(v,a,f),s%=c,s<0&&(s+=c),h%=c,h<0&&(h+=c),s>h&&!p?h+=c:s<h&&p&&(s+=c);if(p){var y=h;h=s,s=y}for(var b=0;b<h;b+=Math.PI/2)b>s&&(l[0]=u(b)*r+e,l[1]=o(b)*i+n,m(d,l,d),g(v,l,v))},r}),r("zrender/core/PathProxy",["require","./curve","./vector","./bbox"],function(e){var t=e("./curve"),n=e("./vector"),r=e("./bbox"),i={M:1,L:2,C:3,Q:4,A:5,Z:6},s=[],o=[],u=[],a=[],f=[],l=Math.min,c=Math.max,h=Math.cos,p=Math.sin,d=Math.sqrt,v=typeof Float32Array!="undefined",m=function(){this.data=[],this._len=0,this._ctx=null,this._xi=0,this._yi=0,this._x0=0,this._y0=0};return m.prototype={constructor:m,_lineDash:null,_dashOffset:0,_dashIdx:0,_dashSum:0,getContext:function(){return this._ctx},beginPath:function(e){return this._ctx=e,e&&e.beginPath(),this._len=0,this._lineDash&&(this._lineDash=null,this._dashOffset=0),this},moveTo:function(e,t){return this.addData(i.M,e,t),this._ctx&&this._ctx.moveTo(e,t),this._x0=e,this._y0=t,this._xi=e,this._yi=t,this},lineTo:function(e,t){return this.addData(i.L,e,t),this._ctx&&(this._needsDash()?this._dashedLineTo(e,t):this._ctx.lineTo(e,t)),this._xi=e,this._yi=t,this},bezierCurveTo:function(e,t,n,r,s,o){return this.addData(i.C,e,t,n,r,s,o),this._ctx&&(this._needsDash()?this._dashedBezierTo(e,t,n,r,s,o):this._ctx.bezierCurveTo(e,t,n,r,s,o)),this._xi=s,this._yi=o,this},quadraticCurveTo:function(e,t,n,r){return this.addData(i.Q,e,t,n,r),this._ctx&&(this._needsDash()?this._dashedQuadraticTo(e,t,n,r):this._ctx.quadraticCurveTo(e,t,n,r)),this._xi=n,this._yi=r,this},arc:function(e,t,n,r,s,o){return this.addData(i.A,e,t,n,n,r,s-r,0,o?0:1),this._ctx&&this._ctx.arc(e,t,n,r,s,o),this._xi=h(s)*n+e,this._xi=p(s)*n+e,this},arcTo:function(e,t,n,r,i){return this._ctx&&this._ctx.arcTo(e,t,n,r,i),this},rect:function(e,t,n,r){return this._ctx&&this._ctx.rect(e,t,n,r),this},closePath:function(){this.addData(i.Z);var e=this._ctx,t=this._x0,n=this._y0;return this._ctx&&(this._needsDash()&&this._dashedLineTo(t,n),this._ctx.closePath()),this._xi=t,this._yi=n,this},fill:function(e){e&&e.fill(),this.toStatic()},stroke:function(e){e&&e.stroke(),this.toStatic()},setLineDash:function(e){if(e instanceof Array){this._lineDash=e,this._dashIdx=0;var t=0;for(var n=0;n<e.length;n++)t+=e[n];this._dashSum=t}return this},setLineDashOffset:function(e){return this._dashOffset=e,this},len:function(){return this._len},setData:function(e){var t=e.length;(!this.data||this.data.length!=t)&&v&&(this.data=new Float32Array(t));for(var n=0;n<t;n++)this.data[n]=e[n];this._len=t},addData:function(e){var t=this.data;this._len+arguments.length>t.length&&(this._expandData(),t=this.data);for(var n=0;n<arguments.length;n++)t[this._len++]=arguments[n];this._prevCmd=e},_expandData:function(){if(!(this.data instanceof Array)){var e=[];for(var t=0;t<this._len;t++)e[t]=this.data[t];this.data=e}},_needsDash:function(){return this._lineDash},_dashedLineTo:function(e,t){var n=this._dashSum,r=this._dashOffset,i=this._lineDash,s=this._ctx,o=this._xi,u=this._yi,a=e-o,f=t-u,h=d(a*a+f*f),p=o,v=u,m,g=i.length,y;a/=h,f/=h,r<0&&(r=n+r),r%=n,p-=r*a,v-=r*f;while(a>=0&&p<=e||a<0&&p>e){y=this._dashIdx,m=i[y],p+=a*m,v+=f*m,this._dashIdx=(y+1)%g;if(a>0&&p<o||a<0&&p>o)continue;s[y%2?"moveTo":"lineTo"](a>=0?l(p,e):c(p,e),f>=0?l(v,t):c(v,t))}a=p-e,f=v-t,this._dashOffset=-d(a*a+f*f)},_dashedBezierTo:function(e,n,r,i,s,o){var u=this._dashSum,a=this._dashOffset,f=this._lineDash,l=this._ctx,c=this._xi,h=this._yi,p,v,m,g=t.cubicAt,y=0,b=this._dashIdx,w=f.length,E,S,x=0;a<0&&(a=u+a),a%=u;for(p=0;p<1;p+=.1)v=g(c,e,r,s,p+.1)-g(c,e,r,s,p),m=g(h,n,i,o,p+.1)-g(h,n,i,o,p),y+=d(v*v+m*m);for(;b<w;b++){x+=f[b];if(x>a)break}p=(x-a)/y;while(p<=1)E=g(c,e,r,s,p),S=g(h,n,i,o,p),b%2?l.moveTo(E,S):l.lineTo(E,S),p+=f[b]/y,b=(b+1)%w;!(b%2)&&l.lineTo(s,o),v=s-E,m=o-S,this._dashOffset=-d(v*v+m*m)},_dashedQuadraticTo:function(e,t,n,r){var i=n,s=r;n=(n+2*e)/3,r=(r+2*t)/3,e=(this._xi+2*e)/3,t=(this._yi+2*t)/3,this._dashedBezierTo(e,t,n,r,i,s)},toStatic:function(){this.data.length=this._len,v&&this.data instanceof Array&&(this.data=new Float32Array(this.data))},getBoundingRect:function(){s[0]=s[1]=u[0]=u[1]=Infinity,o[0]=o[1]=a[0]=a[1]=-Infinity;var e=this.data,t=0,f=0,l=0,c=0;for(var d=0;d<e.length;){var v=e[d++];d==1&&(t=e[d],f=e[d+1],l=t,c=f);switch(v){case i.M:l=e[d++],c=e[d++],t=l,f=c;break;case i.L:r.fromLine(t,f,e[d],e[d+1],u,a),t=e[d++],f=e[d++];break;case i.C:r.fromCubic(t,f,e[d++],e[d++],e[d++],e[d++],e[d],e[d+1],u,a),t=e[d++],f=e[d++];break;case i.Q:r.fromQuadratic(t,f,e[d++],e[d++],e[d],e[d+1],u,a),t=e[d++],f=e[d++];break;case i.A:var m=e[d++],g=e[d++],y=e[d++],b=e[d++],w=e[d++],E=e[d++]+w,S=e[d++],x=1-e[d++];d==1&&(l=h(w)*y+m,c=p(w)*b+g),r.fromArc(m,g,y,b,w,E,x,u,a),t=h(E)*y+m,f=p(E)*b+g;break;case i.Z:t=l,f=c}n.min(s,s,u),n.max(o,o,a)}return{x:s[0],y:s[1],width:o[0]-s[0],height:o[1]-s[1]}},rebuildPath:function(e){var t=this.data;for(var n=0;n<this._len;){var r=t[n++];switch(r){case i.M:e.moveTo(t[n++],t[n++]);break;case i.L:e.lineTo(t[n++],t[n++]);break;case i.C:e.bezierCurveTo(t[n++],t[n++],t[n++],t[n++],t[n++],t[n++]);break;case i.Q:e.quadraticCurveTo(t[n++],t[n++],t[n++],t[n++]);break;case i.A:var s=t[n++],o=t[n++],u=t[n++],a=t[n++],f=t[n++],l=t[n++],c=t[n++],h=t[n++],p=u>a?u:a,d=u>a?1:u/a,v=u>a?a/u:1,m=Math.abs(u-a)>.001;m?(e.translate(s,o),e.rotate(c),e.scale(d,v),e.arc(0,0,p,f,f+l,1-h),e.scale(1/d,1/v),e.rotate(-c),e.translate(-s,-o)):e.arc(s,o,p,f,f+l,1-h);break;case i.Z:e.closePath()}}}},m.CMD=i,m}),r("zrender/contain/text",["require","../core/util"],function(e){function s(e,i){var s=e+":"+i;if(t[s])return t[s];var o=(e+"").split("\n"),a=0;for(var f=0,l=o.length;f<l;f++)a=Math.max(u.measureText(o[f],i).width,a);return n>r&&(n=0,t={}),n++,t[s]=a,a}function o(e,t,n,r){var i=e.split("\n").length,o=s(e,t),u=s("国",t),a=i*u,f={x:0,y:0,width:o,height:a,lineHeight:u};switch(r){case"bottom":case"alphabetic":f.y-=u;break;case"middle":f.y-=u/2}switch(n){case"end":case"right":f.x-=f.width;break;case"center":f.x-=f.width/2}return f}var t={},n=0,r=5e3,i=e("../core/util"),u={getWidth:s,getBoundingRect:o,measureText:function(e,t){var n=i.getContext();return n.font=t,n.measureText(e)}};return u}),r("zrender/graphic/mixin/RectText",["require","../../contain/text"],function(e){var t=e("../../contain/text"),n=function(){};return n.prototype={constructor:n,drawRectText:function(e,n,r){var i=this.style,s=this.style.text;if(!s)return;var o=n.x,u=n.y,a=i.textPosition,f=i.textDistance,l=i.textAlign,c=i.textFont,h=i.textBaseline;r=r||t.getBoundingRect(s,c,l,h);var p=n.height,d=n.width,v=r.width,m=r.height,g=d/2-v/2,y=p/2-m/2;if(a instanceof Array)o=a[0],u=a[1],e.textAlign=l,e.textBaseline=h;else{switch(i.textPosition){case"inside":o+=g,u+=y;break;case"left":o-=f+v,u+=y;break;case"right":o+=d+f,u+=y;break;case"top":o+=g,u-=f-m;break;case"bottom":o+=g,u+=p+f}e.textAlign="left",e.textBaseline="top"}var b=i.textFill,w=i.textStroke;b&&(e.fillStyle=b),w&&(e.strokeStyle=w),e.font=c;var E=s.split("\n");for(var S=0;S<E.length;S++)b&&e.fillText(E[S],o,u),w&&e.strokeText(E[S],o,u),u+=r.lineHeight}},n}),r("zrender/graphic/Style",["require"],function(e){var t=["lineCap","lineJoin","miterLimit","lineWidth","shadowBlur","shadowOffsetX","shadowOffsetY","shadowColor"],n=function(e){this.extendFrom(e)};n.prototype={constructor:n,fill:"#000000",stroke:null,opacity:1,lineDash:null,lineDashOffset:0,text:null,textFill:"#000",textStroke:null,textPosition:"inside",textBaseline:null,textAlign:null,textDistance:5,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,lineWidth:0,bind:function(e){for(var n=0;n<t.length;n++){var r=t[n];this[r]!=null&&(e[r]=this[r])}this.fill!=null&&(e.fillStyle=this.fill),this.stroke!=null&&(e.strokeStyle=this.stroke),this.opacity!=null&&(e.globalAlpha=this.opacity)},extendFrom:function(e,t){if(e){var n=this;for(var r in e)e.hasOwnProperty(r)&&(t||!n.hasOwnProperty(r))&&(n[r]=e[r])}},clone:function(){var e=new this.constructor;return e.extendFrom(this,!0),e}};var r=n.prototype,i,s;for(s=0;s<t.length;s++)i=t[s],i in r||(r[i]=null);return n}),r("zrender/graphic/States",["require","../core/util","../core/log","./Style"],function(e){var t=e("../core/util"),n=e("../core/log"),r=e("./Style"),i=function(e,t){for(var n=0;n<t.length;t++)e[n]=t[n]},s=function(e){return typeof e=="number"?[e,0,0]:e instanceof Array?(e.length<3&&(e[1]=e[2]=0),e):[0,0,0]},o=["position","rotation","scale","style","shape"],u=function(e){typeof e=="string"?this._fromStr(e):e&&(e.property&&(this.property=e.property),e.duration!=null&&(this.duration=e.duration),e.easing&&(this.easing=e.easing),e.delay&&(this.delay=e.delay)),this.property!=="*"?this.property=this.property.split(","):this.property=o};u.prototype={constructor:u,property:"*",easing:"Linear",duration:500,delay:0,_fromStr:function(e){var t=e.split(/\s+/g);this.property=t[0],this.duration=+t[1],this.delay=+t[2],this.easing=t[3]}};var a=function(e){e=e||{},this._states={},this._el=e.el,this._subStates=[],this._transitionAnimators=[],e.initialState&&(this._initialState=initialState);var t=e.states;if(t)for(var n in t){var r=t[n];this._addState(n,r)}this.setState(this._initialState)};return a.prototype={constructor:a,_initialState:"normal",_currentState:"",el:function(){return this._el},_addState:function(e,n){this._states[e]=n,n.transition&&(n.transition=new u(n.transition));if(e!==this._initialState)this._extendFromInitial(n);else{var r=this._el;t.merge(n.style,r.style,!1,!1),n.shape?t.merge(n.shape,r.shape,!1,!0):n.shape=t.clone(r.shape,!0);for(var e in this._states)this._extendFromInitial(this._states[e])}},_extendFromInitial:function(e){var n=this._states[this._initialState];n&&e!==n&&t.merge(e,n,!1,!0)},setState:function(e,n){if(e===this._currentState&&!this.transiting())return;var o=this._states[e];if(o){this._stopTransition();if(!n){var u=this._states[this._currentState];u&&u.onleave&&u.onleave.call(this),o.onenter&&o.onenter.call(this)}this._currentState=e;if(this._el){var a=this._el;o.zlevel!=null&&(a.zlevel=o.zlevel),o.z!=null&&(a.z=o.z),o.position&&i(a.position,o.position),o.scale&&i(a.scale,o.scale);var f=o.rotation;f!=null&&(o.rotation=s(o.rotation),typeof a.rotation=="number"?a.rotation=f:i(a.rotation,o.rotation));if(o.style){var l=this._states[this._initialState];a.style=new r,l&&a.style.extendFrom(l.style),e!=this._initialState&&l.style!==o.style&&a.style.extendFrom(o.style,!0)}o.shape&&(a.shape=t.clone(o.shape,!0)),a.dirty()}}for(var c=0;c<this._subStates.length;c++)this._subStates.setState(e)},getState:function(){return this._currentState},transitionState:function(e,t){if(e===this._currentState&&!this.transiting())return;var n=this._states[e],r=/$[style|shape]\./,i=this,o={};if(n){i._stopTransition();var u=i._el;if(n.transition&&u&&u.__zr){var a=n.transition,f=a.property,l=!1,c=0,t=function(){c--,c===0&&(i.setState(e),t&&t())};for(var h=0;h<f.length;h++){var p=f[h];p==="rotation"&&"rotation"in n&&(n[p]=s(n[p]),u[p]=s(u[p]));if(p==="style"||p==="shape"){if(n[p])for(var d in n[p]){var v=p+"."+d;if(o[v])continue;o[v]=1,c+=i._animProp(n,p,d,a,t)}}else{if(o[p])continue;o[p]=1;if(p.match(r)){var m=p.slice(0,5);p=p.slice(6),c+=i._animProp(n,m,p,a,t)}else c+=i._animProp(n,"",p,a,t)}}c===0&&(i.setState(e),t&&t())}else i.setState(e),t&&t()}for(var h=0;h<i._subStates.length;h++)i._subStates.transitionState(e)},_animProp:function(e,n,r,i,s){var o=this._el,u=n?e[n]:e,a=n?o[n]:o,f=u&&r in u&&a&&r in a,l=this._transitionAnimators;if(f){var c={};if(u[r]===a[r])return 0;c[r]=u[r];var h=o.animate(n).when(i.duration,c).delay(i.dealy).done(function(){var e=t.indexOf(l,1);e>0&&l.splice(e,1),s()}).start(i.easing);return l.push(h),1}return 0},_stopTransition:function(){var e=this._transitionAnimators;for(var t=0;t<e.length;t++)e[t].stop();e.length=0},transiting:function(){return this._transitionAnimators.length>0},addSubStates:function(e){this._subStates.push(e)},removeSubStates:function(e){var n=t.indexOf(this._subStates,e);n>=0&&this._subStates.splice(e,1)}},a}),r("zrender/graphic/mixin/Stateful",["require","../States"],function(e){var t=e("../States"),n=function(e){e.states&&this.initStates(e.states)};return n.prototype={initStates:function(e){this._states=new t({el:this,states:e})},setState:function(e){this._states&&this._states.setState(e)},getState:function(){return this._states&&this._states.getState()},transitionState:function(e,t){this._states&&this._states.transitionState(e,t)}},n}),r("zrender/contain/rect",{contain:function(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}}),r("zrender/graphic/Displayable",["require","../core/guid","../core/util","./Style","./mixin/RectText","./mixin/Stateful","../mixin/Eventful","../mixin/Transformable","../contain/rect"],function(e){var t=e("../core/guid"),n=e("../core/util"),r=e("./Style"),i=e("./mixin/RectText"),s=e("./mixin/Stateful"),o=e("../mixin/Eventful"),u=e("../mixin/Transformable"),a=e("../contain/rect"),f=function(e){o.call(this,e),u.call(this,e),e=e||{};for(var n in e)e.hasOwnProperty(n)&&n!=="style"&&(this[n]=e[n]);this.id=e.id||t(),this.style=new r(e.style),this._rect=null,this.__clipPaths=[],s.call(this,e)};return f.prototype={constructor:f,type:"displayable",__dirty:!0,__zr:null,ignore:!1,invisible:!1,zlevel:0,draggable:!1,hoverable:!0,beforeBrush:function(e){e.save(),this.clip(e),this.style.bind(e),this.setTransform(e)},afterBrush:function(e){e.restore()},clip:function(e){var t=this.__clipPaths;if(t)for(var n=0;n<t.length;n++){var r=t[n],i;r.needTransform&&(i=r.transform,e.transform(i[0],i[1],i[2],i[3],i[4],i[5]));var s=r._path;s.beginPath(e),r.buildPath(s,r.shape),e.clip(),r.needTransform&&(i=r.invTransform,e.transform(i[0],i[1],i[2],i[3],i[4],i[5]))}},brush:function(e,t){},getBoundingRect:function(e){},contain:function(e,t){return this.rectContain(e,t)},rectContain:function(e,t){var n=this.transformCoordToLocal(e,t);return a.contain(this.getBoundingRect(),n[0],n[1])},dirty:function(){this.__dirty=!0,this._rect=null,this.__zr&&this.__zr.refreshNextFrame()},drift:function(e,t){switch(this.draggable){case"horizontal":t=0;break;case"vertical":e=0}this.position[0]+=e,this.position[1]+=t,this.dirty()},animate:function(e,t){if(this.__zr)return this.__zr.animate(this,e,t)},stopAnimation:function(){return this.__zr&&this.__zr.stopAnimation(this),this},isSilent:function(){return!(this.hoverable||this.draggable||this.onmousemove||this.onmouseover||this.onmouseout||this.onmousedown||this.onmouseup||this.onclick||this.ondragenter||this.ondragover||this.ondragleave||this.ondrop)}},n.inherits(f,o),n.inherits(f,u),n.inherits(f,i),n.inherits(f,s),f}),r("zrender/graphic/helper/roundRect",["require"],function(e){return{buildPath:function(e,t){var n=t.x,r=t.y,i=t.width,s=t.height,o=t.r,u,a,f,l;typeof o=="number"?u=a=f=l=o:o instanceof Array?o.length===1?u=a=f=l=o[0]:o.length===2?(u=f=o[0],a=l=o[1]):o.length===3?(u=o[0],a=l=o[1],f=o[2]):(u=o[0],a=o[1],f=o[2],l=o[3]):u=a=f=l=0;var c;u+a>i&&(c=u+a,u*=i/c,a*=i/c),f+l>i&&(c=f+l,f*=i/c,l*=i/c),a+f>s&&(c=a+f,a*=s/c,f*=s/c),u+l>s&&(c=u+l,u*=s/c,l*=s/c),e.moveTo(n+u,r),e.lineTo(n+i-a,r),a!==0&&e.quadraticCurveTo(n+i,r,n+i,r+a),e.lineTo(n+i,r+s-f),f!==0&&e.quadraticCurveTo(n+i,r+s,n+i-f,r+s),e.lineTo(n+l,r+s),l!==0&&e.quadraticCurveTo(n,r+s,n,r+s-l),e.lineTo(n,r+u),u!==0&&e.quadraticCurveTo(n,r,n+u,r)}}}),r("zrender/graphic/Image",["require","./Displayable","../core/util","./helper/roundRect"],function(e){var t=e("./Displayable"),n=e("../core/util"),r=e("./helper/roundRect"),i=function(e){t.call(this,e)};return i.prototype={constructor:i,type:"image",brush:function(e){var t=this.style,n=t.image,i=this;this._imageCache||(this._imageCache={});if(typeof n=="string"){var s=n;this._imageCache[s]?n=this._imageCache[s]:(n=new Image,n.onload=function(){n.onload=null,i.dirty()},n.src=s,this._imageCache[s]=n)}if(n){if(n.nodeName.toUpperCase()=="IMG"&&!n.complete)return;var o=t.width||n.width,u=t.height||n.height,a=t.x||0,f=t.y||0;if(!n.width||!n.height)return;e.save(),this.clip(e),t.bind(e),this.setTransform(e),t.r&&(e.beginPath(),r.buildPath(e,t),e.clip());if(t.sWidth&&t.sHeight){var l=t.sx||0,c=t.sy||0;e.drawImage(n,l,c,t.sWidth,t.sHeight,a,f,o,u)}else if(t.sx&&t.sy){var l=t.sx,c=t.sy,h=o-l,p=u-c;e.drawImage(n,l,c,h,p,a,f,o,u)}else e.drawImage(n,a,f,o,u);t.width==null&&(t.width=o),t.height==null&&(t.height=u),this.drawRectText(e,this.getBoundingRect()),e.restore()}},getBoundingRect:function(){var e=this.style;return this._rect||(this._rect={x:e.x,y:e.y,width:e.width||0,height:e.height||0}),this._rect}},n.inherits(i,t),i}),r("zrender/graphic/Text",["require","./Displayable","../core/util","../contain/text"],function(e){var t=e("./Displayable"),n=e("../core/util"),r=e("../contain/text"),i=function(e){t.call(this,e)};return i.prototype={constructor:i,type:"text",brush:function(e){this.beforeBrush(e);var t=this.style;if(t.text)return this.drawRectText(e,{x:t.x||0,y:t.y||0,width:0,height:0},this.getBoudingRect());this.afterBrush(e)},getBoudingRect:function(){if(!this._rect){var e=this.style;this._rect=r.getBoudingRect(e.text,e.textFont,e.textAlign,e.textBaseline)}return this._rect}},n.inherits(i,t),i}),r("zrender/contain/line",{containStroke:function(e,t,n,r,i,s,o){if(i===0)return!1;var u=Math.max(i,5),a=0,f=e;if(o>t+u&&o>r+u||o<t-u&&o<r-u||s>e+u&&s>n+u||s<e-u&&s<n-u)return!1;if(e===n)return Math.abs(s-e)<=u/2;a=(t-r)/(e-n),f=(e*r-n*t)/(e-n);var l=a*s-o+f,c=l*l/(a*a+1);return c<=u/2*u/2}}),r("zrender/contain/cubic",["require","../core/curve"],function(e){var t=e("../core/curve");return{containStroke:function(e,n,r,i,s,o,u,a,f,l,c){if(f===0)return!1;var h=Math.max(f,5);if(c>n+h&&c>i+h&&c>o+h&&c>a+h||c<n-h&&c<i-h&&c<o-h&&c<a-h||l>e+h&&l>r+h&&l>s+h&&l>u+h||l<e-h&&l<r-h&&l<s-h&&l<u-h)return!1;var p=t.cubicProjectPoint(e,n,r,i,s,o,u,a,l,c,null);return p<=h/2}}}),r("zrender/contain/quadratic",["require","../core/curve"],function(e){var t=e("../core/curve");return{containStroke:function(e,n,r,i,s,o,u,a,f){if(u===0)return!1;var l=Math.max(u,5);if(f>n+l&&f>i+l&&f>o+l||f<n-l&&f<i-l&&f<o-l||a>e+l&&a>r+l&&a>s+l||a<e-l&&a<r-l&&a<s-l)return!1;var c=t.quadraticProjectPoint(e,n,r,i,s,o,a,f,null);return c<=l/2}}}),r("zrender/contain/util",["require"],function(e){var t=Math.PI*2;return{normalizeRadian:function(e){return e%=t,e<0&&(e+=t),e}}}),r("zrender/contain/arc",["require","./util"],function(e){var t=e("./util").normalizeRadian,n=Math.PI*2;return{containStroke:function(e,r,i,s,o,u,a,f,l){if(a===0)return!1;var c=Math.max(a,5);f-=e,l-=r;var h=Math.sqrt(f*f+l*l);if(h-c>i||h+c<i)return!1;if(Math.abs(s-o)>=n)return!0;if(u){var p=s;s=t(o),o=t(p)}else s=t(s),o=t(o);s>o&&(o+=n);var d=Math.atan2(l,f);return d<0&&(d+=n),d>=s&&d<=o||d+n>=s&&d+n<=o}}}),r("zrender/contain/path",["require","../core/PathProxy","./line","./cubic","./quadratic","./arc","./util","../core/curve"],function(e){function f(e,t,n,r,i,s){if(s>t&&s>r||s<t&&s<r)return 0;if(r==t)return 0;var o=r<t?1:-1,u=(s-t)/(r-t),a=u*(n-e)+e;return a>i?o:0}function h(){var e=c[0];c[0]=c[1],c[1]=e}function p(e,t,n,r,i,s,o,a,f,p){if(p>t&&p>r&&p>s&&p>a||p<t&&p<r&&p<s&&p<a)return 0;var d=u.cubicRootAt(t,r,s,a,p,l);if(d===0)return 0;var v=0,m=-1,g,y;for(var b=0;b<d;b++){var w=l[b],E=u.cubicAt(e,n,i,o,w);if(E<f)continue;m<0&&(m=u.cubicExtrema(t,r,s,a,c),c[1]<c[0]&&m>1&&h(),g=u.cubicAt(t,r,s,a,c[0]),m>1&&(y=u.cubicAt(t,r,s,a,c[1]))),m==2?w<c[0]?v+=g<t?1:-1:w<c[1]?v+=y<g?1:-1:v+=a<y?1:-1:w<c[0]?v+=g<t?1:-1:v+=a<g?1:-1}return v}function d(e,t,n,r,i,s,o,a){if(a>t&&a>r&&a>s||a<t&&a<r&&a<s)return 0;var f=u.quadraticRootAt(t,r,s,a,l);if(f===0)return 0;var c=u.quadraticExtremum(t,r,s);if(c>=0&&c<=1){var h=0,p=u.quadraticAt(t,r,s,c);for(var d=0;d<f;d++){var v=u.quadraticAt(e,n,i,l[d]);if(v>o)continue;l[d]<c?h+=p<t?1:-1:h+=s<p?1:-1}return h}var v=u.quadraticAt(e,n,i,l[0]);return v>o?0:s<t?1:-1}function v(e,t,n,r,i,s,u,f){f-=t;if(f>n||f<-n)return 0;var c=Math.sqrt(n*n-f*f);l[0]=-c,l[1]=c;if(Math.abs(r-i)>=a){r=0,i=a;var h=s?1:-1;return u>=l[0]+e&&u<=l[1]+e?h:0}if(s){var c=r;r=o(i),i=o(c)}else r=o(r),i=o(i);r>i&&(i+=a);var p=0;for(var d=0;d<2;d++){var v=l[d];if(v+e>u){var m=Math.atan2(f,v),h=s?1:-1;m<0&&(m=a+m);if(m>=r&&m<=i||m+a>=r&&m+a<=i)m>Math.PI/2&&m<Math.PI*1.5&&(h=-h),p+=h}}return p}function m(e,o,u,a,l){var c=0,h=0,m=0,g=0,y=0;for(var b=0;b<e.length;){var w=e[b++];if(w===t.M&&b>1){u||(c+=f(h,m,g,y,a,l));if(c!==0)return!0}b==1&&(h=e[b],m=e[b+1],g=h,y=m);switch(w){case t.M:g=e[b++],y=e[b++],h=g,m=y;break;case t.L:if(u){if(n.containStroke(h,m,e[b],e[b+1],o,a,l))return!0}else c+=f(h,m,e[b],e[b+1],a,l)||0;h=e[b++],m=e[b++];break;case t.C:if(u){if(r.containStroke(h,m,e[b++],e[b++],e[b++],e[b++],e[b],e[b+1],o,a,l))return!0}else c+=p(h,m,e[b++],e[b++],e[b++],e[b++],e[b],e[b+1],a,l)||0;h=e[b++],m=e[b++];break;case t.Q:if(u){if(i.containStroke(h,m,e[b++],e[b++],e[b],e[b+1],o,a,l))return!0}else c+=d(h,m,e[b++],e[b++],e[b],e[b+1],a,l)||0;h=e[b++],m=e[b++];break;case t.A:var E=e[b++],S=e[b++],x=e[b++],T=e[b++],N=e[b++],C=e[b++],k=e[b++],L=1-e[b++],A=Math.cos(N)*x+E,O=Math.sin(N)*T+S;b>1?c+=f(h,m,A,O):(g=A,y=O);var M=(a-E)*T/x+E;if(u){if(s.containStroke(E,S,T,N,N+C,L,o,M,l))return!0}else c+=v(E,S,T,N,N+C,L,M,l);h=Math.cos(N+C)*x+E,m=Math.sin(N+C)*T+S;break;case t.Z:if(u){if(n.containStroke(h,m,g,y,o,a,l))return!0}else{c+=f(h,m,g,y,a,l);if(c!==0)return!0}h=g,m=y}}return u||(c+=f(h,m,g,y,a,l)||0),c!==0}var t=e("../core/PathProxy").CMD,n=e("./line"),r=e("./cubic"),i=e("./quadratic"),s=e("./arc"),o=e("./util").normalizeRadian,u=e("../core/curve"),a=Math.PI*2,l=[-1,-1,-1],c=[-1,-1];return{contain:function(e,t,n){return m(e,0,!1,t,n)},containStroke:function(e,t,n,r){return m(e,t,!0,n,r)}}}),r("zrender/graphic/Path",["require","./Displayable","../core/util","../core/PathProxy","../contain/path","../contain/rect"],function(e){function o(e){return e.fill!=null}function u(e){return e.stroke!=null}var t=e("./Displayable"),n=e("../core/util"),r=e("../core/PathProxy"),i=e("../contain/path"),s=e("../contain/rect"),a=function(e){t.call(this,e),this._path=new r};return a.prototype={constructor:a,type:"path",__dirtyPath:!0,brush:function(e){this.beforeBrush(e);var t=this.style,n=this._path,r=u(t),i=o(t),s=t.lineDash,a=t.lineDashOffset,f=!!e.setLineDash;this.__dirtyPath||s&&!f&&r?(n=this._path.beginPath(e),s&&!f&&(n.setLineDash(s),n.setLineDashOffset(a)),this.buildPath(n,this.shape),this.__dirtyPath=!1):(e.beginPath(),this._path.rebuildPath(e)),i&&n.fill(e),s&&f&&(e.setLineDash(s),e.lineDashOffset=a),r&&n.stroke(e),t.text&&this.drawRectText(e,this.getBoundingRect()),this.afterBrush(e)},buildPath:function(e,t){},getBoundingRect:function(){this._rect||(this._rect=this._path.getBoundingRect());if(u(this.style)){var e=this._rect,t=this.style.lineWidth;e.width+=t,e.height+=t,e.x-=t/2,e.y-=t/2}return this._rect},contain:function(e,t){var n=this.transformCoordToLocal(e,t),r=this.getBoundingRect(),a=this.style;e=n[0],t=n[1];if(s.contain(r,e,t)){var f=this._path.data;if(u(a)&&i.containStroke(f,a.lineWidth,e,t))return!0;if(o(a))return i.contain(f,e,t)}return!1},dirty:function(e){arguments.length===0&&(e=!0),e&&(this.__dirtyPath=e,this._rect=null),this.__dirty=!0,this.__zr&&this.__zr.refreshNextFrame()}},a.extend=function(e){var t=function(t){a.call(this,t),e.style&&this.style.extendFrom(e.style,!1);var n=e.shape;if(n){this.shape=this.shape||{};var r=this.shape;for(var i in n)!r.hasOwnProperty(i)&&n.hasOwnProperty(i)&&(r[i]=n[i])}e.init&&e.init.call(this,t)};n.inherits(t,a);for(var r in e)r!=="style"&&r!=="shape"&&(t.prototype[r]=e[r]);return t},n.inherits(a,t),a}),r("zrender/vml/core",["require","../core/env"],function(e){function u(){if(s)return;s=!0;var e=i.styleSheets;e.length<31?i.createStyleSheet().addRule(".zrvml","behavior:url(#default#VML)"):e[0].addRule(".zrvml","behavior:url(#default#VML)")}if(e("../core/env").canvasSupported)return;var t="urn:schemas-microsoft-com:vml",n,r=window,i=r.document,s=!1;try{!i.namespaces.zrvml&&i.namespaces.add("zrvml",t),n=function(e){return i.createElement("<zrvml:"+e+' class="zrvml">')}}catch(o){n=function(e){return i.createElement("<"+e+' xmlns="'+t+'" class="zrvml">')}}return{doc:i,initVML:u,createNode:n}}),r("zrender/vml/graphic",["require","../core/env","../core/vector","../core/PathProxy","../tool/color","../contain/text","../graphic/mixin/RectText","../graphic/Displayable","../graphic/Image","../graphic/Text","../graphic/Path","./core"],function(e){function x(e){e.style.cssText="position:absolute;left:0;top:0;width:1px;height:1px;",e.coordsize=w+","+w,e.coordorigin="0,0"}function T(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;")}function N(e,t,n){return"rgb("+[e,t,n].join(",")+")"}function C(e,t){t&&e&&t.parentNode!==e&&e.appendChild(t)}function k(e,t){t&&e&&t.parentNode===e&&e.removeChild(t)}function L(e,t){return(parseInt(e)||0)*S+parseInt(t)||0}function A(e,t,n){t=r.toArray(t),e.color=N(t[0],t[1],t[2]),e.opacity=n*t[3]}function O(e,t){t.fill!=null&&A(e,t.fill,t.opacity)}function M(e,t){t.lineJoin!=null&&(e.joinstyle=t.lineJoin),t.miterLimit!=null&&(e.miterlimit=t.miterLimit*w),t.lineCap!=null&&(e.endcap=t.lineCap),t.lineDash!=null&&(e.dashstyle=t.lineDash.join(" ")),t.stroke!=null&&A(e,t.stroke,t.opacity)}function _(e,t,n){var r=t=="fill",i=e.getElementsByTagName(t)[0];n[t]!=null?(e[r?"filled":"stroked"]="true",i||(i=l.createNode(t),e.appendChild(i)),r?O(i,n):M(i,n)):(e[r?"filled":"stroked"]="false",i&&e.removeChild(i))}function P(e,r){var i=n.M,s=n.C,o=n.L,u=n.A,a=n.Q,f=[],l,p,m,g,b,S;for(g=0;g<e.length;){m=e[g++],p="",l=0;switch(m){case i:p=" m ",l=1,b=e[g++],S=e[g++],D[0][0]=b,D[0][1]=S;break;case o:p=" l ",l=1,b=e[g++],S=e[g++],D[0][0]=b,D[0][1]=S;break;case a:case s:p=" c ",l=3;var x=e[g++],T=e[g++],N=e[g++],C=e[g++],k,L;m===a?(k=N,L=C,N=(N+2*x)/3,C=(C+2*T)/3,x=(b+2*x)/3,T=(S+2*T)/3):(k=e[g++],L=e[g++]),D[0][0]=x,D[0][1]=T,D[1][0]=N,D[1][1]=C,D[2][0]=k,D[2][1]=L,b=k,S=L;break;case u:var A=0,O=0,M=1,_=1,P=0;r&&(A=r[4],O=r[5],M=h(r[0]*r[0]+r[1]*r[1]),_=h(r[2]*r[2]+r[3]*r[3]),P=Math.atan2(-r[1]/_,r[0]/M));var H=e[g++]+A,B=e[g++]+O,j=e[g++]*M,F=e[g++]*_,I=e[g++]+P,q=e[g++]+I+P,R=e[g++],U=e[g++],z=H+d(I)*j,W=B+v(I)*F,x=H+d(q)*j,T=B+v(q)*F,X=U?" wa ":" at ";f.push(X,c((H-j)*w-E),y,c((B-F)*w-E),y,c((H+j)*w-E),y,c((B+F)*w-E),y,c(z*w-E),y,c(W*w-E),y,c(x*w-E),y,c(T*w-E),y),b=x,S=T;break;case n.Z:f.push(" x ")}if(l>0){f.push(p);for(var V=0;V<l;V++){var $=D[V];r&&t.applyTransform($,$,r),f.push(c($[0]*w-E),y,c($[1]*w-E),V<l-1?y:"")}}}return f.join("")}function H(e){return e instanceof Object&&e.tagName&&e.tagName.toUpperCase()=="IMG"}function R(e){var t=j[e];if(!t){F>I&&(F=0,j={});var n=q.style,r;try{n.font=e,r=n.fontFamily.split(",")[0]}catch(i){}t={style:n.fontStyle||B,variant:n.fontVariant||B,weight:n.fontWeight||B,size:n.fontSize||12,family:r||"Microsoft YaHei"},j[e]=t,F++}return t.style+" "+t.variant+" "+t.weight+" "+t.size+"px '"+t.family+"'"}function W(e){k(e,this._textVmlEl),this._textVmlEl=null}if(e("../core/env").canvasSupported)return;var t=e("../core/vector"),n=e("../core/PathProxy").CMD,r=e("../tool/color"),i=e("../contain/text"),s=e("../graphic/mixin/RectText"),o=e("../graphic/Displayable"),u=e("../graphic/Image"),a=e("../graphic/Text"),f=e("../graphic/Path"),l=e("./core"),c=Math.round,h=Math.sqrt,p=Math.abs,d=Math.cos,v=Math.sin,m=Math.max,g=t.applyTransform,y=",",b="progid:DXImageTransform.Microsoft",w=21600,E=w/2,S=1e4,D=[[],[],[]];f.prototype.brush=function(e){var t=this.style,n=this._vmlEl;n||(n=l.createNode("shape"),x(n),this._vmlEl=n),_(n,"fill",t),_(n,"stroke",t);var r=this.needTransform,i=n.getElementsByTagName("stroke")[0];if(i){var s=t.lineWidth;if(r){var o=this.transform,u=o[0]*o[3]-o[1]*o[2];s*=h(p(u))}i.weight=s+"px"}var a=this._path;this.__dirtyPath&&(a.beginPath(),this.buildPath(a,this.shape),this.__dirtyPath=!1),n.path=P(a.data,this.transform),n.style["z-index"]=L(this.zlevel,this.z),C(e,n),t.text&&this.drawRectText(e,this.getBoundingRect())},f.prototype.dispose=function(e){k(e,this._vmlEl),this.disposeRectText(e)},u.prototype.brush=function(e){var t=this.style,n=t.image,r,i;if(H(n)){var s=n.src;if(s===this._imageSrc)r=this._imageWidth,i=this._imageHeight;else{var o=n.runtimeStyle,u=o.width,a=o.height;o.width="auto",o.height="auto",r=n.width,i=n.height,o.width=u,o.height=a,this._imageSrc=s,this._imageWidth=r,this._imageHeight=i}n=s}else n===this._imageSrc&&(r=this._imageWidth,i=this._imageHeight);if(!n)return;var f=t.x||0,p=t.y||0,d=t.width,v=t.height,w=t.sWidth,E=t.sHeight,S=t.sx||0,T=t.sy||0,N=w&&E,k=this._vmlEl;k||(k=l.doc.createElement("div"),x(k),this._vmlEl=k);var A=k.style,O=!1,M,_=1,D=1;this.needTransform&&(M=this.transform,_=h(M[0]*M[0]+M[1]*M[1]),D=h(M[2]*M[2]+M[3]*M[3]),O=M[1]||M[2]);if(O){var P=[f,p],B=[f+d,p],j=[f,p+v],F=[f+d,p+v];g(P,P,M),g(B,B,M),g(j,j,M),g(F,F,M);var I=m(P[0],B[0],j[0],F[0]),q=m(P[1],B[1],j[1],F[1]),R=[];R.push("M11=",M[0]/_,y,"M12=",M[2]/D,y,"M21=",M[1]/_,y,"M22=",M[3]/D,y,"Dx=",c(f+M[4]),y,"Dy=",c(p+M[5])),A.padding="0 "+c(I)+"px "+c(q)+"px 0",A.filter=b+".Matrix("+R.join("")+", SizingMethod=clip)"}else M&&(f+=M[4],p+=M[5]),A.filter="",A.left=c(f)+"px",A.top=c(p)+"px";var U=this._imageEl,z=this._cropEl;U||(U=l.doc.createElement("div"),this._imageEl=U);var W=U.style;if(N){if(!r||!i){var X=new Image,V=this;X.onload=function(){X.onload=null,r=X.width,i=X.height,W.width=c(_*r*d/w)+"px",W.height=c(D*i*v/E)+"px",V._imageWidth=r,V._imageHeight=i,V._imageSrc=n},X.src=n}else W.width=c(_*r*d/w)+"px",W.height=c(D*i*v/E)+"px";z||(z=l.doc.createElement("div"),z.style.overflow="hidden",this._cropEl=z);var $=z.style;$.width=c((d+S*d/w)*_),$.height=c((v+T*v/E)*D),$.filter=b+".Matrix(Dx="+ -S*d/w*_+",Dy="+ -T*v/E*D+")",z.parentNode||k.appendChild(z),U.parentNode!=z&&z.appendChild(U)}else W.width=c(_*d)+"px",W.height=c(D*v)+"px",k.appendChild(U),z&&z.parentNode&&(k.removeChild(z),this._cropEl=null);var J="",K=t.opacity;K<1&&(J+=".Alpha(opacity="+c(K*100)+") "),J+=b+".AlphaImageLoader(src="+n+", SizingMethod=scale)",W.filter=J,k.style["z-index"]=L(this.zlevel,this.z),C(e,k),t.text&&this.drawRectText(e,this.getBoundingRect())},u.prototype.dispose=function(e){k(e,this._vmlEl),this._vmlEl=null,this._cropEl=null,this._imageEl=null,this.disposeRectText(e)};var B="normal",j={},F=0,I=100,q=document.createElement("div"),U;i.measureText=function(e,t){var n=l.doc;U||(U=n.createElement("div"),U.style.cssText="position:absolute;top:-20000px;left:0;                padding:0;margin:0;border:none;white-space:pre;",l.doc.body.appendChild(U));try{U.style.font=t}catch(r){}return U.innerHTML="",U.appendChild(n.createTextNode(e)),{width:U.offsetWidth}};var z=function(e,n,r){var s=this.style,o=this.style.text;if(!o)return;var u=n.x,a=n.y,f=s.textPosition,h=s.textDistance,p=s.textAlign,d=T(R(s.textFont||"")),v=s.textBaseline;r=r||i.getBoundingRect(o,d,p,v);var m=n.height,g=n.width,b=r.width,w=r.height,E=g/2-b/2,S=m/2-w/2;if(f instanceof Array)u=f[0],a=f[1];else switch(s.textPosition){case"left":u-=h+b,a+=S;break;case"right":u+=g+h,a+=S;break;case"top":u+=E,a-=h-w;break;case"bottom":u+=E,a+=m+h;break;case"inside":u+=E,a+=S}var N=l.createNode,k=this._textVmlEl,A,O,M;k?(M=k.firstChild,A=M.nextSibling,O=A.nextSibling):(k=N("line"),A=N("path"),O=N("textpath"),M=N("skew"),x(k),A.textpathok=!0,O.on=!0,O.style["v-text-align"]="left",k.from="0 0",k.to="1000 0.05",C(k,M),C(k,A),C(k,O),this._textVmlEl=k),a+=r.height/2;var D=[u,a],P,H=k.style;this.needTransform?(P=this.transform,t.applyTransform(D,D,P),M.on=!0,M.matrix=P[0].toFixed(3)+y+P[2].toFixed(3)+y+P[1].toFixed(3)+y+P[3].toFixed(3)+",0,0",M.offset=c(D[0])+","+c(D[1]),M.origin="0 0",H.left="0px",H.top="0px"):(M.on=!1,H.left=c(u)+"px",H.top=c(a)+"px"),O.string=T(o);try{O.style.font=d}catch(B){}_(k,"fill",{fill:s.textFill||s.fill,opacity:s.opacity}),_(k,"stroke",{stroke:s.textStroke||s.stroke,opacity:s.opacity,lineDash:s.lineDash}),k.style["z-index"]=L(this.zlevel,this.z),C(e,k)},X=[s,o,u,f,a];for(var V=0;V<X.length;V++){var $=X[V].prototype;$.drawRectText=z,$.disposeRectText=W}a.prototype.brush=function(e){var t=this.style;t.text&&this.drawRectText(e,{x:t.x||0,y:t.y||0,width:0,height:0},this.getBoundingRect())},a.prototype.dispose=function(e){this.disposeRectText(e)}}),r("zrender/vml/Painter",["require","../core/log","./core"],function(e){function r(e){return parseInt(e,10)}function s(e){return function(){t('In IE8.0 VML mode painter not support method "'+e+'"')}}var t=e("../core/log"),n=e("./core"),i=function(e,t){n.initVML(),this.root=e,this.storage=t;var r=document.createElement("div"),i=document.createElement("div");r.style.cssText="display:inline-block;overflow:hidden;position:relative;            width:300px;height:150px;",i.style.cssText="position:absolute;left:0;top:0",e.appendChild(r),this._vmlRoot=i,this._vmlContainer=r,this.resize();var s=t.delFromMap,o=t.addToMap;t.delFromMap=function(e){var n=t.get(e);s.call(t,e),n&&n.dispose&&n.dispose(i)},t.addToMap=function(e){var n=e.__vmlEl;n&&i.appendChild(n),o.call(t,e)},this._firstPaint=!0};i.prototype={constructor:i,refresh:function(){var e=this.storage.getDisplayList(!0);this._paintList(e)},_paintList:function(e){var t=this._vmlRoot,n=t.parentNode;for(var r=0;r<e.length;r++){var i=e[r];i.__dirty&&!i.invisible&&(i.brush(t),i.__dirty=!1)}this._firstPaint&&(this._vmlContainer.appendChild(t),this._firstPaint=!1)},resize:function(){var e=this._getWidth(),t=this._getHeight();if(this._width!=e&&this._height!=t){this._width=e,this._height=t;var n=this._vmlContainer.style;n.width=e+"px",n.height=t+"px"}},dispose:function(){this.root.innerHTML="",this._vmlRoot=this._vmlContainer=this.storage=null},getWidth:function(){return this._width},getHeight:function(){return this._height},getVMLRoot:function(){return this._vmlRoot},_getHeight:function(){return this._height},_getWidth:function(){var e=this.root,t=e.currentStyle;return(e.clientWidth||r(t.width))-r(t.paddingLeft)-r(t.paddingRight)|0},_getHeight:function(){var e=this.root,t=e.currentStyle;return(e.clientHeight||r(t.height))-r(t.paddingTop)-r(t.paddingBottom)|0}};var o=["getLayer","insertLayer","eachLayer","eachBuildinLayer","eachOtherLayer","getLayers","modLayer","delLayer","clearLayer","toDataURL","pathToImage"];for(var u=0;u<o.length;u++){var a=o[u];i.prototype[a]=s(a)}return i}),r("zrender/Layer",["require","./core/util","./config"],function(e){function r(){return!1}function i(e,t,r){var i=document.createElement(t),s=r.getWidth(),o=r.getHeight(),u=i.style;return u.position="absolute",u.left=0,u.top=0,u.width=s+"px",u.height=o+"px",i.width=s*n.devicePixelRatio,i.height=o*n.devicePixelRatio,i.setAttribute("data-zr-dom-id",e),i}var t=e("./core/util"),n=e("./config"),s=function(e,t){this.id=e,this.dom=i(e,"canvas",t);var n=this.dom,s=n.style;n.onselectstart=r,s["-webkit-user-select"]="none",s["user-select"]="none",s["-webkit-touch-callout"]="none",s["-webkit-tap-highlight-color"]="rgba(0,0,0,0)",this.domBack=null,this.ctxBack=null,this.painter=t,this.config=null,this.clearColor=0,this.motionBlur=!1,this.lastFrameAlpha=.7};return s.prototype={constructor:s,elCount:0,__dirty:!0,initContext:function(){this.ctx=this.dom.getContext("2d");var e=n.devicePixelRatio;e!=1&&this.ctx.scale(e,e)},createBackBuffer:function(){this.domBack=i("back-"+this.id,"canvas",this.painter),this.ctxBack=this.domBack.getContext("2d");var e=n.devicePixelRatio;e!=1&&this.ctxBack.scale(e,e)},resize:function(e,t){var r=n.devicePixelRatio,i=this.dom,s=i.style,o=this.domBack;s.width=e+"px",s.height=t+"px",i.width=e*r,i.height=t*r,r!=1&&this.ctx.scale(r,r),o&&(o.width=e*r,o.height=t*r,r!=1&&this.ctxBack.scale(r,r))},clear:function(){var e=this.dom,t=this.ctx,r=e.width,i=e.height,s=this.clearColor,o=this.motionBlur,u=this.lastFrameAlpha,a=n.devicePixelRatio;o&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(e,0,0,r/a,i/a)),t.clearRect(0,0,r/a,i/a),s&&(t.save(),t.fillStyle=this.clearColor,t.fillRect(0,0,r/a,i/a),t.restore());if(o){var f=this.domBack;t.save(),t.globalAlpha=u,t.drawImage(f,0,0,r/a,i/a),t.restore()}}},s}),r("zrender/Painter",["require","./config","./core/util","./core/log","./core/env","./Layer","./graphic/Image"],function(e){function o(e){return parseInt(e,10)}function u(){return!1}function a(){}function f(e){return e?e.isBuildin?!0:typeof e.resize!="function"||typeof e.refresh!="function"?!1:!0:!1}function l(e){e.__unusedCount++}function c(e){e.__dirty=!1,e.__unusedCount==1&&e.clear()}var t=e("./config"),n=e("./core/util"),r=e("./core/log"),i=e("./core/env"),s=e("./Layer"),h=function(e,t){this.root=e;var n=e.style;n["-webkit-tap-highlight-color"]="transparent",n["-webkit-user-select"]="none",n["user-select"]="none",n["-webkit-touch-callout"]="none",this.storage=t,e.innerHTML="",this._width=this._getWidth(),this._height=this._getHeight();var r=document.createElement("div");this._domRoot=r;var i=r.style;i.position="relative",i.overflow="hidden",i.width=this._width+"px",i.height=this._height+"px",e.appendChild(r),this._layers={},this._zlevelList=[],this._layerConfig={},this.pathToImage=this._createPathToImage()};return h.prototype={constructor:h,refresh:function(e){var t=this.storage.getDisplayList(!0);this._paintList(t,e);for(var n=0;n<this._zlevelList.length;n++){var r=this._zlevelList[n],i=this._layers[r];!i.isBuildin&&i.refresh&&i.refresh()}return this},_paintList:function(e,t){typeof t=="undefined"&&(t=!1),this._updateLayerStatus(e);var n,i,s;this.eachBuildinLayer(l);for(var o=0,u=e.length;o<u;o++){var a=e[o];i!==a.zlevel&&(i=a.zlevel,n=this.getLayer(i),n.isBuildin||r("ZLevel "+i+" has been used by unkown layer "+n.id),s=n.ctx,n.__unusedCount=0,(n.__dirty||t)&&n.clear()),(n.__dirty||t)&&!a.invisible&&(!a.onbrush||a.onbrush&&!a.onbrush(s,!1))&&a.brush(s,!1),a.__dirty=!1}this.eachBuildinLayer(c)},getLayer:function(e){var t=this._layers[e];return t||(t=new s(e,this),t.isBuildin=!0,this._layerConfig[e]&&n.merge(t,this._layerConfig[e],!0),this.insertLayer(e,t),t.initContext()),t},insertLayer:function(e,t){var n=this._layers,i=this._zlevelList,s=i.length,o=null,u=-1,a=this._domRoot;if(n[e]){r("ZLevel "+e+" has been used already");return}if(!f(t)){r("Layer of zlevel "+e+" is not valid");return}if(s>0&&e>i[0]){for(u=0;u<s-1;u++)if(i[u]<e&&i[u+1]>e)break;o=n[i[u]]}i.splice(u+1,0,e);if(o){var l=o.dom;l.nextSibling?a.insertBefore(t.dom,l.nextSibling):a.appendChild(t.dom)}else a.firstChild?a.insertBefore(t.dom,a.firstChild):a.appendChild(t.dom);n[e]=t},eachLayer:function(e,t){var n=this._zlevelList,r,i;for(i=0;i<n.length;i++)r=n[i],e.call(t,this._layers[r],r)},eachBuildinLayer:function(e,t){var n=this._zlevelList,r,i,s;for(s=0;s<n.length;s++)i=n[s],r=this._layers[i],r.isBuildin&&e.call(t,r,i)},eachOtherLayer:function(e,t){var n=this._zlevelList,r,i,s;for(s=0;s<n.length;s++)i=n[s],r=this._layers[i],r.isBuildin||e.call(t,r,i)},getLayers:function(){return this._layers},_updateLayerStatus:function(e){var t=this._layers,n={};this.eachBuildinLayer(function(e,t){n[t]=e.elCount,e.elCount=0});for(var r=0,i=e.length;r<i;r++){var s=e[r],o=s.zlevel,u=t[o];if(u){u.elCount++;if(u.__dirty)continue;u.__dirty=s.__dirty}}this.eachBuildinLayer(function(e,t){n[t]!==e.elCount&&(e.__dirty=!0)})},clear:function(){return this.eachBuildinLayer(this._clearLayer),this},_clearLayer:function(e){e.clear()},configLayer:function(e,t){if(t){var r=this._layerConfig;r[e]?n.merge(r[e],t,!0):r[e]=t;var i=this._layers[e];i&&n.merge(i,r[e],!0)}},delLayer:function(e){var t=this._layers[e];if(!t)return;this.modLayer(e,{position:t.position,rotation:t.rotation,scale:t.scale}),t.dom.parentNode.removeChild(t.dom),delete this._layers[e],this._zlevelList.splice(n.indexOf(this._zlevelList,e),1)},resize:function(){var e=this._domRoot;e.style.display="none";var t=this._getWidth(),n=this._getHeight();e.style.display="";if(this._width!=t||n!=this._height){this._width=t,this._height=n,e.style.width=t+"px",e.style.height=n+"px";for(var r in this._layers)this._layers[r].resize(t,n);this.refresh(!0)}return this},clearLayer:function(e){var t=this._layers[e];t&&t.clear()},dispose:function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},toDataURL:function(e,t,n){var r=new s("image",this);this._domRoot.appendChild(r.dom),r.initContext();var i=r.ctx;r.clearColor=t||"#fff",r.clear();var o=this,u=this.storage.getDisplayList(!0);for(var a=0;a<u.length;a++){var f=u[a];f.invisible||(!f.onbrush||f.onbrush&&!f.onbrush(i,!1))&&f.brush(i,!1)}var l=r.dom.toDataURL(e,n);return i=null,this._domRoot.removeChild(r.dom),l},getWidth:function(){return this._width},getHeight:function(){return this._height},_getWidth:function(){var e=this.root,t=e.currentStyle||document.defaultView.getComputedStyle(e);return(e.clientWidth||o(t.width))-o(t.paddingLeft)-o(t.paddingRight)|0},_getHeight:function(){var e=this.root,t=e.currentStyle||document.defaultView.getComputedStyle(e);return(e.clientHeight||o(t.height))-o(t.paddingTop)-o(t.paddingBottom)|0},_pathToImage:function(t,n,r,i,s){var o=document.createElement("canvas"),u=o.getContext("2d");o.width=r*s,o.height=i*s,u.clearRect(0,0,r*s,i*s);var a={position:n.position,rotation:n.rotation,scale:n.scale};n.position=[0,0,0],n.rotation=0,n.scale=[1,1],n&&n.brush(u);var f=e("./graphic/Image"),l=new f({id:t,style:{x:0,y:0,image:o}});return a.position!=null&&(l.position=n.position=a.position),a.rotation!=null&&(l.rotation=n.rotation=a.rotation),a.scale!=null&&(l.scale=n.scale=a.scale),l},_createPathToImage:function(){var e=this;return function(n,r,i,s){return e._pathToImage(n,r,i,s,t.devicePixelRatio)}}},h}),r("zrender/zrender",["require","./core/util","./core/log","./core/guid","./core/env","./Handler","./Storage","./animation/Animation","./vml/graphic","./vml/Painter","./Painter"],function(e){function h(e){return function(){e._needsRefreshNextFrame&&e.refresh()}}var t=e("./core/util"),n=e("./core/log"),r=e("./core/guid"),i=e("./core/env"),s=e("./Handler"),o=e("./Storage"),u=e("./animation/Animation"),a=!i.canvasSupported;a&&e("./vml/graphic");var f=a?e("./vml/Painter"):e("./Painter"),l={},c={};c.version="2.0.8",c.init=function(e){var t=new p(r(),e);return l[t.id]=t,t},c.dispose=function(e){if(e)e.dispose();else{for(var t in l)l[t].dispose();l={}}return c},c.getInstance=function(e){return l[e]},c.delInstance=function(e){return delete l[e],c};var p=function(e,t){this.id=e,this.env=i,this.storage=new o,this.painter=new f(t,this.storage),this.handler=new s(t,this.storage,this.painter),this.animation=new u({stage:{update:h(this)}}),this.animation.start(),this._needsRefreshNextFrame=!1;var n=this,r=this.storage,a=r.delFromMap,l=r.addToMap;r.delFromMap=function(e){var t=r.get(e);n.stopAnimation(t),a.call(r,e),t.__zr=null},r.addToMap=function(e){e.__zr=n,l.call(r,e)}};return p.prototype={constructor:p,getId:function(){return this.id},addElement:function(e){this.storage.addRoot(e),this._needsRefreshNextFrame=!0},removeElement:function(e){this.storage.delRoot(e),this._needsRefreshNextFrame=!0},configLayer:function(e,t){this.painter.configLayer(e,t),this._needsRefreshNextFrame=!0},render:function(){return this.refresh()},refresh:function(){this.painter.refresh(),this._needsRefreshNextFrame=!1},refreshNextFrame:function(){this._needsRefreshNextFrame=!0},resize:function(){this.painter.resize()},animate:function(e,r,i){typeof e=="string"&&(e=this.storage.get(e));if(e){var s,o=!1;if(r){var u=r.split("."),a=e;o=u[0]==="shape";for(var f=0,l=u.length;f<l;f++){if(!a)continue;a=a[u[f]]}a&&(s=a)}else s=e;if(!s){n('Property "'+r+'" is not existed in element '+e.id);return}e.__animators==null&&(e.__animators=[]);var c=e.__animators,h=this.animation.animate(s,{loop:i}).during(function(){e.dirty(o)}).done(function(){c.splice(t.indexOf(c,h),1)});return c.push(h),h}n("Element not existed")},stopAnimation:function(e){if(e.__animators){var t=e.__animators,n=t.length;for(var r=0;r<n;r++)t[r].stop();t.length=0}},clearAnimation:function(){this.animation.clear()},getWidth:function(){return this.painter.getWidth()},getHeight:function(){return this.painter.getHeight()},toDataURL:function(e,t,n){return this.painter.toDataURL(e,t,n)},pathToImage:function(e,t,n){var i=r();return this.painter.pathToImage(i,e,t,n)},on:function(e,t,n){this.handler.on(e,t,n)},off:function(e,t){this.handler.off(e,t)},trigger:function(e,t){this.handler.trigger(e,t)},clear:function(){this.storage.delRoot(),this.painter.clear()},dispose:function(){this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,c.delInstance(this.id)}},c}),r("zrender",["zrender/zrender"],function(e){return e}),r("bkgraph/core/Graph",["require","zrender/core/util"],function(e){var t=e("zrender/core/util"),n=function(e){this._directed=e||!1,this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={}};n.prototype.isDirected=function(){return this._directed},n.prototype.addNode=function(e,t){if(this._nodesMap[e])return this._nodesMap[e];var r=new n.Node(e,t);return this.nodes.push(r),this._nodesMap[e]=r,r},n.prototype.getNodeById=function(e){return this._nodesMap[e]},n.prototype.addEdge=function(e,t,r){typeof e=="string"&&(e=this._nodesMap[e]),typeof t=="string"&&(t=this._nodesMap[t]);if(!e||!t)return;var i=e.id+"-"+t.id;if(this._edgesMap[i])return this._edgesMap[i];var s=new n.Edge(e,t,r);return this._directed&&(e.outEdges.push(s),t.inEdges.push(s)),e.edges.push(s),e!==t&&t.edges.push(s),this.edges.push(s),this._edgesMap[i]=s,s},n.prototype.removeEdge=function(e){var n=e.node1,r=e.node2,i=n.id+"-"+r.id;this._directed&&(n.outEdges.splice(t.indexOf(n.outEdges,e),1),r.inEdges.splice(t.indexOf(r.inEdges,e),1)),n.edges.splice(t.indexOf(n.edges,e),1),n!==r&&r.edges.splice(t.indexOf(r.edges,e),1),delete this._edgesMap[i],this.edges.splice(t.indexOf(this.edges,e),1)},n.prototype.getEdge=function(e,t){return typeof e!="string"&&(e=e.id),typeof t!="string"&&(t=t.id),this._directed?this._edgesMap[e+"-"+t]:this._edgesMap[e+"-"+t]||this._edgesMap[t+"-"+e]},n.prototype.removeNode=function(e){if(typeof e=="string"){e=this._nodesMap[e];if(!e)return}delete this._nodesMap[e.id],this.nodes.splice(t.indexOf(this.nodes,e),1);for(var n=0;n<this.edges.length;){var r=this.edges[n];r.node1===e||r.node2===e?this.removeEdge(r):n++}},n.prototype.filterNode=function(e,t){var n=this.nodes.length;for(var r=0;r<n;)e.call(t,this.nodes[r],r)?r++:(this.removeNode(this.nodes[r]),n--)},n.prototype.filterEdge=function(e,t){var n=this.edges.length;for(var r=0;r<n;)e.call(t,this.edges[r],r)?r++:(this.removeEdge(this.edges[r]),n--)},n.prototype.eachNode=function(e,t){var n=this.nodes.length;for(var r=0;r<n;r++)this.nodes[r]&&e.call(t,this.nodes[r],r)},n.prototype.eachEdge=function(e,t){var n=this.edges.length;for(var r=0;r<n;r++)this.edges[r]&&e.call(t,this.edges[r],r)},n.prototype.clear=function(){this.nodes.length=0,this.edges.length=0,this._nodesMap={},this._edgesMap={}},n.prototype.breadthFirstTraverse=function(e,t,n,r){typeof t=="string"&&(t=this._nodesMap[t]);if(!t)return;var i="edges";n==="out"?i="outEdges":n==="in"&&(i="inEdges");for(var s=0;s<this.nodes.length;s++)this.nodes[s].__visited=!1;if(e.call(r,t,null))return;var o=[t];while(o.length){var u=o.shift(),a=u[i];for(var s=0;s<a.length;s++){var f=a[s],l=f.node1===u?f.node2:f.node1;if(!l.__visited){if(e.call(l,l,u))return;o.push(l),l.__visited=!0}}}},n.prototype.clone=function(){var e=new n(this._directed);for(var t=0;t<this.nodes.length;t++)e.addNode(this.nodes[t].id,this.nodes[t].data);for(var t=0;t<this.edges.length;t++){var r=this.edges[t];e.addEdge(r.node1.id,r.node2.id,r.data)}return e};var r=function(e,t){this.id=e,this.data=t||null,this.inEdges=[],this.outEdges=[],this.edges=[]};r.prototype.degree=function(){return this.edges.length},r.prototype.inDegree=function(){return this.inEdges.length},r.prototype.outDegree=function(){return this.outEdges.length};var i=function(e,t,n){this.node1=e,this.node2=t,this.data=n||null};return n.Node=r,n.Edge=i,n.fromMatrix=function(e,t,r){if(!t||!t.length||t[0].length!==t.length||e.length!==t.length)return;var i=t.length,s=new n(r);for(var o=0;o<i;o++){var u=s.addNode(e[o].id,e[o]);u.data.value=0,r&&(u.data.outValue=u.data.inValue=0)}for(var o=0;o<i;o++)for(var a=0;a<i;a++){var f=t[o][a];r&&(s.nodes[o].data.outValue+=f,s.nodes[a].data.inValue+=f),s.nodes[o].data.value+=f,s.nodes[a].data.value+=f}for(var o=0;o<i;o++)for(var a=o;a<i;a++){var f=t[o][a];if(f===0)continue;var l=s.nodes[o],c=s.nodes[a],h=s.addEdge(l,c,{});h.data.weight=f;if(o!==a&&r&&t[a][o]){var p=s.addEdge(c,l,{});p.data.weight=t[a][o]}}return s},n}),r("bkgraph/component/Component",["require","zrender/mixin/Eventful","zrender/core/util"],function(e){var t=e("zrender/mixin/Eventful"),n=e("zrender/core/util"),r=function(){t.call(this),this.el=document.createElement("div")};return r.prototype.type="COMPONENT",r.prototype.initialize=function(e){},r.prototype.resize=function(e,t){},r.prototype.setData=function(e){},r.prototype.dispose=function(){},n.merge(r.prototype,t.prototype,!0),r}),r("bkgraph/entity/Entity",["require","zrender/mixin/Eventful","zrender/core/util","zrender/graphic/Group"],function(e){var t=e("zrender/mixin/Eventful"),n=e("zrender/core/util"),r=e("zrender/graphic/Group"),i=function(){this.el=new r,t.call(this),this.states={},this.defaultState="",this.statesTransition={},this._animations={},this._shapes={},this._currentState=this.defaultState};return i.prototype.hidden=!1,i.prototype.initialize=function(e){this.zr=e;if(this.defaultState){var t=this.states[this.defaultState];if(t)for(var r in this.states){var i=this.states[r];i!==t&&n.merge(i,t)}}},i.prototype.addElement=function(e,t){this._shapes[e]=t,this.el.addElement(t)},i.prototype.getElement=function(e){return this._shapes[e]},i.prototype.setState=function(e){if(this._currentState===e)return;var t=this.states[this._currentState];if(this._currentState){var r=this.statesTransition[this._currentState];if(!r||n.indexOf(r,e)<0)return}var i=this.states[e];if(!i)return;if(i.shapeStyle)for(var s in i.shapeStyle){var o=this._shapes[s];o&&(n.merge(o.style,i.shapeStyle[s],!0),o.dirty(!1))}this._setAllShapeState(i,"zlevel"),this._setAllShapeState(i,"z"),t&&(t.onleave&&t.onleave.call(this,t,i),this.trigger("state:leave",t,i)),i.onenter&&i.onenter.call(this,i,t),this.trigger("state:enter",i,t),this._currentState=e},i.prototype.getState=function(){return this._currentState},i.prototype._setAllShapeState=function(e,t){if(e[t]!=null)for(var n in this._shapes)this._shapes[n][t]=e[t]},i.prototype.addAnimation=function(e,t){this._animations[e]==null&&(this._animations[e]=[]),n.indexOf(this._animations[e],t)<0&&this._animations[e].push(t);var r=this;return t.done(function(){var i=r._animations[e];i.splice(n.indexOf(t),1)}),t},i.prototype.stopAnimation=function(e){var t=this._animations[e];if(t){for(var n=0;n<t.length;n++)t[n].stop();this._animations[e]=null}},i.prototype.haveAnimation=function(e){return this._animations[e]!=null},i.prototype.stopAnimationAll=function(){for(var e in this._animations)this.stopAnimation(e);this._animations={}},n.merge(i.prototype,t.prototype,!0),i}),r("zrender/graphic/shape/Circle",["require","../Path"],function(e){return e("../Path").extend({type:"circle",shape:{cx:0,cy:0,r:0},buildPath:function(e,t){e.moveTo(t.cx+t.r,t.cy),e.arc(t.cx,t.cy,t.r,0,Math.PI*2,!0);return}})}),r("bkgraph/shape/Crescent",["require","zrender/graphic/Path"],function(e){var t=e("zrender/graphic/Path");return Cresent=t.extend({type:"cresent",shape:{cx:0,cy:0,r:0,height:0},buildPath:function(e,t){var n=t.r,r=t.cx,i=t.cy,s=Math.PI/2,o=Math.acos((n-t.height)/n),u=s-o,a=s+o,f=r+Math.cos(u)*n,l=i+Math.sin(u)*n;e.moveTo(f,l),e.arc(r,i,n,u,a),e.closePath()}}),Cresent}),r("bkgraph/util/util",["require","zrender/core/util"],function(e){var t=e("zrender/core/util"),n={indexOf:function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},bind:function(e,t){return e.bind?e.bind(t):function(){e.apply(t,arguments)}},_mouseFn:{},_mouseHandle:function(e){var t=function(t){var n=t.target,r=t.relatedTarget;while(r&&r!=this)try{r=r.parentNode}catch(i){break}r!=this&&e.call(n,t)};return t},addEventListener:function(e,t,n,r){if(window.addEventListener){if(e.onmouseenter!==undefined){e.addEventListener(t,n,r);return}if(t=="mouseenter"||t=="mouseleave"){var i=t=="mouseenter"?"mouseover":"mouseout",s=this._mouseHandle(n);e.addEventListener(i,s,r),this._mouseFn[e]||(this._mouseFn[e]={}),this._mouseFn[e][i]||(this._mouseFn[e][i]={}),this._mouseFn[e][i][n]=s}else e.addEventListener(t,n,r)}else e.attachEvent("on"+t,n)},removeEventListener:function(e,t,n,r){if(window.removeEventListener){if(e.onmouseenter!==undefined){e.removeEventListener(t,n,r);return}if(t=="mouseenter"||t=="mouseleave"){var i=t=="mouseenter"?"mouseover":"mouseout";if(!events._mouseFn[e][i][n])return;e.removeEventListener(i,events._mouseFn[e][i][n],r),events._mouseFn[e][i][n]=null}else e.removeEventListener(t,n,r)}else e.detachEvent("on"+t,n)},getStyle:function(e,t){var n;return window.getComputedStyle?n=window.getComputedStyle(e,null):document.documentElement.currentStyle&&(n=e.currentStyle),t?n[t]:n},addClass:function(e,t){e.classList?e.classList.add(t):e.className.indexOf(t)<0&&(e.className+=" "+t)},removeClass:function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(t,"")},hasClass:function(e,t){return e.classList?e.classList.contains(t):e.className.indexOf(t)>=0},debounce:function(e,t){var n;return function(){var r=this,i=arguments,s=navigator.userAgent.toLowerCase(),o=/msie [\d.]+;/gi;if(s.indexOf("msie")>0&&(s.match(o)+"").replace(/[^0-9.]/ig,"")<=8)e.apply(r,i);else{var u=function(){n=null,e.apply(r,i)};clearTimeout(n),n=setTimeout(u,t)}}},truncate:function(e,t,n){return e.length>t?(n=n==null?"…":n,e.substring(0,t-n.length)+n):e},trim:function(e){return e.replace(/^\s+|\s+$/g,"")},getURLSearch:function(){var e=window.location.search,t={};if(e){e=e.slice(n.indexOf(e,"?")+1);var r=e.split("&");for(var i=0;i<r.length;i++){var s=r[i].split("="),o=decodeURIComponent(s[0]),u=decodeURIComponent(s[1]);t[o]=u}}return t}};return n}),r("bkgraph/config",{levels:[{position:0,title:"僵尸粉",content:"我真的只是路过而已，不要叫我僵尸粉啦，不过这张图还是蛮有意思的，你们也赶紧来看看啊~~~ —— 百度知识图谱"},{position:8,title:"初级粉",content:"在家宅的飞起！！！其实我看看电视电影就满足了，但是还是蛮想了解更多的，可惜出去看演唱会什么的好麻烦的！！！但是看看这张图我就什么都懂啦！！！ —— 百度知识图谱"},{position:20,title:"中级粉",content:"整天宅在家里多不好，还是要出去看看偶像的演唱会的 ，不能当终极粉我还能当个中级粉嘛！！！你想陪我一起去么，可以先看看这张图哟！！！ —— 百度知识图谱"},{position:40,title:"高级粉",content:"高级粉成就get！！！国内演唱会，我一场不漏，你们能做到么！！！先保证这张图的所有关系你都了解再来跟我PK吧！！！ —— 百度知识图谱"},{position:60,title:"顶级粉",content:"那句歌词怎么唱的，“不管世界变得怎么样，只要有你就会是天堂”，对的，有TA的地方，就会有我，想要追随我的脚步？先看看这张图吧！！！ —— 百度知识图谱"},{position:90,title:"私生粉",content:"哈哈哈！！！终于这个世界上没有人对TA的热爱程度能超过我了！！！我就是传说中的私生饭！！！想超越我？看看下面的图再说吧~~~233333 —— 百度知识图谱"},{position:100,title:"",content:"我现在对TA已经了如指掌了，你要不要也来看看TA的圈子有哪些人呢？—— 百度知识图谱",interval:0}],share:["贵圈果然很乱！我在看{name}的图谱，竟然真相了！—— 百度知识图谱","读书少怕被骗？来{name}的图谱一探究竟，一秒变元芳！—— 百度知识图谱","想要逼格甩出别人一个殖民地吗？恐怕答案就在{name}的图谱中了 —— 百度知识图谱","还在纠结{name}复杂的人物关系么？我在看TA的图谱哟，快来跟我一起扒一扒吧~ —— 百度知识图谱"],nodeStates:{normal:{shapeStyle:{label:{fill:"#000",textFill:"#fff"},outline:{lineWidth:1,stroke:"#e4e9f2"}}},hover:{shapeStyle:{label:{fill:"#ff860d"},outline:{lineWidth:2,stroke:"#ff860d"}}},active:{shapeStyle:{label:{fill:"#ff860d"},outline:{lineWidth:2,stroke:"#ff860d"}}}},mainNodeStates:{normal:{shapeStyle:{label:{fill:"#3385ff",textFill:"#fff"},outline:{lineWidth:2,stroke:"#3385ff"}},labelAlpha:.9},hover:{shapeStyle:{label:{fill:"#ff860d"},outline:{stroke:"#ff860d"}}},active:{shapeStyle:{label:{fill:"#ff860d"},outline:{stroke:"#ff860d"}}}},edgeStates:{normal:{shapeStyle:{labelLine:{fill:"#3385ff",stroke:"#3385ff",textFill:"#3385ff",opacity:.3,lineWidth:1}}},hover:{shapeStyle:{labelLine:{fill:"#ff860d",stroke:"#ff860d",textFill:"#ff860d",opacity:1,lineWidth:1}}},active:{shapeStyle:{labelLine:{fill:"#ff860d",stroke:"#ff860d",textFill:"#ff860d",opacity:1,lineWidth:1}}}},extraEdgeStates:{normal:{shapeStyle:{labelLine:{fill:"#3385ff",stroke:"#3385ff",textFill:"#3385ff",opacity:.3,lineWidth:.4}}},hover:{shapeStyle:{labelLine:{fill:"#ff860d",stroke:"#ff860d",textFill:"#ff860d",opacity:1,lineWidth:.4}}},active:{shapeStyle:{labelLine:{fill:"#ff860d",stroke:"#ff860d",textFill:"#ff860d",opacity:1,lineWidth:.4}}}},tip:{edge:"大家都很关注这里哟，点击一探究竟吧~",edgeOther:"大家也很关注这里哟，点击一探究竟吧~",node:"点击头像，查看TA的详细资料吧~",nodeEnd:"显示已经到头了哦~"},enableAnimation:!!document.createElement("canvas").getContext,voteAPI:"http://api.open.baidu.com/pae/component/api/vote",voteProjectHuoying:"ks_huoying",layout:{layerDistance:[0,200,300,300,300,300,300],layerConstraint:[100,1,.3,.3,.2,.2,.1]},defaultNodeImage:"img/default-avatar.png",isPlat:!1}),r("bkgraph/entity/Node",["require","./Entity","zrender/graphic/Group","zrender/graphic/Image","zrender/graphic/shape/Circle","../shape/Crescent","zrender/core/util","zrender/core/vector","zrender/tool/color","../util/util","../config"],function(e){var t=e("./Entity"),n=e("zrender/graphic/Group"),r=e("zrender/graphic/Image"),i=e("zrender/graphic/shape/Circle"),s=e("../shape/Crescent"),o=e("zrender/core/util"),u=e("zrender/core/vector"),a=e("zrender/tool/color"),f=e("../util/util"),l=e("../config"),c=50,h=new Image;h.src=l.defaultNodeImage;var p=function(e){t.call(this),e=e||{},this.radius=e.radius||20,this.originalRadius=e.originalRadius||e.radius||20,this.label=e.label||"",this.image=e.image||"",this.draggable=e.draggable||!1,this.states={normal:{name:"normal",z:1,labelAlpha:.6,zlevel:0},hover:{name:"hover",zlevel:2,onenter:function(){this.animateRadius(this.originalRadius*1.2,500),this.startActiveAnimation()},onleave:function(e,t){t.name!=="active"&&(this.animateRadius(this.originalRadius,500),this.stopActiveAnimation())},labelAlpha:.9},active:{name:"active",zlevel:2,onenter:function(e,t){t.name!=="hover"&&(this.animateRadius(this.originalRadius*1.2,500),this.startActiveAnimation())},onleave:function(e,t){this.animateRadius(this.originalRadius,500),this.stopActiveAnimation()},labelAlpha:.9}},o.merge(this.states,e.states||{},!0),this.defaultState=e.defaultState!=null?e.defaultState:"normal",this.statesTransition={normal:["hover","active"],hover:["normal","active"],active:["normal"]},this._animatingCircles=[]},d=["mouseover","mouseout","click","dragstart","dragend","dragenter","dragover"];p.prototype.initialize=function(e){function f(e){return function(){n.trigger(e)}}t.prototype.initialize.call(this,e);var n=this,o=this.radius,u=new i({shape:{r:c,cx:0,cy:0},style:{stroke:"black",fill:"rgba(0, 0, 0, 0)"},z:10,draggable:this.draggable,drift:function(e,t){n.el.position[0]+=e,n.el.position[1]+=t}});for(var l=0;l<d.length;l++)u["on"+d[l]]=f(d[l]);var p=new r({style:{image:h,x:-c,y:-c,width:c*2,height:c*2},z:10,hoverable:!1});if(this.label)var v=new s({shape:{cx:0,cy:0,height:25,r:c},style:{text:this.label,textPosition:"inside",textAlign:"center",textFont:"15px 微软雅黑"},z:10,hoverable:!1});this.addElement("image",p),v&&this.addElement("label",v),this.addElement("outline",u),this.el.scale[0]=this.el.scale[1]=this.radius/c,this.on("state:enter",function(e){v&&(v.style.fill=a.alpha(e.shapeStyle.label.fill,e.labelAlpha))}),this.defaultState&&this.setState(this.defaultState)},p.prototype.loadImage=function(e,t){if(this._imageLoaded)return;this._imageLoaded=!0;var n=this,r=new Image;r.onload=function(){var t=n.getElement("image");t.style.image=r,t.dirty(),e&&e()},r.onerror=function(){t&&t()},r.src=this.image},p.prototype.setDraggable=function(e){this.draggable=e,this.getElement("outline").draggable=e},p.prototype.setRadius=function(e){this.radius=e,this.el.scale[0]=this.el.scale[1]=e/c,this.el.dirty()},p.prototype.animateRadius=function(e,t,n){var r=this.zr;this.stopAnimation("radius");var i=this;this.addAnimation("radius",r.animation.animate(this).when(t||1e3,{radius:e}).during(function(){i.setRadius(i.radius)}).done(function(){n&&n()})).start("ElasticOut")},p.prototype.startActiveAnimation=function(){if(this._animatingCircles.length)return;var e=Math.random()*Math.PI*2;for(var t=0;t<3;t++){var n=t/3*Math.PI*2+e,r=Math.cos(n)*8,s=Math.sin(n)*8,o=Math.cos(n+Math.PI)*8,u=Math.sin(n+Math.PI)*8,a=new i({shape:{cx:0,cy:0,r:c+5},style:{fill:this.states.hover.shapeStyle.outline.stroke,opacity:.5},hoverable:!1,z:-1,zlevel:2});this.el.addElement(a),this.addAnimation("glowcircle",a.animate("shape",!0)).when(1e3,{cx:o,cy:u}).when(3e3,{cx:r,cy:s}).when(4e3,{cx:0,cy:0}).delay(-500*t).start(),this._animatingCircles.push(a)}},p.prototype.stopActiveAnimation=function(){var e=this.zr,t=this._animatingCircles;if(t.length){for(var n=0;n<t.length;n++){var r=t[n];this.el.removeElement(r)}t.length=0,this.stopAnimation("glowcircle")}};var v=[0,0],m=[0,0];return p.prototype.isInsideRect=function(e){var t=this.radius,n=this.el.position;return v[0]=n[0]-t,v[1]=n[1]-t,m[0]=n[0]+t,m[1]=n[1]+t,!(v[0]>e.x+e.width||v[1]>e.y+e.height||m[0]<e.x||m[1]<e.y)},o.inherits(p,t),p}),r("bkgraph/shape/LabelCurve",["require","zrender/graphic/Path","zrender/core/curve"],function(e){var t=e("zrender/graphic/Path"),n=e("zrender/core/curve"),r=t.extend({type:"labelcurve",shape:{x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},style:{fill:null,stroke:"black"},buildPath:function(e,t){var r=t.x1,i=t.y1,s=t.x2,o=t.y2,u=t.x3,a=t.y3,f=t.cx,l=t.cy,c=t.r||8;e.moveTo(r,i),e.quadraticCurveTo(s,o,u,a),f==null&&(f=n.quadraticAt(r,s,u,.5),l=n.quadraticAt(i,o,a,.5)),e.moveTo(f+c,l),e.arc(f,l,c,0,Math.PI*2)}});return r}),r("bkgraph/util/intersect",["require","zrender/core/vector","zrender/core/curve"],function(e){function u(e,t,n,r,i){var s=(i-t)/(r-t);return s>1||s<0?-Infinity:s*(n-e)+e}function a(e,t,n,r,i){var s=(i-e)/(n-e);return s>1||s<0?-Infinity:s*(r-t)+t}function l(e,t,r,i,s,o,u){var a=n.quadraticRootAt(t,i,o,u,f);return a===0?-Infinity:n.quadraticAt(e,r,s,f[0])}function c(e,t,r,i,s,o,u){var a=n.quadraticRootAt(e,r,s,u,f);return a===0?-Infinity:n.quadraticAt(t,i,o,f[0])}var t=e("zrender/core/vector"),n=e("zrender/core/curve"),r=1e-4,i=t.create(),s=t.create(),o=t.create(),f=[],h=function(e,t,n){var r=e.xStart,i=e.yStart,s=e.xEnd,o=e.yEnd,f=u(r,i,s,o,t.y),n=[];f>=t.x&&f<=t.x+t.width&&n.push({point:[f,t.y],side:"top"});var l=a(r,i,s,o,t.x);l>=t.y&&l<=t.y+t.height&&n.push({point:[t.x,l],side:"left"});var f=u(r,i,s,o,t.y+t.height);f>=t.x&&f<=t.x+t.width&&n.push({point:[f,t.y+t.height],side:"bottom"});var l=a(r,i,s,o,t.x+t.width);return l>=t.y&&l<=t.y+t.height&&n.push({point:[t.x+t.width,l],side:"right"}),n},p=function(e,t){var n=e.x1,r=e.y1,i=e.x2,s=e.y2,o=e.x3,u=e.y3,a=l(n,r,i,s,o,u,t.y),f=[];a>=t.x&&a<=t.x+t.width&&f.push({point:[a,t.y],side:"top"});var h=c(n,r,i,s,o,u,t.x);h>=t.y&&h<=t.y+t.height&&f.push({point:[t.x,h],side:"left"});var a=l(n,r,i,s,o,u,t.y+t.height);a>=t.x&&a<=t.x+t.width&&f.push({point:[a,t.y+t.height],side:"bottom"});var h=c(n,r,i,s,o,u,t.x+t.width);return h>=t.y&&h<=t.y+t.height&&f.push({point:[t.x+t.width,h],side:"right"}),f},d=function(e,r,s){var o=e.x1,u=e.y1,a=e.x2,f=e.y2,l=e.x3,c=e.y3,h=.1,p=Infinity,d,v=0,m=1;for(var g=0;g<3;g++){for(var y=v;y<m;y+=h){i[0]=n.quadraticAt(o,a,l,y),i[1]=n.quadraticAt(u,f,c,y);var b=Math.abs(t.dist(r,i)-s);if(b<1)break;b<p&&(p=b,d=y)}v=Math.max(d-h,0),m=Math.min(d+h,1),h/=10}return[n.quadraticAt(o,a,l,d),n.quadraticAt(u,f,c,d)]};return{lineRect:h,curveRect:p,curveCircle:d}}),r("bkgraph/entity/CurveEdge",["require","./Entity","zrender/graphic/Group","zrender/core/util","zrender/core/curve","../shape/LabelCurve","zrender/graphic/shape/Circle","../util/util","../util/intersect","../config","zrender/core/vector"],function(e){function E(e,t,n){return e*(1-n)+t*n}var t=e("./Entity"),n=e("zrender/graphic/Group"),r=e("zrender/core/util"),i=e("zrender/core/curve"),s=e("../shape/LabelCurve"),o=e("zrender/graphic/shape/Circle"),u=e("../util/util"),a=e("../util/intersect"),f=e("../config"),l=e("zrender/core/vector"),c=l.create,h=l.set,p=l.min,d=l.max,v=c(),m=c(),g=c(),y=c(),b=c(),w=8,S=function(e){t.call(this),e=e||{},this.sourceEntity=e.sourceEntity||null,this.targetEntity=e.targetEntity||null,this.label=e.label||"",this.layerCounter=e.layerCounter||1,this.isExtra=e.isExtra,this.states={normal:{name:"normal",zlevel:0,z:0},hover:{name:"hover",zlevel:2,onenter:function(e,t){this.animateTextPadding(12,300),this.startActiveAnimation()},onleave:function(e,t){t.name!=="active"&&(this.animateTextPadding(5,300),this.stopActiveAnimation())}},active:{name:"active",zlevel:2,onenter:function(e,t){t.name!=="hover"&&(this.animateTextPadding(12,300),this.startActiveAnimation())},onleave:function(e,t){this.animateTextPadding(5,300),this.stopActiveAnimation()}}},r.merge(this.states,e.states||{}),this.defaultState=e.defaultState==null?"normal":e.defaultState,this.statesTransition={normal:["hover","active"],hover:["normal","active"],active:["normal"]},this._animatingCircles=[]};return S.prototype.initialize=function(e){t.prototype.initialize.call(this,e);var n=this,r=new s({shape:{r:8},style:{text:u.truncate(this.label,10),textFont:"13px 微软雅黑",textPadding:5,dropletPadding:0},clickable:!0,onclick:function(){n.trigger("click")},onmouseover:function(){n.trigger("mouseover")},onmouseout:function(){n.trigger("mouseout")}});this.addElement("labelLine",r),this.update(),this.defaultState&&this.setState(this.defaultState)},S.prototype.update=function(){this.sourceEntity&&this.targetEntity&&this._computeCurvePoints(this.sourceEntity.el.position,this.targetEntity.el.position,1,!0),this.el.dirty()},S.prototype.animateLength=function(e,t,n,r,i){var s=this.getElement("labelLine"),o=s.shape,u,a,f,l,c=o.x2,h=o.y2,p=r===this.sourceEntity;if(p)var u=o.x1,f=o.x3,a=o.y1,l=o.y3;else var u=o.x3,f=o.x1,a=o.y3,l=o.y1;var d=this,v={t:0};this.addAnimation("length",e.animation.animate(v).when(t||1e3,{t:1}).during(function(e,t){var n=E(u,c,t),r=E(c,f,t),i=E(n,r,t),d=E(a,h,t),v=E(h,l,t),m=E(d,v,t);o.x2=n,o.y2=d,p?(o.x3=i,o.y3=m):(o.x1=i,o.y1=m),s.dirty()}).delay(n).done(function(){i&&i()}).start())},S.prototype.animateTextPadding=function(e,t,n){var r=this;this.stopAnimation("textPadding"),this.addAnimation("textPadding",this.getElement("labelLine").animate("style")).when(t,{textPadding:e}).done(n).start("ElasticOut")},S.prototype.startActiveAnimation=function(){if(this._animatingCircles.length)return;var e=this.getElement("labelLine"),t=this.states.hover.shapeStyle.labelLine;for(var n=3;n>0;n--){var r=new o({shape:{cx:e.shape.cx,cy:e.shape.cy,r:w},style:{fill:t.stroke,opacity:t.opacity*.8},hoverable:!1,z:-1,zlevel:2});this.el.addElement(r),this.addAnimation("ripplecircle",r.animate("shape",!0).when(3e3,{r:w+12}).delay(-1e3*n).start("Linear")),this.addAnimation("ripplecircle",r.animate("style",!0).when(3e3,{opacity:0}).delay(-1e3*n).start("Linear")),this._animatingCircles.push(r)}},S.prototype.stopActiveAnimation=function(){var e=this._animatingCircles;if(e.length){for(var t=0;t<e.length;t++){var n=e[t];this.el.removeElement(n)}e.length=0,this.stopAnimation("ripplecircle")}},S.prototype._computeCurvePoints=function(e,t){var n=this.sourceEntity,r=this.targetEntity,s=this.getElement("labelLine");this._setCurvePoints(s,e,t),e=a.curveCircle(s.shape,e,n.originalRadius),t=a.curveCircle(s.shape,t,r.originalRadius),this._setCurvePoints(s,e,t);var o=s.shape;o.cx=i.quadraticAt(o.x1,o.x2,o.x3,.5),o.cy=i.quadraticAt(o.y1,o.y2,o.y3,.5)},S.prototype._setCurvePoints=function(e,t,n){var r=e.shape;r.x1=t[0],r.y1=t[1],r.x3=n[0],r.y3=n[1];var i=1;this.isExtra&&(i=1.3),i*=this.layerCounter%2==0?1:-1,r.x2=(t[0]+n[0])/2-i*(t[1]-n[1])/4,r.y2=(t[1]+n[1])/2-i*(n[0]-t[0])/4},S.prototype.intersectRect=function(e){return a.curveRect(this.getElement("labelLine").style,e)},S.prototype.isInsideRect=function(e){var t=this.getElement("labelLine").shape;return h(m,t.x2,t.y2),h(g,t.x3,t.y3),h(y,t.x1,t.y1),h(b,t.x1,t.y1),p(y,y,m),p(y,y,g),d(b,b,m),d(b,b,g),!(b[0]<e.x||b[1]<e.y||y[0]>e.x+e.width||y[1]>e.y+e.height)},r.inherits(S,t),S}),r("zrender/graphic/shape/Rectangle",["require","../helper/roundRect","../Path"],function(e){var t=e("../helper/roundRect");return e("../Path").extend({type:"rectangle",shape:{r:0,x:0,y:0,width:0,height:0},buildPath:function(e,n){var r=n.x,i=n.y,s=n.width,o=n.height;n.r?t.buildPath(e,n):(e.moveTo(r,i),e.lineTo(r+s,i),e.lineTo(r+s,i+o),e.lineTo(r,i+o),e.lineTo(r,i)),e.closePath();return}})}),r("bkgraph/entity/OutTip",["require","./Entity","zrender/core/util","zrender/graphic/shape/Rectangle"],function(e){var t=e("./Entity"),n=e("zrender/core/util"),r=e("zrender/graphic/shape/Rectangle"),i=function(e){t.call(this),this.label=e.label||"",this.color=e.color||"#85b6ff",this.el=new r({shape:{x:-25,y:0,width:55,height:25,radius:5},style:{textPosition:"inside",textColor:"white",textFont:"12px 微软雅黑",opacity:.9},hoverable:!1,zlevel:2,z:100})};return i.prototype.initialize=function(e){this.el.style.fill=this.color,this.el.style.text=this.label},n.inherits(i,t),i}),r("bkgraph/shape/CurveBundle",["require","zrender/graphic/Path"],function(e){var t=e("zrender/graphic/Path"),n=t.extend({type:"curvebundle",style:{fill:null,stroke:"black"},buildPath:function(e,t){for(var n=0;n<t.segments.length;n++){var r=t.segments[n];e.moveTo(r[0],r[1]),e.quadraticCurveTo(r[2],r[3],r[4],r[5])}}});return n}),r("bkgraph/entity/ExtraEdgeBundle",["require","./Entity","zrender/core/curve","zrender/core/util","../shape/CurveBundle","../config","../util/intersect","zrender/core/vector"],function(e){var t=e("./Entity"),n=e("zrender/core/curve"),r=e("zrender/core/util"),i=e("../shape/CurveBundle"),s=e("../config"),o=e("../util/intersect"),u=e("zrender/core/vector"),a=function(e){e=e||{},t.call(this),this.el=new i({shape:{segments:[]},hoverable:!1}),this.edges=[]};return a.prototype.initialize=function(e){var t=s.extraEdgeStates.normal.shapeStyle.labelLine,n=this.el.style;n.stroke=t.stroke,n.opacity=t.opacity,n.lineWidth=t.lineWidth,this.update(e)},a.prototype.update=function(e){var t=0;for(var n=0;n<this.edges.length;n++){var r=this.edges[n],i=r.node1.entity,s=r.node2.entity,o=Math.max(r.node1.data.layerCounter,r.node2.data.layerCounter),u=this.el.shape.segments,a=u[n];a||(a=u[n]=[]),i&&s&&(this._calCurvePoints(i,s,o,a),t++)}this.el.shape.segments.length=t,this.el.dirty()},a.prototype.addEdge=function(e){var t=e.node1.entity,n=e.node2.entity,r=Math.max(e.node1.data.layerCounter,e.node2.data.layerCounter),i=[];t&&n&&(this._calCurvePoints(t,n,r,i),this.edges.push(e),this.el.shape.segments.push(i),this.el.dirty())},a.prototype.removeEdge=function(e){var t=this.edges.indexOf(e);t>0&&(this.edges.splice(t,1),this.el.shape.segments.splice(t,1))},a.prototype._calCurvePoints=function(e,t,n,r){var i=1.3,s=this.el,u=e.el.position,a=t.el.position,f={x1:u[0],y1:u[1],x3:a[0],y3:a[1]};i*=n%2==0?1:-1,f.x2=(u[0]+a[0])/2-i*(u[1]-a[1])/4,f.y2=(u[1]+a[1])/2-i*(a[0]-u[0])/4,u=o.curveCircle(f,u,e.originalRadius),a=o.curveCircle(f,a,t.originalRadius),r[0]=u[0],r[1]=u[1],r[2]=(u[0]+a[0])/2-i*(u[1]-a[1])/4,r[3]=(u[1]+a[1])/2-i*(a[0]-u[0])/4,r[4]=a[0],r[5]=a[1]},r.inherits(a,t),a}),r("bkgraph/util/cookies",["require"],function(e){var t=function(e,n,r){return arguments.length===1?t.get(e):t.set(e,n,r)};return t._document=document,t._navigator=navigator,t.defaults={path:"/"},t.get=function(e){return t._cachedDocumentCookie!==t._document.cookie&&t._renewCache(),t._cache[e]},t.set=function(e,n,r){return r=t._getExtendedOptions(r),r.expires=t._getExpiresDate(n===undefined?-1:r.expires),t._document.cookie=t._generateCookieString(e,n,r),t},t.expire=function(e,n){return t.set(e,undefined,n)},t._getExtendedOptions=function(e){return{path:e&&e.path||t.defaults.path,domain:e&&e.domain||t.defaults.domain,expires:e&&e.expires||t.defaults.expires,secure:e&&e.secure!==undefined?e.secure:t.defaults.secure}},t._isValidDate=function(e){return Object.prototype.toString.call(e)==="[object Date]"&&!isNaN(e.getTime())},t._getExpiresDate=function(e,n){n=n||new Date;switch(typeof e){case"number":e=new Date(n.getTime()+e*1e3);break;case"string":e=new Date(e)}if(e&&!t._isValidDate(e))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return e},t._generateCookieString=function(e,t,n){e=e.replace(/[^#$&+\^`|]/g,encodeURIComponent),e=e.replace(/\(/g,"%28").replace(/\)/g,"%29"),t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent),n=n||{};var r=e+"="+t;return r+=n.path?";path="+n.path:"",r+=n.domain?";domain="+n.domain:"",r+=n.expires?";expires="+n.expires.toUTCString():"",r+=n.secure?";secure":"",r},t._getCookieObjectFromString=function(e){var n={},r=e?e.split("; "):[];for(var i=0;i<r.length;i++){var s=t._getKeyValuePairFromCookieString(r[i]);n[s.key]===undefined&&(n[s.key]=s.value)}return n},t._getKeyValuePairFromCookieString=function(e){var t=e.indexOf("=");return t=t<0?e.length:t,{key:decodeURIComponent(e.substr(0,t)),value:decodeURIComponent(e.substr(t+1))}},t._renewCache=function(){t._cache=t._getCookieObjectFromString(t._document.cookie),t._cachedDocumentCookie=t._document.cookie},t._areEnabled=function(){var e="cookies.js",n=t.set(e,1).get(e)==="1";return t.expire(e),n},t.enabled=t._areEnabled(),t}),r("bkgraph/util/log",["require","./cookies","../config","zrender/core/util"],function(e){var t=e("./cookies"),n=e("../config"),r=e("zrender/core/util");return function(e){if(n.isPlat)return;var t="http://nsclick.baidu.com/v.gif?pid=201&pj=www",i=(new Date).getTime(),s={path:document.location.href,referrer:document.referrer};e.extend=(e.extend||"")+".t_"+(new Date).getTime(),e=r.merge(e,s);for(var o in e)e.hasOwnProperty(o)&&(t+="&"+o+"="+encodeURIComponent(e[o]));var u=window["BD_PS_C"+i]=new Image;u.src=t}}),r("bkgraph/util/jsonp",["require"],function(e){return function(e,t,n,r){e=e||"",t=t||{},n=n||"",r=r||function(){};var i=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};if(typeof t=="object"){var s="",o=i(t);for(var u=0;u<o.length;u++)s+=encodeURIComponent(o[u])+"="+encodeURIComponent(t[o[u]]),u!=o.length-1&&(s+="&");e.indexOf("?")===-1?e+="?":e+="&",e+=s}else typeof t=="function"&&(n=t,r=n);typeof n=="function"&&(r=n,n="callback"),Date.now||(Date.now=function(){return(new Date).getTime()});var a=Date.now(),f="jsonp"+Math.round(a+Math.random()*1000001);window[f]=function(e){r(e),window[f]=undefined;try{delete window[f]}catch(t){}},e.indexOf("?")===-1?e+="?":e+="&";var l=document.createElement("script");l.setAttribute("src",e+n+"="+f),document.getElementsByTagName("head")[0].appendChild(l)}}),r("bkgraph/component/GraphMain",["require","zrender","../core/Graph","./Component","zrender/core/util","zrender/core/vector","zrender/graphic/Group","../entity/Node","../entity/CurveEdge","../entity/OutTip","../entity/ExtraEdgeBundle","../util/log","../util/util","../util/intersect","../util/jsonp","../util/cookies","../config"],function(e){function w(e){return e>y||e<-y}function S(e,t,n){var r=s.create(),i=Math.random()*Math.PI*2;return r[0]=Math.cos(i)*n+e,r[1]=Math.sin(i)*n+t,r}var t=e("zrender"),n=e("../core/Graph"),r=e("./Component"),i=e("zrender/core/util"),s=e("zrender/core/vector"),o=e("zrender/graphic/Group"),u=e("../entity/Node"),a=e("../entity/CurveEdge"),f=e("../entity/OutTip"),l=e("../entity/ExtraEdgeBundle"),c=e("../util/log"),h=e("../util/util"),p=e("../util/intersect"),d=e("../util/jsonp"),v=e("../util/cookies"),m=e("../config"),g=Array.prototype.slice,y=.01,b=function(e){return e>-y&&e<y},E=function(){r.call(this),this.minRadius=30,this.maxRadius=40,this.draggable=!1,this.enableEntryAnimation=!0,this._kgraph=null,this._zr=null,this._graph=null,this._layouting=!1,this._animating=!1,this._root=null,this._graphRoot=null,this._mainNode=null,this._lastHoverNode=null,this._lastHoverEdge=null,this._currentActiveNode=null,this._nodeEntityCount=0,this._baseEntityCount=0,this._defaultLayerCount=1,this._parallax=null,this._isFirstFrame=!0};return E.prototype.type="GRAPH",E.prototype.initialize=function(e){this._kgraph=e;var t=this.el;this.el.className="bkg-graph",t.style.width=e.getWidth()+"px",t.style.height=e.getHeight()+"px",this._initZR();var n=this;h.addEventListener(t,"mousedown",function(){n._mouseDown=!0,n.hideTip()}),h.addEventListener(t,"mouseup",function(){n._mouseDown=!1})},E.prototype.enableDrag=function(){this.draggable=!0,this._graph.eachNode(function(e){e.entity&&e.entity.setDraggable(!0)})},E.prototype.disableDrag=function(){this.draggable=!1,this._graph.eachNode(function(e){e.entity&&e.entity.setDraggable(!1)})},E.prototype.refresh=function(){this._zr.refreshNextFrame()},E.prototype.getGraph=function(){return this._graph},E.prototype.getGraphRoot=function(){return this._graphRoot},E.prototype.getZR=function(){return this._zr},E.prototype.getMainNode=function(){return this._graph.getNodeById(this._mainNode.id)},E.prototype._initZR=function(){$zrContainer=document.createElement("div"),$zrContainer.className="bkg-graph-zr",this.el.appendChild($zrContainer),this._zr=t.init($zrContainer);var e=this._zr.painter.refresh,n=this,r=this._zr;this._min=[Infinity,Infinity],this._max=[r.getWidth()/2,r.getHeight()/2];var i=0,s=0,o=0,u=0;r.painter.refresh=function(){n._culling(),e.apply(this,arguments)}},E.prototype.resize=function(e,t){this.el.style.width=e+"px",this.el.style.height=t+"px",this._zr.resize(),this._syncOutTipEntities()},E.prototype.setData=function(e){var t=new n(!0);this._graph=t;var r=this._zr,i=this._kgraph.getWidth()/2,s=this._kgraph.getHeight()/2,o=r.getWidth(),u=r.getHeight(),a=-Infinity,f=Infinity;for(var l=0;l<e.entities.length;l++){var p=e.entities[l];f=Math.min(f,p.hotValue),a=Math.max(a,p.hotValue)}var d=a-f,v=!1;for(var l=0;l<e.entities.length;l++){var p=e.entities[l],m=t.addNode(p.id,p),g=d>0?(p.hotValue-f)*(this.maxRadius-this.minRadius)/d+this.minRadius:(this.maxRadius+this.minRadius)/2;p.layerCounter===0&&(g=70,this._mainNode=m),m.layout={position:p.position,size:g}}for(var l=0;l<e.relations.length;l++){var y=e.relations[l],b=t.addEdge(y.fromID,y.toID,y);b.isExtra=y.isExtra}var w=o/2-this._mainNode.layout.position[0],E=u/2-this._mainNode.layout.position[1];this._graph.eachNode(function(e){e.layout.position[0]+=w,e.layout.position[1]+=E}),this.render(),this._loadStorage();var S=[];this._graph.eachNode(function(e){e.entity&&S.push(e.id,e.data.layerCounter)});var x=200,T=Math.ceil(S.length/x),N=[],C=h.getURLSearch();for(var k=0;k<T;k++){N=[];var L=(k+1)*x>S.length?S.length:(k+1)*x;for(var A=k*x;A<L;A++)N.push(S[A]);c({type:"zhishitupuse",target:N.join(","),page:T+"-"+(k+1),extend:C.srcid?C.srcid:""})}},E.prototype.render=function(){var e=this._zr,t=this._graph;this._root&&e.removeElement(this._root),this._root=new o,this._graphRoot=new o,this._root.addElement(this._graphRoot),e.addElement(this._root),m.enableAnimation&&(this._extraEdgeBundle=new l,this._extraEdgeBundle.initialize(e),this._graphRoot.addElement(this._extraEdgeBundle.el)),t.eachEdge(function(e){e.node1.data.layerCounter<=this._defaultLayerCount&&e.node2.data.layerCounter<=this._defaultLayerCount&&(e.isExtra||(e.node1.entity||(this._baseEntityCount++,this._createNodeEntity(e.node1)),e.node2.entity||(this._baseEntityCount++,this._createNodeEntity(e.node2))),this._createEdgeEntity(e))},this)},E.prototype.unactiveAll=function(){var e=this._zr,t=this._graph;for(var n=0;n<t.nodes.length;n++){var r=t.nodes[n];r.entity&&r.entity.setState("normal"),r._outTipEntity&&(this._root.removeChild(r._outTipEntity.el),r._outTipEntity=null)}for(var n=0;n<t.edges.length;n++){var i=t.edges[n];i.entity&&(i.entity.setState("normal"),i.isExtra&&(i.entity.hidden=!0))}this._currentActiveNode=null},E.prototype.unhoverNode=function(){var e=this._lastHoverNode;e&&e.entity&&(e.entity.getState()!=="active"&&e.entity.setState("normal"),this._lastHoverNode=null)},E.prototype.hoverNode=function(e){this.unhoverEdge(),this.unhoverNode(),e.entity&&(e.entity.setState("hover"),this._lastHoverNode=e)},E.prototype.unhoverEdge=function(){var e=this._lastHoverEdge;e&&e.entity&&(e.entity.getState()!=="active"&&e.entity.setState("normal"),this._lastHoverEdge=null)},E.prototype.hoverEdge=function(e){this.unhoverNode(),this.unhoverEdge(),e.entity&&(e.entity.setState("hover"),this._lastHoverEdge=e)},E.prototype.activeEdge=function(e){typeof e=="string"&&(e=this._getEdgeByID(e)),e&&e.entity&&(this.unactiveAll(),e.entity.setState("active"),e.isExtra&&(e.entity.hidden=!1))},E.prototype.activeNode=function(e){typeof e=="string"&&(e=this._graph.getNodeById(e));var t=this._zr;e&&e.entity&&(this.unactiveAll(),e.entity.setState("active"),this._currentActiveNode=e)},E.prototype.activeNodeAndShowAdjacency=function(e){typeof e=="string"&&(e=this._graph.getNodeById(e));var t=this._zr;if(!e||!e.entity)return;this.unactiveAll(),e.entity.setState("active"),this._currentActiveNode=e;for(var n=0;n<e.edges.length;n++){var r=e.edges[n],i=r.node1===e?r.node2:r.node1;if(e.data.layerCounter===0&&r.isExtra)continue;var s=!1,o=!1;i.entity||(this._createNodeEntity(i),s=!0),r.entity||(this._createEdgeEntity(r),o=!0),r.isExtra&&(r.entity.hidden=!1),m.enableAnimation&&(s?this._growNodeAnimation(i,e,Math.random()*500):o&&r.entity.animateLength(t,300,0,e.entity)),this._syncOutTipEntities()}this._syncHeaderBarExplorePercent()},E.prototype.showEntityDetail=function(e,t){var n=this,r=this._graphLayout;typeof e=="string"&&(e=r.getNodeById(e));var i=this._kgraph.getComponentByType("SIDEBAR");i&&(i.hide(),setTimeout(function(){var r=n._loadDetailFromStorage(e.id),s=e.data?e.data.layerCounter:e.layerCounter;r?(i.setData(r),t&&i.show(e.id+","+s)):d(n._kgraph.getDetailAPI(),{detail_id:e.id},"callback",function(r){r._datatype="entity",r.layerCounter=e.data?e.data.layerCounter:e.layerCounter,i.setData(r),t&&i.show(e.id+","+s),n._saveDetailToStorage(e.id,r)})},300))},E.prototype.showRelationDetail=function(e){typeof e=="string"&&(e=this._getEdgeByID(e));if(!e)return;var t=this._kgraph.getComponentByType("SIDEBAR");if(t){t.hide();var n=this;setTimeout(function(){var r=n._loadDetailFromStorage(e.data.id),i=[e.node1.id,e.node1.data.layerCounter,e.node2.id,e.node2.data.layerCounter,e.data.id,e.isExtra?1:0,e.isSpecial?1:0].join(",");r?(t.setData(r,!0),t.show(i)):d(n._kgraph.getDetailAPI(),{detail_id:e.data.id},"callback",function(r){r.fromEntity=n._graph.getNodeById(r.fromID).data,r.toEntity=n._graph.getNodeById(r.toID).data,r._datatype="relation",t.setData(r,!0),t.show(i),n._saveDetailToStorage(e.data.id,r)})},300)}},E.prototype.hideSidebar=function(){var e=this._kgraph.getComponentByType("SIDEBAR");e&&e.hide()},E.prototype.showNodeEndTip=function(e){typeof e=="string"&&(e=graph.getNodeById(e));var t=this._kgraph.getComponentByType("TIP");t.setData(m.tip.nodeEnd,e)},E.prototype.showNodeHoverTip=function(e){typeof e=="string"&&(e=graph.getNodeById(e));var t=v.get("BKGraph_node_click_0")||0;if(!t){var n=this._kgraph.getComponentByType("TIP");n.setData(m.tip.node,e)}},E.prototype.showEdgeClickTip=function(e,t){typeof e=="string"&&(e=this._getEdgeByID(e));if(!e)return;var n=v.get("BKGraph_edge_click_0")||0;if(!n){this.activeEdge(e);var r=this._kgraph.getComponentByType("TIP"),i=t?m.tip.edgeOther:m.tip.edge;r.setData(i,e,!0)}},E.prototype.hideTip=function(){var e=this._kgraph.getComponentByType("TIP");e&&e.hide()},E.prototype.moveToEntity=function(e,t){var n=this._graph;typeof e=="string"&&(e=n.getNodeById(e));var r=this._zr;if(!e)return;var i=e.entity,o=r._graphRoot,u=g.call(i.el.position);s.mul(u,u,o.scale),s.sub(u,[r.getWidth()/2,r.getHeight()/2],u),this.moveTo(u[0],u[1],t)},E.prototype.moveToRelation=function(e,t){typeof e=="string"&&(e=this._getEdgeByID(e));if(!e)return;var n=this._zr,r=e.node1.entity.el.position,i=e.node2.entity.el.position,o=s.add([],r,i);o[0]/=2,o[1]/=2;var u=n._graphRoot;s.mul(o,o,u.scale),s.sub(o,[n.getWidth()/2,n.getHeight()/2],o),this.moveTo(o[0],o[1],t)},E.prototype.moveTo=function(e,t,n){var r=this._zr;if(m.enableAnimation){var i=this;i._animating=!0,this._graphRoot.animate().when(800,{position:[e,t]}).done(function(){i._animating=!1,n&&n()}).start("CubicInOut")}else{var s=this._graphRoot.position;s[0]=e,s[1]=t,r.refreshNextFrame(),n&&n()}this.hideTip()},E.prototype.moveLeft=function(e){var t=this._zr,n=g.call(this._graphRoot.position);n[0]+=t.getWidth()*.6,this.moveTo(n[0],n[1],e)},E.prototype.moveRight=function(e){var t=this._zr,n=g.call(this._graphRoot.position);n[0]-=t.getWidth()*.6,this.moveTo(n[0],n[1],e)},E.prototype.moveTop=function(e){var t=this._zr,n=g.call(this._graphRoot.position);n[1]+=t.getHeight()*.6,this.moveTo(n[0],n[1],e)},E.prototype.moveDown=function(e){var t=this._zr,n=g.call(this._graphRoot.position);n[1]-=t.getHeight()*.6,this.moveTo(n[0],n[1],e)},E.prototype.zoomIn=function(){var e=this._zr;layer.__zoom=layer.__zoom||1,this.zoomTo(layer.__zoom*1.3)},E.prototype.zoomOut=function(){var e=this._zr,t=e.painter.getLayer(0);t.__zoom=t.__zoom||1,this.zoomTo(t.__zoom/1.3)},E.prototype.zoomTo=function(e,t){var n=this._zr,r=n.getWidth()/2,i=n.getHeight()/2,s=n.painter.getLayer(0);s.__zoom=s.__zoom||1,e=Math.min(Math.max(e,.5),1.5);var o=e/s.__zoom,u=g.call(s.scale),a=g.call(s.position);a[0]-=(r-a[0])*(o-1),a[1]-=(i-a[1])*(o-1),u[0]*=o,u[1]*=o,n.animation.clear(),n.animation.animate(s).when(800,{position:a,scale:u,__zoom:e}).during(function(){s.dirty=!0,n.refreshNextFrame()}).done(function(){t&&t()}).start("CubicInOut"),this.hideTip()},E.prototype.uncollapse=function(){var e=this._graph;e.eachNode(function(e){e.entity||(this._createNodeEntity(e),e.canCollapse=!0)},this),e.eachEdge(function(e){e.entity||(this._createEdgeEntity(e),e.canCollapse=!0)},this),this._syncHeaderBarExplorePercent()},E.prototype.collapse=function(){var e=this._graph;e.eachNode(function(e){e.canCollapse&&(e.entity.stopAnimationAll(),this._root.removeChild(e.entity.el),e.canCollapse=!1,e.entity=null,this._nodeEntityCount--)},this),e.eachEdge(function(e){e.canCollapse&&(e.entity.stopAnimationAll(),this._root.removeChild(e.entity.el),e.canCollapse=!1,e.entity=null,m.enableAnimation&&this._extraEdgeBundle.removeEdge(e))},this),this._syncHeaderBarExplorePercent()},E.prototype.expandNode=function(e){var t=[];for(var n=0;n<e.edges.length;n++){var r=e.edges[n],i=r.node1===e?r.node2:r.node1;if(r.isExtra)continue;var s=!1;if(!i.entity){s=!0,this._createNodeEntity(i),t.push(i.id,i.data.layerCounter);for(var o=0,u=i.inEdges.length;o<u;o++){var a=i.inEdges[o];a.node1===e&&t.push(a.data.id)}}r.entity||this._createEdgeEntity(r),m.enableAnimation&&s&&this._growNodeAnimation(i,e,Math.random()*500)}var f=[];this._graph.eachNode(function(e,t){var n=e.data.layerCounter;f[n]?f[n]++:f[n]=1}),t.length&&c({type:"zhishitupuexpand",target:t.join(","),area:"entity",extend:f.join(",")}),this._syncHeaderBarExplorePercent()},E.prototype.getExplorePercent=function(){var e=this._graph.nodes;return(this._nodeEntityCount-this._baseEntityCount)/(e.length-this._baseEntityCount)},E.prototype._getEdgeByID=function(e){var t=this._graph;for(var n=0;n<t.edges.length;n++)if(t.edges[n].data.id===e)return e=t.edges[n],e},E.prototype._loadStorage=function(){if(!window.localStorage)return;var e=this._mainNode.id,t=this._graph,n=localStorage.BKGraph_expanded;if(!n)return;n=JSON.parse(n);if(n[e]){var r=n[e];for(var i=0;i<r.entities.length;i++){var s=t.getNodeById(r.entities[i]);s&&!s.entity&&this._createNodeEntity(s)}for(var i=0;i<r.relations.length;i++){var o=r.relations[i].split(","),u=t.getEdge(o[0],o[1]);u&&!u.entity&&this._createEdgeEntity(u)}}this._syncHeaderBarExplorePercent()},E.prototype._saveStorage=function(){if(!window.localStorage)return;var e=this._mainNode.id,t=[],n=[],r=this._graph;r.eachNode(function(e){e.entity&&t.push(e.id)}),r.eachEdge(function(e){e.entity&&n.push(e.node1.id+","+e.node2.id)});var i=localStorage.BKGraph_expanded;i?i=JSON.parse(i):i={},i[e]={entities:t,relations:n},localStorage.BKGraph_expanded=JSON.stringify(i)},E.prototype._loadDetailFromStorage=function(e){if(!window.sessionStorage)return;var t=sessionStorage.BKGraph_detail_data,n=null;if(!t)return;return t=JSON.parse(t),t[e]&&(n=t[e]),n},E.prototype._saveDetailToStorage=function(e,t){if(!window.sessionStorage)return;var n=sessionStorage.BKGraph_detail_data;n?n=JSON.parse(n):n={},n[e]=t;try{sessionStorage.BKGraph_detail_data=JSON.stringify(n)}catch(r){r.name=="QuotaExceededError"&&sessionStorage.removeItem("BKGraph_detail_data")}},E.prototype._syncOutTipEntities=function(){var e=this._zr,t=this._currentActiveNode;if(!t)return;var n=this._kgraph.getComponentByType("HEADERBAR"),r=this._kgraph.getComponentByType("SEARCHBAR"),i=0,o=0;n&&(i=n.el.clientHeight);if(r){var o=parseInt(h.getStyle(r.el,"bottom"));o+=r.el.clientHeight}var u=-parseInt(h.getStyle(this.el,"left")),a=this._graphRoot,l={x:(-a.position[0]+u)/a.scale[0],y:(-a.position[1]+i)/a.scale[1],width:(e.getWidth()-2*u)/a.scale[0],height:(e.getHeight()-i-o)/a.scale[1]};for(var c=0;c<t.edges.length;c++){var p=t.edges[c],d=p.node1===t?p.node2:p.node1;if(t.data.layerCounter===0&&p.isExtra)continue;if(!p.entity||!d.entity)continue;if(!d.entity.isInsideRect(l)){var v=p.entity.intersectRect(l),m=Infinity,g,y;for(var b=0;b<v.length;b++){var w=s.dist(v[b].point,d.entity.el.position);w<m&&(w=m,g=v[b].point,y=v[b].side)}if(y){d._outTipEntity||(d._outTipEntity=new f({label:d.data.name}),d._outTipEntity.initialize(e),this._root.addElement(d._outTipEntity.el));var E=d._outTipEntity.el.position;s.copy(E,g);switch(y){case"top":break;case"left":E[0]+=25;break;case"bottom":E[1]-=25;break;case"right":E[0]-=25}d._outTipEntity.el.dirty()}else d._outTipEntity&&(this._root.removeChild(d._outTipEntity.el),d._outTipEntity=null)}else d._outTipEntity&&(this._root.removeChild(d._outTipEntity.el),d._outTipEntity=null)}},E.prototype._growNodeAnimation=function(e,t,n){var r=this._zr,i=this._graph.getEdge(t.id,e.id)||this._graph.getEdge(e.id,t.id),s=this,o=e.entity.radius;e.entity.setRadius(1),this._animating=!0,i.entity.animateLength(r,300,0,t.entity,function(){e.entity.animateRadius(o,500,function(){s._animating=!1,t.entity.radius=t.layout.size,e.entity.radius=e.layout.size,i.entity.update()})})},E.prototype._createNodeEntity=function(e){var t=this._zr,n=new u({radius:e.layout.size,label:e.data.name,image:e.data.image,draggable:this.draggable,states:e===this.getMainNode()?m.mainNodeStates:m.nodeStates});n.initialize(this._zr),s.copy(n.el.position,e.layout.position);var r=this;return n.on("mouseover",function(){if(r._animating)return;r._lastHoverNode!==e&&(r.trigger("mouseover:entity",e.data),r.expandNode(e),r.showNodeHoverTip(e),r.hoverNode(e),c({type:"zhishitupuhover",target:[e.id,e.data.layerCounter].join(","),area:"entity"}))}),n.on("mouseout",function(){r.unhoverNode()}),n.on("click",function(){r.trigger("click:entity",e),r.hideTip();var t=v.get("BKGraph_node_click_0")||0;t||v.set("BKGraph_node_click_0",e.id,{expires:31104e4}),c({type:"zhishitupuclick",target:e.id+","+e.data.layerCounter,area:"entity"});if(n.getState()==="active"){r._currentActiveNode=null,r.unactiveAll(),r.hideSidebar();return}r._syncOutTipEntities(),r.activeNodeAndShowAdjacency(e),r.showEntityDetail(e,!0)}),e.entity=n,this._graphRoot.addElement(n.el),this._nodeEntityCount++,n},E.prototype._createEdgeEntity=function(e){var t=this,n=this._zr;if(e.node1.entity&&e.node2.entity){var r=new a({sourceEntity:e.node1.entity,targetEntity:e.node2.entity,label:e.data.relationName,layerCounter:Math.max(e.node1.data.layerCounter,e.node2.data.layerCounter),isExtra:e.isExtra,states:e.isExtra?m.extraEdgeStates:m.edgeStates});return e.isExtra&&(m.enableAnimation&&this._extraEdgeBundle.addEdge(e),r.hidden=!0),r.initialize(this._zr),r.on("click",function(){t.trigger("click:relation",e),c({type:"zhishitupuclick",target:[e.node1.id,e.node1.data.layerCounter,e.node2.id,e.node2.data.layerCounter,e.data.id,e.isExtra?1:0,e.isSpecial?1:0].join(","),area:"relation"});if(r.getState()=="active"){t.unactiveAll(),t.hideSidebar();return}this.activeEdge(e);var n=v.get("BKGraph_edge_click_0")||0;n||(t.hideTip(),v.set("BKGraph_edge_click_0",e.data.id,{expires:31104e4})),this.showRelationDetail(e)},this),r.on("mouseover",function(){t._lastHoverEdge!==e&&(t.trigger("mouseover:relation",e.data),t.hoverEdge(e))}),r.on("mouseout",function(){t.unhoverEdge()}),e.entity=r,this._graphRoot.addElement(r.el),r}},E.prototype._updateNodePositions=function(){var e=this._zr,t=this._graph;for(var n=0;n<t.nodes.length;n++){var r=t.nodes[n];r.entity&&(r.layout.fixed?s.copy(r.layout.position,r.entity.el.position):s.copy(r.entity.el.position,r.layout.position),e.modGroup(r.entity.el.id))}for(var n=0;n<t.edges.length;n++){var i=t.edges[n];i.entity&&i.entity.update(e)}m.enableAnimation&&this._extraEdgeBundle.update(e),e.refreshNextFrame()},E.prototype._syncHeaderBarExplorePercent=function(){m.isPlat||this._saveStorage()},E.prototype._culling=function(){var e=this._graph,t=this._zr;if(!e)return;var n=-parseInt(h.getStyle(this.el,"right")),r=t.getWidth(),i=t.getHeight(),o=this._graphRoot,u=o.position,a=o.scale,f={x:-u[0],y:-u[1],width:r/a[0],height:i/a[1]},l=0,p=0;for(var d=0;d<e.nodes.length;d++){var v=e.nodes[d];if(v.entity){v.entity.el.ignore=v.entity.hidden||!v.entity.isInsideRect(f),v.entity.el.ignore||(this._isFirstFrame?(l++,v.entity.loadImage(function(){l--,p++,l===0&&c({type:"zhishitupuscreenrendered",imageCount:p})},function(){l--,l===0&&c({type:"zhishitupuscreenrendered",imageCount:p})})):v.entity.loadImage());var m=v.entity.el.position;m=v.entity.el.transformCoordToGlobal(m[0],m[1]),s.min(this._min,this._min,m),s.max(this._max,this._max,m)}}for(var d=0;d<e.edges.length;d++){var g=e.edges[d];g.entity&&(g.entity.el.ignore=g.entity.hidden||!g.entity.isInsideRect(f))}this._isFirstFrame=!1},i.inherits(E,r),E}),function(e){function t(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function n(){this.raw=[],this.length=0}function s(){return"___"+i++}function o(e,t){var n=new Function;n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}function a(e){return u[e]}function l(e){return'"'+e.replace(/\x5C/g,"\\\\").replace(/"/g,'\\"').replace(/\x0A/g,"\\n").replace(/\x09/g,"\\t").replace(/\x0D/g,"\\r")+'"'}function c(e){return e.replace(/[\^\[\]\$\(\)\{\}\?\*\.\+]/g,function(e){return"\\"+e})}function h(e){var t=arguments;return e.replace(/\{([0-9]+)\}/g,function(e,n){return t[n-0+1]})}function g(e){return e=e.replace(/^\s*\*/,""),h('gv({0},["{1}"])',l(e),e.replace(/\[['"]?([^'"]+)['"]?\]/g,function(e,t){return"."+t}).split(".").join('","'))}function y(e,t,n,r,i,s){var o=n.length,u=e.split(t),a=0,f=[];for(var l=0,c=u.length;l<c;l++){var h=u[l];if(l){var p=1;a++;for(;;){var d=h.indexOf(n);if(d<0){f.push(a>1&&p?t:"",h);break}a=r?a-1:0,f.push(a>0&&p?t:"",h.slice(0,d),a>0?n:""),h=h.slice(d+o),p=0;if(a===0)break}a===0&&(i(f.join("")),s(h),f=[])}else h&&s(h)}a>0&&f.length>0&&(s(t),s(f.join("")))}function b(e,t,n){var r=[],i=t.options,s="",o="",u="",a="",f;return n&&(s="ts(",o=")",u=d,a=v,f=i.defaultFilter),y(e,i.variableOpen,i.variableClose,1,function(e){n&&e.indexOf("|")<0&&f&&(e+="|"+f);var i=e.indexOf("|"),l=(i>0?e.slice(0,i):e).replace(/^\s+/,"").replace(/\s+$/,""),c=i>0?e.slice(i+1):"",h=l.indexOf("*")===0,p=[h?"":s,g(l),h?"":o];if(c){c=b(c,t);var d=c.split("|");for(var v=0,m=d.length;v<m;v++){var y=d[v];/^\s*([a-z0-9_-]+)(\((.*)\))?\s*$/i.test(y)&&(p.unshift('fs["'+RegExp.$1+'"]('),RegExp.$3&&p.push(",",RegExp.$3),p.push(")"))}}r.push(u,p.join(""),a)},function(e){r.push(u,n?l(e):e,a)}),r.join("")}function w(e,t){this.value=e,this.engine=t}function E(e,t){this.value=e,this.engine=t,this.children=[],this.cloneProps=[]}function S(e,t){var n=e.stack,r=t?n.find(function(e){return e instanceof t}):n.bottom();if(r){var i;while((i=n.top())!==r){if(!i.autoClose)throw new Error(i.type+" must be closed manually: "+i.value);i.autoClose(e)}r.close(e)}return r}function T(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*(\(\s*master\s*=\s*([a-z0-9\/_-]+)\s*\))?\s*/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.master=RegExp.$3,this.name=RegExp.$1,E.call(this,e,t),this.blocks={}}function N(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,E.call(this,e,t),this.cloneProps=["name"]}function C(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,E.call(this,e,t),this.cloneProps=["name","state","blocks"],this.blocks={}}function k(e,t){if(!/^\s*([a-z0-9_]+)\s*=([\s\S]*)$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.expr=RegExp.$2,E.call(this,e,t),this.cloneProps=["name","expr"]}function L(e,t){if(!/^\s*([a-z0-9_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.args=RegExp.$3,E.call(this,e,t),this.cloneProps=["name","args"]}function A(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.args=RegExp.$3,E.call(this,e,t),this.cloneProps=["name","args"]}function O(e,t){var n=new RegExp(h("^\\s*({0}[\\s\\S]+{1})\\s+as\\s+{0}([0-9a-z_]+){1}\\s*(,\\s*{0}([0-9a-z_]+){1})?\\s*$",c(t.options.variableOpen),c(t.options.variableClose)),"i");if(!n.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.list=RegExp.$1,this.item=RegExp.$2,this.index=RegExp.$4,E.call(this,e,t),this.cloneProps=["list","item","index"]}function M(e,t){E.call(this,e,t)}function _(e,t){M.call(this,e,t)}function D(e,t){E.call(this,e,t)}function H(e,t){t.target=e;var n=t.engine,r=e.name;if(n.targets[r])switch(n.options.namingConflict){case"override":n.targets[r]=e,t.targets.push(r);case"ignore":break;default:throw new Error("Target exists: "+r)}else n.targets[r]=e,t.targets.push(r)}function j(e,t){B[e]=t,t.prototype.type=e}function F(e){this.options={commandOpen:"<!--",commandClose:"-->",commandSyntax:/^\s*(\/)?([a-z]+)\s*(?::([\s\S]*))?$/,variableOpen:"${",variableClose:"}",defaultFilter:"html"},this.config(e),this.targets={},this.filters=t({},f)}function I(e,t){function f(){var e;if(a.length>0&&(e=a.join(""))){var n=new w(e,t);n.beforeAdd(u),o.top().addChild(n),a=[],t.options.strip&&u.current instanceof E&&(n.value=e.replace(/^[\x20\t\r]*\n/,"")),u.current=n}}var r=t.options.commandOpen,i=t.options.commandClose,s=t.options.commandSyntax,o=new n,u={engine:t,targets:[],stack:o,target:null},a=[],l;return y(e,r,i,0,function(e){var n=s.exec(e);if(n&&(l=B[n[2].toLowerCase()])&&typeof l=="function"){f();var o=u.current;t.options.strip&&o instanceof w&&(o.value=o.value.replace(/\r?\n[\x20\t]*$/,"\n")),n[1]?o=S(u,l):(o=new l(n[3],t),typeof o.beforeOpen=="function"&&o.beforeOpen(u),o.open(u)),u.current=o}else/^\s*\/\//.test(e)||a.push(r,e,i);l=null},function(e){a.push(e)}),f(),S(u),u.targets}n.prototype={push:function(e){this.raw[this.length++]=e},pop:function(){if(this.length>0){var e=this.raw[--this.length];return this.raw.length=this.length,e}},top:function(){return this.raw[this.length-1]},bottom:function(){return this.raw[0]},find:function(e){var t=this.length;while(t--){var n=this.raw[t];if(e(n))return n}}};var i=178245,u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},f={html:function(e){return e.replace(/[&<>"']/g,a)},url:encodeURIComponent,raw:function(e){return e}},p='var r="";',d="r+=",v=";",m="return r;";typeof navigator!="undefined"&&/msie\s*([0-9]+)/i.test(navigator.userAgent)&&RegExp.$1-0<8&&(p="var r=[],ri=0;",d="r[ri++]=",m='return r.join("");'),w.prototype={getRendererBody:function(){var e=this.value,t=this.engine.options;return!e||t.strip&&/^\s*$/.test(e)?"":b(e,this.engine,1)},clone:function(){return this}},E.prototype={addChild:function(e){this.children.push(e)},open:function(e){var t=e.stack.top();t&&t.addChild(this),e.stack.push(this)},close:function(e){e.stack.top()===this&&e.stack.pop()},getRendererBody:function(){var e=[],t=this.children;for(var n=0;n<t.length;n++)e.push(t[n].getRendererBody());return e.join("")},clone:function(){var e=new this.constructor(this.value,this.engine);for(var t=0,n=this.children.length;t<n;t++)e.addChild(this.children[t].clone());for(var t=0,n=this.cloneProps.length;t<n;t++){var r=this.cloneProps[t];e[r]=this[r]}return e}};var x='data=data||{};var v={},fs=engine.filters,hg=typeof data.get=="function",gv=function(n,ps){var p=ps[0],d=v[p];if(d==null){if(hg){return data.get(n);}d=data[p];}for(var i=1,l=ps.length;i<l;i++)if(d!=null)d = d[ps[i]];return d;},ts=function(s){if(typeof s==="string"){return s;}if(s==null){s="";}return ""+s;};';o(T,E),o(N,E),o(C,E),o(k,E),o(L,E),o(A,E),o(O,E),o(M,E),o(_,M),o(D,M);var P={READING:1,READED:2,APPLIED:3,READY:4};C.prototype.applyMaster=T.prototype.applyMaster=function(e){function n(e){var r=e.children;if(r instanceof Array)for(var i=0,s=r.length;i<s;i++){var o=r[i];o instanceof N&&t[o.name]&&(o=r[i]=t[o.name]),n(o)}}if(this.state>=P.APPLIED)return 1;var t=this.blocks,r=this.engine.targets[e];if(r&&r.applyMaster(r.master))return this.children=r.clone().children,n(this),this.state=P.APPLIED,1},T.prototype.isReady=function(){function n(r){for(var i=0,s=r.children.length;i<s;i++){var o=r.children[i];if(o instanceof C){var u=e.targets[o.name];t=t&&u&&u.isReady(e)}else o instanceof E&&n(o)}}if(this.state>=P.READY)return 1;var e=this.engine,t=1;if(this.applyMaster(this.master))return n(this),t&&(this.state=P.READY),t},T.prototype.getRenderer=function(){if(this.renderer)return this.renderer;if(this.isReady()){var e=new Function("data","engine",[x,p,this.getRendererBody(),m].join("\n")),t=this.engine;return this.renderer=function(n){return e(n,t)},this.renderer}return null},T.prototype.open=function(e){S(e),E.prototype.open.call(this,e),this.state=P.READING,H(this,e)},k.prototype.open=A.prototype.open=function(e){e.stack.top().addChild(this)},N.prototype.open=function(e){E.prototype.open.call(this,e),(e.imp||e.target).blocks[this.name]=this},_.prototype.open=function(e){var t=new D;t.open(e);var n=S(e,M);n.addChild(this),e.stack.push(this)},D.prototype.open=function(e){var t=S(e,M);t.addChild(this),e.stack.push(this)},C.prototype.open=function(e){this.parent=e.stack.top(),this.target=e.target,E.prototype.open.call(this,e),this.state=P.READING,e.imp=this},A.prototype.close=k.prototype.close=function(){},C.prototype.close=function(e){E.prototype.close.call(this,e),this.state=P.READED,e.imp=null},T.prototype.close=function(e){E.prototype.close.call(this,e),this.state=this.master?P.READED:P.APPLIED,e.target=null},C.prototype.autoClose=function(e){var t=this.parent.children;t.push.apply(t,this.children),this.children.length=0;for(var n in this.blocks)this.target.blocks[n]=this.blocks[n];this.blocks={},this.close(e)},A.prototype.beforeOpen=C.prototype.beforeOpen=k.prototype.beforeOpen=O.prototype.beforeOpen=L.prototype.beforeOpen=N.prototype.beforeOpen=M.prototype.beforeOpen=w.prototype.beforeAdd=function(e){if(e.stack.bottom())return;var t=new T(s(),e.engine);t.open(e)},C.prototype.getRendererBody=function(){return this.applyMaster(this.name),E.prototype.getRendererBody.call(this)},A.prototype.getRendererBody=function(){return h("{0}engine.render({2},{{3}}){1}",d,v,l(this.name),b(this.args,this.engine).replace(/(^|,)\s*([a-z0-9_]+)\s*=/ig,function(e,t,n){return(t||"")+l(n)+":"}))},k.prototype.getRendererBody=function(){return this.expr?h("v[{0}]={1};",l(this.name),b(this.expr,this.engine)):""},M.prototype.getRendererBody=function(){return h("if({0}){{1}}",b(this.value,this.engine),E.prototype.getRendererBody.call(this))},D.prototype.getRendererBody=function(){return h("}else{{0}",E.prototype.getRendererBody.call(this))},O.prototype.getRendererBody=function(){return h('var {0}={1};if({0} instanceof Array)for (var {4}=0,{5}={0}.length;{4}<{5};{4}++){v[{2}]={4};v[{3}]={0}[{4}];{6}}else if(typeof {0}==="object")for(var {4} in {0}){v[{2}]={4};v[{3}]={0}[{4}];{6}}',s(),b(this.list,this.engine),l(this.index||s()),l(this.item),s(),s(),E.prototype.getRendererBody.call(this))},L.prototype.getRendererBody=function(){var e=this.args;return h("{2}fs[{5}]((function(){{0}{4}{1}})(){6}){3}",p,m,d,v,E.prototype.getRendererBody.call(this),l(this.name),e?","+b(e,this.engine):"")};var B={};j("target",T),j("block",N),j("import",C),j("use",A),j("var",k),j("for",O),j("if",M),j("elif",_),j("else",D),j("filter",L),F.prototype.config=function(e){t(this.options,e)},F.prototype.compile=F.prototype.parse=function(e){if(e){var t=I(e,this);if(t.length)return this.targets[t[0]].getRenderer()}return new Function('return ""')},F.prototype.getRenderer=function(e){var t=this.targets[e];if(t)return t.getRenderer()},F.prototype.render=function(e,t){var n=this.getRenderer(e);return n?n(t):""},F.prototype.addFilter=function(e,t){typeof t=="function"&&(this.filters[e]=t)};var q=new F;q.Engine=F,typeof exports=="object"&&typeof module=="object"?exports=module.exports=q:typeof r=="function"&&r.amd?r("etpl",q):e.etpl=q}(this),function(e){function st(e,t,r,i){var s,o,a,l,c,h,v,y,b,x;(t?t.ownerDocument||t:S)!==d&&p(t),t=t||d,r=r||[],l=t.nodeType;if(typeof e!="string"||!e||l!==1&&l!==9&&l!==11)return r;if(!i&&m){if(l!==11&&(s=Z.exec(e)))if(a=s[1]){if(l===9){o=t.getElementById(a);if(!o||!o.parentNode)return r;if(o.id===a)return r.push(o),r}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&w(t,o)&&o.id===a)return r.push(o),r}else{if(s[2])return P.apply(r,t.getElementsByTagName(e)),r;if((a=s[3])&&n.getElementsByClassName)return P.apply(r,t.getElementsByClassName(a)),r}if(n.qsa&&(!g||!g.test(e))){y=v=E,b=t,x=l!==1&&e;if(l===1&&t.nodeName.toLowerCase()!=="object"){h=u(e),(v=t.getAttribute("id"))?y=v.replace(tt,"\\$&"):t.setAttribute("id",y),y="[id='"+y+"'] ",c=h.length;while(c--)h[c]=y+mt(h[c]);b=et.test(e)&&dt(t.parentNode)||t,x=h.join(",")}if(x)try{return P.apply(r,b.querySelectorAll(x)),r}catch(T){}finally{v||t.removeAttribute("id")}}}return f(e.replace(z,"$1"),t,r,i)}function ot(){function t(n,r){return e.push(n+" ")>i.cacheLength&&delete t[e.shift()],t[n+" "]=r}var e=[];return t}function ut(e){return e[E]=!0,e}function at(e){var t=d.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ft(e,t){var n=e.split("|"),r=e.length;while(r--)i.attrHandle[n[r]]=t}function lt(e,t){var n=t&&e,r=n&&e.nodeType===1&&t.nodeType===1&&(~t.sourceIndex||A)-(~e.sourceIndex||A);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function ct(e){return function(t){var n=t.nodeName.toLowerCase();return n==="input"&&t.type===e}}function ht(e){return function(t){var n=t.nodeName.toLowerCase();return(n==="input"||n==="button")&&t.type===e}}function pt(e){return ut(function(t){return t=+t,ut(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function dt(e){return e&&typeof e.getElementsByTagName!="undefined"&&e}function vt(){}function mt(e){var t=0,n=e.length,r="";for(;t<n;t++)r+=e[t].value;return r}function gt(e,t,n){var r=t.dir,i=n&&r==="parentNode",s=T++;return t.first?function(t,n,s){while(t=t[r])if(t.nodeType===1||i)return e(t,n,s)}:function(t,n,o){var u,a,f=[x,s];if(o){while(t=t[r])if(t.nodeType===1||i)if(e(t,n,o))return!0}else while(t=t[r])if(t.nodeType===1||i){a=t[E]||(t[E]={});if((u=a[r])&&u[0]===x&&u[1]===s)return f[2]=u[2];a[r]=f;if(f[2]=e(t,n,o))return!0}}}function yt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function bt(e,t,n){var r=0,i=t.length;for(;r<i;r++)st(e,t[r],n);return n}function wt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=t!=null;for(;u<a;u++)if(s=e[u])if(!n||n(s,r,i))o.push(s),f&&t.push(u);return o}function Et(e,t,n,r,i,s){return r&&!r[E]&&(r=Et(r)),i&&!i[E]&&(i=Et(i,s)),ut(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||bt(t||"*",u.nodeType?[u]:u,[]),m=e&&(s||!t)?wt(v,h,e,u,a):v,g=n?i||(s?e:d||r)?[]:o:m;n&&n(m,g,u,a);if(r){f=wt(g,p),r(f,[],u,a),l=f.length;while(l--)if(c=f[l])g[p[l]]=!(m[p[l]]=c)}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?B(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=wt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):P.apply(o,g)})}function St(e){var t,n,r,s=e.length,o=i.relative[e[0].type],u=o||i.relative[" "],a=o?1:0,f=gt(function(e){return e===t},u,!0),c=gt(function(e){return B(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==l)||((t=n).nodeType?f(e,n,r):c(e,n,r))}];for(;a<s;a++)if(n=i.relative[e[a].type])h=[gt(yt(h),n)];else{n=i.filter[e[a].type].apply(null,e[a].matches);if(n[E]){r=++a;for(;r<s;r++)if(i.relative[e[r].type])break;return Et(a>1&&yt(h),a>1&&mt(e.slice(0,a-1).concat({value:e[a-2].type===" "?"*":""})).replace(z,"$1"),n,a<r&&St(e.slice(a,r)),r<s&&St(e=e.slice(r)),r<s&&mt(e))}h.push(n)}return yt(h)}function xt(e,t){var n=t.length>0,r=e.length>0,s=function(s,o,u,a,f){var c,h,p,v=0,m="0",g=s&&[],y=[],b=l,w=s||r&&i.find.TAG("*",f),E=x+=b==null?1:Math.random()||.1,S=w.length;f&&(l=o!==d&&o);for(;m!==S&&(c=w[m])!=null;m++){if(r&&c){h=0;while(p=e[h++])if(p(c,o,u)){a.push(c);break}f&&(x=E)}n&&((c=!p&&c)&&v--,s&&g.push(c))}v+=m;if(n&&m!==v){h=0;while(p=t[h++])p(g,y,o,u);if(s){if(v>0)while(m--)!g[m]&&!y[m]&&(y[m]=_.call(a));y=wt(y)}P.apply(a,y),f&&!s&&y.length>0&&v+t.length>1&&st.uniqueSort(a)}return f&&(x=E,l=b),g};return n?ut(s):s}var t,n,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E="sizzle"+1*new Date,S=e.document,x=0,T=0,N=ot(),C=ot(),k=ot(),L=function(e,t){return e===t&&(h=!0),0},A=1<<31,O={}.hasOwnProperty,M=[],_=M.pop,D=M.push,P=M.push,H=M.slice,B=function(e,t){var n=0,r=e.length;for(;n<r;n++)if(e[n]===t)return n;return-1},j="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",F="[\\x20\\t\\r\\n\\f]",I="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",q="\\["+F+"*("+I+")(?:"+F+"*([*^$|!~]?=)"+F+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+I+"))|)"+F+"*\\]",R=":("+I+")(?:\\(("+"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|"+"((?:\\\\.|[^\\\\()[\\]]|"+q+")*)|"+".*"+")\\)|)",U=new RegExp(F+"+","g"),z=new RegExp("^"+F+"+|((?:^|[^\\\\])(?:\\\\.)*)"+F+"+$","g"),W=new RegExp("^"+F+"*,"+F+"*"),X=new RegExp("^"+F+"*([>+~]|"+F+")"+F+"*"),V=new RegExp("="+F+"*([^\\]'\"]*?)"+F+"*\\]","g"),$=new RegExp(R),J=new RegExp("^"+I+"$"),K={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),TAG:new RegExp("^("+I+"|[*])"),ATTR:new RegExp("^"+q),PSEUDO:new RegExp("^"+R),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+F+"*(even|odd|(([+-]|)(\\d*)n|)"+F+"*(?:([+-]|)"+F+"*(\\d+)|))"+F+"*\\)|)","i"),bool:new RegExp("^(?:"+j+")$","i"),needsContext:new RegExp("^"+F+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+F+"*((?:-\\d)?\\d*)"+F+"*\\)|)(?=[^-]|$)","i")},Q=/^(?:input|select|textarea|button)$/i,G=/^h\d$/i,Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,et=/[+~]/,tt=/'|\\/g,nt=new RegExp("\\\\([\\da-f]{1,6}"+F+"?|("+F+")|.)","ig"),rt=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,r&1023|56320)};try{P.apply(M=H.call(S.childNodes),S.childNodes),M[S.childNodes.length].nodeType}catch(it){P={apply:M.length?function(e,t){D.apply(e,H.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}n=st.support={},o=st.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},p=st.setDocument=function(e){var t,r=e?e.ownerDocument||e:S,s=r.defaultView;if(r===d||r.nodeType!==9||!r.documentElement)return d;d=r,v=r.documentElement,m=!o(r),s&&s!==s.top&&(s.addEventListener?s.addEventListener("unload",function(){p()},!1):s.attachEvent&&s.attachEvent("onunload",function(){p()})),n.attributes=at(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=at(function(e){return e.appendChild(r.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=Y.test(r.getElementsByClassName),n.getById=at(function(e){return v.appendChild(e).id=E,!r.getElementsByName||!r.getElementsByName(E).length}),n.getById?(i.find.ID=function(e,t){if(typeof t.getElementById!="undefined"&&m){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},i.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){return e.getAttribute("id")===t}}):(delete i.find.ID,i.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){var n=typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id");return n&&n.value===t}}),i.find.TAG=n.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!="undefined")return t.getElementsByTagName(e);if(n.qsa)return t.querySelectorAll(e)}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if(e==="*"){while(n=s[i++])n.nodeType===1&&r.push(n);return r}return s},i.find.CLASS=n.getElementsByClassName&&function(e,t){if(m)return t.getElementsByClassName(e)},y=[],g=[];if(n.qsa=Y.test(r.querySelectorAll))at(function(e){e.innerHTML="<select msallowcapture=''><option id='d\f]' selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&g.push("[*^$]="+F+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||g.push("\\["+F+"*(?:value|"+j+")"),e.querySelectorAll("[id~=d]").length||g.push("~="),e.querySelectorAll(":checked").length||g.push(":checked")}),at(function(e){var t=r.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&g.push("name"+F+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||g.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),g.push(",.*:")});return(n.matchesSelector=Y.test(b=v.matches||v.webkitMatchesSelector||v.mozMatchesSelector||v.oMatchesSelector||v.msMatchesSelector))&&at(function(e){n.disconnectedMatch=b.call(e,"div"),b.call(e,"[s!='']:x"),y.push("!=",R)}),g=g.length&&new RegExp(g.join("|")),y=y.length&&new RegExp(y.join("|")),t=Y.test(v.compareDocumentPosition),w=t||Y.test(v.contains)?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&r.nodeType===1&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&e.compareDocumentPosition(r)&16)}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},L=t?function(e,t){if(e===t)return h=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i?i:(i=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,i&1||!n.sortDetached&&t.compareDocumentPosition(e)===i?e===r||e.ownerDocument===S&&w(S,e)?-1:t===r||t.ownerDocument===S&&w(S,t)?1:c?B(c,e)-B(c,t):0:i&4?-1:1)}:function(e,t){if(e===t)return h=!0,0;var n,i=0,s=e.parentNode,o=t.parentNode,u=[e],a=[t];if(!s||!o)return e===r?-1:t===r?1:s?-1:o?1:c?B(c,e)-B(c,t):0;if(s===o)return lt(e,t);n=e;while(n=n.parentNode)u.unshift(n);n=t;while(n=n.parentNode)a.unshift(n);while(u[i]===a[i])i++;return i?lt(u[i],a[i]):u[i]===S?-1:a[i]===S?1:0},r},st.matches=function(e,t){return st(e,null,null,t)},st.matchesSelector=function(e,t){(e.ownerDocument||e)!==d&&p(e),t=t.replace(V,"='$1']");if(n.matchesSelector&&m&&(!y||!y.test(t))&&(!g||!g.test(t)))try{var r=b.call(e,t);if(r||n.disconnectedMatch||e.document&&e.document.nodeType!==11)return r}catch(i){}return st(t,d,null,[e]).length>0},st.contains=function(e,t){return(e.ownerDocument||e)!==d&&p(e),w(e,t)},st.attr=function(e,t){(e.ownerDocument||e)!==d&&p(e);var r=i.attrHandle[t.toLowerCase()],s=r&&O.call(i.attrHandle,t.toLowerCase())?r(e,t,!m):undefined;return s!==undefined?s:n.attributes||!m?e.getAttribute(t):(s=e.getAttributeNode(t))&&s.specified?s.value:null},st.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},st.uniqueSort=function(e){var t,r=[],i=0,s=0;h=!n.detectDuplicates,c=!n.sortStable&&e.slice(0),e.sort(L);if(h){while(t=e[s++])t===e[s]&&(i=r.push(s));while(i--)e.splice(r[i],1)}return c=null,e},s=st.getText=function(e){var t,n="",r=0,i=e.nodeType;if(!i)while(t=e[r++])n+=s(t);else if(i===1||i===9||i===11){if(typeof e.textContent=="string")return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=s(e)}else if(i===3||i===4)return e.nodeValue;return n},i=st.selectors={cacheLength:50,createPseudo:ut,match:K,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(nt,rt),e[3]=(e[3]||e[4]||e[5]||"").replace(nt,rt),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1].slice(0,3)==="nth"?(e[3]||st.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*(e[3]==="even"||e[3]==="odd")),e[5]=+(e[7]+e[8]||e[3]==="odd")):e[3]&&st.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return K.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&$.test(n)&&(t=u(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(nt,rt).toLowerCase();return e==="*"?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=N[e+" "];return t||(t=new RegExp("(^|"+F+")"+e+"("+F+"|$)"))&&N(e,function(e){return t.test(typeof e.className=="string"&&e.className||typeof e.getAttribute!="undefined"&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=st.attr(r,e);return i==null?t==="!=":t?(i+="",t==="="?i===n:t==="!="?i!==n:t==="^="?n&&i.indexOf(n)===0:t==="*="?n&&i.indexOf(n)>-1:t==="$="?n&&i.slice(-n.length)===n:t==="~="?(" "+i.replace(U," ")+" ").indexOf(n)>-1:t==="|="?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s=e.slice(0,3)!=="nth",o=e.slice(-4)!=="last",u=t==="of-type";return r===1&&i===0?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),y=!a&&!u;if(m){if(s){while(v){c=t;while(c=c[v])if(u?c.nodeName.toLowerCase()===g:c.nodeType===1)return!1;d=v=e==="only"&&!d&&"nextSibling"}return!0}d=[o?m.firstChild:m.lastChild];if(o&&y){l=m[E]||(m[E]={}),f=l[e]||[],p=f[0]===x&&f[1],h=f[0]===x&&f[2],c=p&&m.childNodes[p];while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if(c.nodeType===1&&++h&&c===t){l[e]=[x,p,h];break}}else if(y&&(f=(t[E]||(t[E]={}))[e])&&f[0]===x)h=f[1];else while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if((u?c.nodeName.toLowerCase()===g:c.nodeType===1)&&++h){y&&((c[E]||(c[E]={}))[e]=[x,h]);if(c===t)break}return h-=i,h===r||h%r===0&&h/r>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||st.error("unsupported pseudo: "+e);return r[E]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?ut(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=B(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:ut(function(e){var t=[],n=[],r=a(e.replace(z,"$1"));return r[E]?ut(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)if(s=o[u])e[u]=!(t[u]=s)}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:ut(function(e){return function(t){return st(e,t).length>0}}),contains:ut(function(e){return e=e.replace(nt,rt),function(t){return(t.textContent||t.innerText||s(t)).indexOf(e)>-1}}),lang:ut(function(e){return J.test(e||"")||st.error("unsupported lang: "+e),e=e.replace(nt,rt).toLowerCase(),function(t){var n;do if(n=m?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||n.indexOf(e+"-")===0;while((t=t.parentNode)&&t.nodeType===1);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===v},focus:function(e){return e===d.activeElement&&(!d.hasFocus||d.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return G.test(e.nodeName)},input:function(e){return Q.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},text:function(e){var t;return e.nodeName.toLowerCase()==="input"&&e.type==="text"&&((t=e.getAttribute("type"))==null||t.toLowerCase()==="text")},first:pt(function(){return[0]}),last:pt(function(e,t){return[t-1]}),eq:pt(function(e,t,n){return[n<0?n+t:n]}),even:pt(function(e,t){var n=0;for(;n<t;n+=2)e.push(n);return e}),odd:pt(function(e,t){var n=1;for(;n<t;n+=2)e.push(n);return e}),lt:pt(function(e,t,n){var r=n<0?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:pt(function(e,t,n){var r=n<0?n+t:n;for(;++r<t;)e.push(r);return e})}},i.pseudos.nth=i.pseudos.eq;for(t in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[t]=ct(t);for(t in{submit:!0,reset:!0})i.pseudos[t]=ht(t);vt.prototype=i.filters=i.pseudos,i.setFilters=new vt,u=st.tokenize=function(e,t){var n,r,s,o,u,a,f,l=C[e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=i.preFilter;while(u){if(!n||(r=W.exec(u)))r&&(u=u.slice(r[0].length)||u),a.push(s=[]);n=!1;if(r=X.exec(u))n=r.shift(),s.push({value:n,type:r[0].replace(z," ")}),u=u.slice(n.length);for(o in i.filter)(r=K[o].exec(u))&&(!f[o]||(r=f[o](r)))&&(n=r.shift(),s.push({value:n,type:o,matches:r}),u=u.slice(n.length));if(!n)break}return t?u.length:u?st.error(e):C(e,a).slice(0)},a=st.compile=function(e,t){var n,r=[],i=[],s=k[e+" "];if(!s){t||(t=u(e)),n=t.length;while(n--)s=St(t[n]),s[E]?r.push(s):i.push(s);s=k(e,xt(i,r)),s.selector=e}return s},f=st.select=function(e,t,r,s){var o,f,l,c,h,p=typeof e=="function"&&e,d=!s&&u(e=p.selector||e);r=r||[];if(d.length===1){f=d[0]=d[0].slice(0);if(f.length>2&&(l=f[0]).type==="ID"&&n.getById&&t.nodeType===9&&m&&i.relative[f[1].type]){t=(i.find.ID(l.matches[0].replace(nt,rt),t)||[])[0];if(!t)return r;p&&(t=t.parentNode),e=e.slice(f.shift().value.length)}o=K.needsContext.test(e)?0:f.length;while(o--){l=f[o];if(i.relative[c=l.type])break;if(h=i.find[c])if(s=h(l.matches[0].replace(nt,rt),et.test(f[0].type)&&dt(t.parentNode)||t)){f.splice(o,1),e=s.length&&mt(f);if(!e)return P.apply(r,s),r;break}}}return(p||a(e,d))(s,t,!m,r,et.test(e)&&dt(t.parentNode)||t),r},n.sortStable=E.split("").sort(L).join("")===E,n.detectDuplicates=!!h,p(),n.sortDetached=at(function(e){return e.compareDocumentPosition(d.createElement("div"))&1}),at(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild.getAttribute("href")==="#"})||ft("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,t.toLowerCase()==="type"?1:2)}),(!n.attributes||!at(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),e.firstChild.getAttribute("value")===""}))&&ft("value",function(e,t,n){if(!n&&e.nodeName.toLowerCase()==="input")return e.defaultValue}),at(function(e){return e.getAttribute("disabled")==null})||ft(j,function(e,t,n){var r;if(!n)return e[t]===!0?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),typeof r=="function"&&r.amd?r("Sizzle",[],function(){return st}):typeof module!="undefined"&&module.exports?module.exports=st:e.Sizzle=st}(window),r("bkgraph/util/ScrollBar",["require","./util","Sizzle"],function(e){var t=e("./util"),n=e("Sizzle"),r=t.addEventListener,i=t.removeEventListener,s=function(e){this._$viewport=e.parentNode,this._$content=e,this._$dim=n(".bkg-sidebar-dimup",this._$viewport)[0],this._$scrollButton=null,this._$scrollBar=null,this._scroll=0,this._onMouseDown=t.bind(this._onMouseDown,this),this._onMouseMove=t.bind(this._onMouseMove,this),this._onMouseUp=t.bind(this._onMouseUp,this),this._onMouseScroll=t.bind(this._onMouseScroll,this),this._onKeyDown=t.bind(this._onKeyDown,this),this._init(),this._sx=0,this._sy=0,this._thumbTop=0};return s.prototype._init=function(){var e=this._$viewport,n=this._$scrollBar,i=this._$scrollButton;t.getStyle(e,"position")!=="absolute"&&(e.style.position="relative"),t.addClass(e,"bkg-scrollbar-viewport"),t.addClass(this._$content,"bkg-scrollbar-content"),e.setAttribute("tabindex",0),i=document.createElement("div"),i.className="bkg-scrollbar-button",n=document.createElement("div"),n.className="bkg-scrollbar-bar-y",e.appendChild(n),n.appendChild(i),r(this._$scrollButton,"mousedown",this._onMouseDown),r(e,"mousewheel",this._onMouseScroll),r(e,"DOMMouseScroll",this._onMouseScroll),r(e,"keydown",this._onKeyDown),this.resize()},s.prototype._onMouseDown=function(e){r(document.body,"mousemove",this._onMouseMove),r(document.body,"mouseup",this._onMouseUp),this._sx=e.screenX,this._sy=e.screenY},s.prototype._onMouseUp=function(){i(document.body,"mouseup",this._onMouseUp),i(document.body,"mousemove",this._onMouseMove)},s.prototype._onMouseMove=function(e){e.preventDefault&&e.preventDefault(),this._thumbTop+=e.screenY-this._sy,this._thumbTop=Math.max(this._thumbTop,0);var t=this._scrollBarHeight-this._scrollButtonHeight;this._thumbTop=Math.min(t,this._thumbTop),this._$scrollButton.style.top=this._thumbTop+"px",this._scroll=(this._contentHeight-this._viewportHeight)*this._thumbTop/t,this._$content.style.top=-this._scroll+"px",this._sy=e.screenY,this._sx=e.screenX,this._dim(this._scroll)},s.prototype._onMouseScroll=function(e){var t=e.wheelDelta||-e.detail*5;this.scrollTo(this._scroll-t)},s.prototype._onKeyDown=function(e){switch(e.keyCode){case 38:this.scrollTo(this._scroll-100);break;case 40:this.scrollTo(this._scroll+100)}},s.prototype.scrollTo=function(e){e=Math.max(0,e);var t=Math.max(this._contentHeight-this._viewportHeight,0);e=Math.min(e,t),this._scroll=e,this._$content.style.top=-e+"px",this._thumbTop=(this._scrollBarHeight-this._scrollButtonHeight)*e/t,this._$scrollButton.style.top=(this._thumbTop||0)+"px",this._dim(e)},s.prototype.resize=function(){this._contentHeight=parseInt(this._$content.clientHeight),this._viewportHeight=parseInt(this._$viewport.clientHeight),this.scrollTo(0);if(this._viewportHeight>this._contentHeight){this._$scrollBar.style.display="none";return}this._$scrollBar.style.display="block",this._scrollBarHeight=parseInt(this._$scrollBar.clientHeight);var e=this._scrollBarHeight*this._viewportHeight/this._contentHeight;e==this._viewportHeight&&(e=0),this._scrollButtonHeight=e,this._$scrollButton.style.height=e+"px"},s.prototype.destory=function(e){this._$viewport.removeChild(this._$scrollBar),i(this._$scrollButton,"mousedown",this._onMouseDown),i(this._$viewport,"mousewheel",this._onMouseScroll),i(this._$viewport,"DOMMouseScroll",this._onMouseScroll),i(this._$viewport,"keydown",this._onKeyDown)},s.prototype._dim=function(e){e>10?t.removeClass(this._$dim,"bkg-hidden"):t.addClass(this._$dim,"bkg-hidden")},s}),r("text!bkgraph/html/sideBarModule.html",[],function(){return'<!-- target: sidebarModuleTitle -->\n<div class="bkg-module-title">\n    <h4>${sidebarModuleName}</h4>\n</div>\n\n<!-- target: sidebarNews -->\n<div class="bkg-news bkg-sidebar-module">\n    <!-- block: newsModuleTitle -->\n    <div class="bkg-module-title">\n        <h4 class="bkg-title"><a href="http://www.baidu.com/s?wd=${name|url}%20最新动态" title="最新动态" data-area="entity-news" target="_blank">最新动态</a></h4>\n    </div>\n    <!-- /block -->\n    <ul>\n        <!-- for: ${news} as ${item}, ${index} -->\n        <li class="bkg-item">\n            <a href="${item.url}" target="_blank" class="bkg-title" title="${item.title}" data-area="${_datatype}-news">\n            ${item.title|truncate(20)}\n            </a>\n            <div class="bkg-news-tail">\n                <span class="bkg-news-source">${item.source}</span>\n                <span class="bkg-publish-time">${item.publishTime|truncate(10, \'\')}</span>\n            </div>\n        </li>\n        <!-- /for -->\n    </ul>\n</div>\n\n<!-- target: sidebarRelationNews(master=sidebarNews) -->\n<!-- block: newsModuleTitle -->\n<div class="bkg-module-title">\n    <h4 class="bkg-title"><a href="http://www.baidu.com/s?ie=utf-8&wd=${fromEntity.name|url}%20${toEntity.name|url}%20最新动态" title="${fromEntity.name} 和 ${toEntity.name} 的最新动态" data-area="relation-news" target="_blank">${fromEntity.name} 和 ${toEntity.name} 的最新动态</a></h4>\n</div>\n<!-- /block -->\n\n<!-- target: sidebarWeibo -->\n<div class="bkg-weibo bkg-sidebar-module">\n    <div class="bkg-module-title">\n        <h4><a href="${weibo.latestWeiboUrl}" title="新浪微博" data-area="entity-weibo" target="_blank">新浪微博</a></h4>\n    </div>\n    <div class="bkg-weibo-info">\n        <img class="bkg-left" src="${weibo.image}" alt="">\n        <div class="bkg-right">\n            <h5>\n                ${weibo.name}\n                <!-- if ${certification} === \'Plus V\' -->\n                <span class="bkg-weibo-v"></span>\n                <!-- /if -->\n            </h5>\n            <p>粉丝: ${weibo.fans}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;微博: ${weibo.weiboNum}</p>\n        </div>\n    </div>\n    <div class="bkg-latest-weibo">\n        <p class="bkg-latest-weibo-content">${weibo.latestWeibo|trim}<a href="${weibo.latestWeiboUrl}" target="_blank" data-area="entity-weibo" title="查看全文">查看全文</a></p>\n        <div class="bkg-latest-weibo-info">\n            <span class="bkg-latest-weibo-time" target="_blank">${weibo.latestWeiboTime}</span>\n            <a class="bkg-latest-weibo-comment" href="${weibo.latestWeiboUrl}" target="_blank" data-area="entity-weibo" title="评论">${weibo.latestWeiboComment}</a>\n            <a class="bkg-latest-weibo-forward" href="${weibo.latestWeiboUrl}" target="_blank" data-area="entity-weibo" title="转发">${weibo.latestWeiboForward}</a>\n        </div>\n    </div>\n    <div style="clear:both;"></div>\n</div>\n\n<!-- target: sidebarWorks -->\n<div class="bkg-works bkg-sidebar-module">\n    <div class="bkg-module-title">\n        <h4>热门作品</h4>\n        <div class="bkg-more">\n            <a href="http://www.baidu.com/s?ie=utf-8&wd=${name|url}%20${representativeWorkName|url}" title="更多" data-area="entity-representativeWork" target="_blank">更多 ></a>\n        </div>\n    </div>\n    <ul>\n    <!-- for: ${representativeWork} as ${work}, ${idx} -->\n        <!-- if: ${idx} < 4 -->\n        <li>\n            <a href="${work.movieRedir}" class="bkg-hoverable" target="_blank" title="${work.movieName}" data-area="entity-representativeWork">\n                <img src="${work.movieImage}" alt="" />\n                <span class="bkg-work-type">${work.movieType|truncate(4)}</span>\n                <span class="bkg-work-title">${work.movieName|truncate(4)}</span>\n            </a>\n        </li>\n        <!-- /if -->\n    <!-- /for -->\n    </ul>\n</div>\n\n<!-- target: sidebarMailuo -->\n<div class="bkg-mailuo bkg-sidebar-module">\n    <!-- <p class="bkg-mailuo-title">${fromEntity.name}${toEntity.name}${relationName|truncate(6)} 发展脉络</p> -->\n    <div class="bkg-module-title">\n        <h4><!-- ${fromEntity.name}${toEntity.name}${relationName|truncate(6)} --> 关系发展脉络</h4>\n    </div>\n    <ul>\n        <!-- for: ${eventMaiLuo} as ${item}, ${index} -->\n            <!-- if: ${item.year} -->\n            <li class="bkg-item">\n                <span class="bkg-publish-year">${item.year}</span>\n            </li>\n            <!-- /if -->\n            <li class="bkg-item">\n                <div class="bkg-circle"></div>\n                <span class="bkg-publish-time">${item.publishTime}</span>\n                <a href="${item.url}" target="_blank" class="bkg-title" title="${item.title}" data-area="relation-mailuo">\n                ${item.title|truncate(12)}\n                </a>\n            </li>\n        <!-- /for -->\n    </ul>\n</div>\n\n<!-- target: sidebarLatestWorks -->\n<div class="bkg-works bkg-sidebar-module">\n    <div class="bkg-module-title">\n        <h4>最新影视作品</h4>\n        <div class="bkg-more">\n            <a href="http://www.baidu.com/s?ie=utf-8&wd=${name|url}%20最新影视作品" title="更多" data-area="entity-latestwork" target="_blank">更多 ></a>\n        </div>\n    </div>\n    <ul>\n    <!-- for: ${representativeWork} as ${work}, ${idx} -->\n        <li>\n            <a href="${work.movieRedir}" target="_blank" title="${work.movieName}" data-area="entity-latestwork">\n                <img src="${work.movieImage}" class="bkg-hoverable" alt="" />\n                <span class="bkg-work-title">${work.movieName}</span>\n            </a>\n        </li>\n    <!-- /for -->\n    </ul>\n</div>\n\n<!-- target: sidebarShow -->\n<div class="bkg-show bkg-sidebar-module">\n    <div class="bkg-module-title">\n        <h4>最新综艺</h4>\n        <div class="bkg-more">\n            <a href="http://www.baidu.com/s?ie=utf-8&wd=${name|url}%20${showName|url}" title="更多" data-area="entity-show" target="_blank">更多 ></a>\n        </div>\n    </div>\n    <ul>\n    <!-- for: ${show} as ${item}, ${idx} -->\n        <!-- if: ${idx} < 3 -->\n        <li>\n            <a href="${item.videoRedir}" class="bkg-hoverable"  target="_blank" title="${item.videoName}" data-area="entity-show">\n                <img src="${item.videoImage}" alt="" />\n                <span class="bkg-show-title">${item.videoName|truncate(6)}</span>\n            </a>\n        </li>\n        <!-- /if -->\n    <!-- /for -->\n    <!-- if: !${show} -->\n        <!-- for: ${representativeWork} as ${work}, ${idx} -->\n            <!-- if: ${idx} < 3 -->\n            <li>\n                <a href="${work.movieRedir}" class="bkg-hoverable" target="_blank" title="${work.movieName}" data-area="entity-representativeWork">\n                    <img src="${work.movieImage}" alt="" />\n                    <span class="bkg-show-title">${work.movieName|truncate(6)}</span>\n                </a>\n            </li>\n            <!-- /if -->\n        <!-- /for -->\n    <!-- /if -->\n    </ul>\n</div>\n\n<!-- target: sidebarTag -->\n<div class="bkg-taglist bkg-sidebar-module bkg-intro-tag">\n    <div class="bkg-module-title">\n        <h4><!-- block: tagModuleTitle -->Ta的那些事儿<!-- /block --></h4>\n    </div>\n    <!-- block: taglist -->\n    <!-- if: ${singleTag} && ${singleTag.length}-->\n    <div class="bkg-tags">\n        <!-- <span>TA的那些事儿:</span> -->\n        <!-- for: ${singleTag} as ${tag}, ${index} -->\n            <!-- if: ${tag.linenum} < 3 -->\n                <a class="${tag.cls}" href="http://www.baidu.com/s?wd=${name|url}%20${tag.text|url}" title="${name} ${tag.text}_百度搜索" data-area="entity-singleTag" target="_blank" style="width:${tag.width};">${tag.text}\n            <!-- /if -->\n        <!-- /for -->\n        </a>\n    </div>\n    <!-- /if -->\n    <!-- /block -->\n</div>\n\n<!-- target: sidebarRelationTag(master=sidebarTag) -->\n<!-- block: tagModuleTitle -->Ta俩那些事儿<!-- /block -->\n<!-- block: taglist -->\n<!-- if: ${pairTag} && ${pairTag.length} -->\n<div class="bkg-tags">\n    <!-- for: ${pairTag} as ${tag}, ${index} -->\n        <!-- if: ${tag.linenum} < 3 -->\n            <a class="${tag.cls}" href="http://www.baidu.com/s?wd=${fromEntity.name|url}%20${toEntity.name|url}%20${tag.text|url}" title="${fromEntity.name} ${toEntity.name} ${tag.text}_百度搜索" data-area="relation-pairTag" target="_blank" style="width: ${tag.width}">${tag.text}\n        <!-- /if -->\n    <!-- /for -->\n    </a>\n</div>\n<!-- /if -->\n<!-- /block -->\n\n<!-- target: sidebarRecommendation -->\n<div class="bkg-taglist bkg-rec-taglist bkg-sidebar-module">\n    <!-- block: tagModuleTitle -->\n    <div class="bkg-module-title">\n        <h4>您可能感兴趣的那些人儿</h4>\n    </div>\n    <!-- /block -->\n    <!-- block: taglist -->\n    <!-- if: ${recommendation} && ${recommendation.length} -->\n    <div class="bkg-rec-tags">\n        <ul>\n            <!-- for: ${recommendation} as ${recTag}, ${index} -->\n                <!-- if: ${index} < 4 -->\n                <li>\n                    <a href="http://www.baidu.com/s?wd=${recTag.name|url}" target="_blank" data-area="entity-recommendation" title="${recTag.name}_百度搜索" class="bkg-hoverable">\n                        <img src="${recTag.image}" alt="">\n                        <h5>${recTag.name|truncate(6)}</h5>\n                    </a>\n                    <a href="http://www.baidu.com/s?wd=${recTag.name|url}" target="_blank" data-area="entity-recommendation" title="${recTag.reason}" class="bkg-rec-reason">\n                        <span>${recTag.reason|truncate(7)}</span>\n                    </a>\n                </li>\n                <!-- /if -->\n            <!-- /for -->\n        </ul>\n    </div>\n    <!-- /if -->\n    <!-- /block -->\n</div>\n\n<!-- target: sidebarRelationRecommendation(master=sidebarRecommendation) -->\n<!-- block: tagModuleTitle -->\n<div class="bkg-module-title">\n    <h4>${recommendation.title}</h4>\n</div>\n<!-- /block -->\n<!-- block: taglist -->\n<!-- if: ${recommendation} -->\n<div class="bkg-tags" style="border-bottom: 1px solid #e6e6e6">\n    <p class="bkg-tag-title"></p>\n    <!-- for: ${recommendation.content} as ${rec}, ${index} -->\n        <!-- if: ${rec.linenum} < 3 -->\n            <a class="${rec.cls}" href="http://www.baidu.com/s?wd=${rec.fromName|url}%20${rec.toName|url}%20${rec.relationName|url}" target="_blank" data-area="relation-recommendation" title="${rec.fromName} ${rec.toName} ${rec.relationName}_百度搜索" style="width: ${rec.width}">\n                ${rec.fromName|truncate(5)}-${rec.toName|truncate(5)}\n        <!-- /if -->\n    <!-- /for -->\n    </a>\n</div>\n<!-- /if -->\n\n<!-- if: ${recommendationnnn} -->\n<div class="bkg-rec-tags">\n    <p class="bkg-tag-title">${recommendation.title}</p>\n    <ul>\n        <!-- for: ${recommendation.content} as ${rec}, ${index} -->\n        <li>\n            <a class="bkg-rec-tag-pic" href="http://www.baidu.com/s?wd=${rec.fromName|url}%20${rec.toName|url}%20${rec.relationName|url}" target="_blank" data-area="relation-recommendation" title="${rec.fromName} ${rec.toName} ${rec.relationName}_百度搜索">\n                <img src="${rec.image}" class="bkg-hoverable" alt="">\n                <!-- <h5></h5> -->\n            </a>\n            <a href="http://www.baidu.com/s?wd=${rec.fromName|url}%20${rec.toName|url}%20${rec.relationName|url}" target="_blank" data-area="relation-recommendation" title="${rec.fromName} ${rec.toName} ${rec.relationName}_百度搜索">\n                <span>${rec.fromName|truncate(5)}<br>${rec.toName|truncate(5)}</span>\n            </a>\n        </li>\n        <!-- /for -->\n    </ul>\n</div>\n<!-- /if -->\n<!-- /block -->\n'}),r("text!bkgraph/html/sidebar.html",[],function(){return'<div class="bkg-sidebar-module bkg-sidebar-intro">\n    <!-- if: ${isRelation} -->\n        <div class="bkg-relation-info">\n            <div class="bkg-relation-entity-wrapper">\n                <div class="bkg-relation-entity">\n                    <div class="bkg-relation-entity-from">\n                        <a href="http://www.baidu.com/s?wd=${fromEntity.name|url}" target="_blank" data-area="relation-info-entity" title="${fromEntity.name}_百度搜索" class="bkg-hoverable">\n                            <img src="${fromEntity.image }" alt="">\n                            <h5>${fromEntity.name}</h5>\n                        </a>\n                    </div>\n                    <div class="bkg-relation-name">\n                        <a href="http://www.baidu.com/s?wd=${fromEntity.name|url}%20${toEntity.name|url}%20${relationName|url}" title="${fromEntity.name}${toEntity.name} ${relationName}_百度搜索" data-area="relation-info-title" target="_blank"><span>${relationName|truncate(6)}</span></a>\n                    </div>\n                    <div class="bkg-relation-entity-to">\n                        <a href="http://www.baidu.com/s?wd=${toEntity.name|url}" target="_blank" data-area="relation-info-entity" title="${toEntity.name}_百度搜索" class="bkg-hoverable">\n                            <img src="${toEntity.image }" alt="">\n                            <h5>${toEntity.name}</h5>\n                        </a>\n                    </div>\n                </div>\n            </div>\n            <!-- if: ${relationExplaination} -->\n            <div class="bkg-relation-description">\n                <p>\n                    <!-- <span>关系简介</span>  -->\n                    ${relationExplaination.text|truncate(50)}\n                    <a href="${relationExplaination.url}" class="bkg-more" title="更多" data-area="relation-info-desc" target="_blank">更多 ></a>\n                </p>\n            </div>\n            <!-- /if -->\n        </div>\n    <!-- else -->\n        <div class="bkg-person-info">\n            <a class="bkg-person-pic bkg-hoverable" href="http://www.baidu.com/s?wd=${name|url}" data-area="entity-baike-pic" target="_blank" title="${name}_百度搜索"><img src="${image}" /></a>\n            <div class="bkg-person-description">\n                <p>\n                    <span class="bkg-person-name">\n                        <a href="http://www.baidu.com/s?wd=${name|url}" data-area="entity-baike-name" target="_blank" title="${name}_百度搜索">${name}</a>\n                    </span>\n                    <!-- <b>简介:</b> -->\n                    ${introduction.content|truncate(46)}\n                    <a href="http://www.baidu.com/s?wd=${name|url}" class="bkg-more" data-area="entity-baike-more" title="更多" target="_blank">更多 ></a>\n                </p>\n            </div>\n        </div>\n    <!-- /if -->\n</div>\n<div class="bkg-sidebar-viewport">\n    <div class="bkg-sidebar-dimup bkg-hidden"></div>\n    <!--  if: (${isRelation} && (${eventMaiLuo} || (${recommendation} && ${pairTag})))\n        || (!${isRelation} && ${singleTag} && (${representativeWork} || ${recommendation}))\n        || (!${isRelation} && !(!${singleTag} && !${representativeWork} && !${show} && ${recommendation})\n            && !(!${singleTag} && !${representativeWork} && !${show} && !${recommendation})\n            && !(${singleTag} && !${representativeWork} && !${show} && !${recommendation})\n        )\n    -->\n        <div class="bkg-sidebar-dimbottom"></div>\n    <!-- /if -->\n    <div class="bkg-sidebar-content">\n        <!-- if: ${isRelation} -->\n\n            <!-- if: ${pairTag} && ${pairTag.length}-->\n                <!-- import: sidebarRelationTag -->\n            <!-- /if -->\n\n            <!-- 没有tag和脉络 -->\n            <!-- if: !${pairTag} && !${eventMaiLuo} -->\n                <!-- if: ${recommendation} -->\n                    <!-- import: sidebarRelationRecommendation -->\n                <!-- /if -->\n            <!-- else -->\n                <!-- 默认隐藏 -->\n                <div class="bkg-sidebar-fold bkg-hidden">\n                    <!-- if: ${eventMaiLuo} -->\n                        <!-- import: sidebarMailuo -->\n                    <!-- /if -->\n\n                    <!-- if: ${recommendation} -->\n                        <!-- import: sidebarRelationRecommendation -->\n                    <!-- /if -->\n                </div>\n\n                <!-- if: ${eventMaiLuo} || ${recommendation} -->\n                    <div class="bkg-toggle"><i class="bkg-toggle-btn"></i></div>\n                <!-- /if -->\n            <!-- /if -->\n\n        <!-- else -->\n\n            <!-- if: ${singleTag} && ${singleTag.length}-->\n                <!-- import: sidebarTag -->\n            <!-- /if -->\n\n            <!-- 没有tag -->\n            <!-- if: !${singleTag} && !${representativeWork} && !${show} -->\n                <!-- if: ${recommendation} && ${recommendation.length}-->\n                    <!-- import: sidebarRecommendation -->\n                <!-- /if -->\n            <!-- else -->\n                <!-- 默认隐藏 -->\n                <div class="bkg-sidebar-fold bkg-hidden">\n                    <!-- if: ${representativeWork} -->\n                        <!-- import: sidebarWorks -->\n                    <!-- /if -->\n\n                    <!-- if: ${show} -->\n                        <!-- import: sidebarShow -->\n                    <!-- /if -->\n\n                    <!-- if: ${recommendation} && ${recommendation.length} -->\n                        <!-- import: sidebarRecommendation -->\n                    <!-- /if -->\n                </div>\n            <!-- /if -->\n\n            <!-- todo: crazy -->\n            <!-- if: (${singleTag} && (${representativeWork} || ${show} || ${recommendation}))\n                || (!(!${singleTag} && !${representativeWork} && !${show} && ${recommendation})\n                    && !(!${singleTag} && !${representativeWork} && !${show} && !${recommendation})\n                    && !(${singleTag} && !${representativeWork} && !${show} && !${recommendation})\n                    )\n            -->\n                <div class="bkg-toggle"><i class="bkg-toggle-btn"></i></div>\n            <!-- /if -->\n\n        <!-- /if -->\n    </div>\n</div>\n'}),r("bkgraph/component/SideBar",["require","./Component","zrender/core/util","etpl","Sizzle","../util/util","../util/log","../util/ScrollBar","text!../html/sideBarModule.html","text!../html/sidebar.html"],function(e){var t=e("./Component"),n=e("zrender/core/util"),r=e("etpl"),i=e("Sizzle"),s=e("../util/util"),o=e("../util/log"),u=e("../util/ScrollBar");r.compile(e("text!../html/sideBarModule.html"));var a=r.compile(e("text!../html/sidebar.html")),f=function(){t.call(this),this._scrollbar=null,this._isFold=!0;var e=this;s.addEventListener(this.el,"click",function(t){e._dispatchClick(t)}),s.addEventListener(this.el,"mouseenter",function(t){o({type:"zhishitupuhover",target:e._logParam,area:"sidebar"})})};return f.prototype.type="SIDEBAR",f.prototype.initialize=function(e,t){return this.el.className="bkg-sidebar hidden",this._$wrapper=document.createElement("div"),this._$wrapper.className="bkg-sidebar-wrapper",this.el.appendChild(this._$wrapper),this._$closeBtn=document.createElement("div"),this._$closeBtn.className="bkg-sidebar-close",this.el.appendChild(this._$closeBtn),this._kgraph=e,this.el},f.prototype.resize=function(e,t){var n=t-this._$intro.clientHeight-100,r=this._$viewport.clientHeight,i=this._$content.clientHeight;this._scrollbar?i<n?(this._$viewport.style.height=i+"px",this.el.style.height=this._$intro.clientHeight+i+"px"):(this._$viewport.style.height=n+"px",this.el.style.height=t-100+"px"):r>n&&this._forScroll(),this._scrollbar&&this._scrollbar.resize()},f.prototype.setData=function(e,t){this._scrollbar&&(this._scrollbar=null),this._fixData(e,t),this.render(e,t)},f.prototype._fixData=function(e,t){if(e._isfixed)return;e.show&&(e.showName="最新综艺"),e.representativeWork&&(e.representativeWorkName="热门作品");if(t&&e.eventMaiLuo){var n=0;for(var r=0,i=e.eventMaiLuo.length;r<i;r++){var s=e.eventMaiLuo[r],o=s.publishTime,u=o.substring(0,o.indexOf("-"));s.publishTime=o.substring(o.indexOf("-")+1,o.length),n!=u&&(n=u,s.year=u)}}var a=linenum=0,f=-1,l={},c,h=e.singleTag||e.pairTag;if(h){for(var r=0,i=h.length;r<i;r++){c=h[r],a<9?a+=c.text.length:(linenum++,a=c.text.length),c.linenum=linenum,l[linenum]=a;if(linenum>=3)break}for(var r=0,i=h.length;r<i;r++){c=h[r],c.linenum<3&&(c.width=Math.floor(c.text.length*298/l[c.linenum])+"px"),c.linenum!=f&&(c.cls=" no-left-border ");if(c.linenum==2||linenum==c.linenum)c.cls=(c.cls||"")+" no-bottom-border";f=c.linenum}}if(t&&e.recommendation){h=e.recommendation.content,a=linenum=0,f=-1;for(var r=0,i=h.length;r<i;r++){c=h[r],a<12?a+=(c.fromName.length>6?6:c.fromName.length)+(c.toName.length>6?6:c.toName.length)+1:(linenum++,a=(c.fromName.length>6?6:c.fromName.length)+(c.toName.length>6?6:c.toName.length)+1),c.linenum=linenum,l[linenum]=a;if(linenum>=3)break}for(var r=0,i=h.length;r<i;r++){c=h[r],c.linenum<3&&(c.width=Math.floor(((c.fromName.length>6?6:c.fromName.length)+(c.toName.length>6?6:c.toName.length)+1)*298/l[c.linenum])+"px"),c.linenum!=f&&(c.cls=" no-left-border ");if(c.linenum==2||linenum==c.linenum)c.cls=(c.cls||"")+" no-bottom-border";f=c.linenum}}e._isfixed=!0},f.prototype.render=function(e,t){t?this._logParam=[e.fromID,e.fromEntity.layerCounter,e.toID,e.toEntity.layerCounter,e.id,e.isExtra?1:0,e.isSpecial?1:0].join(","):this._logParam=e.id+","+e.layerCounter,e.isRelation=t,this._$wrapper.innerHTML=a(e),this._$intro=i(".bkg-sidebar-intro",this.el)[0],this._$introTag=i(".bkg-intro-tag",this.el)[0],this._$toggle=i(".bkg-toggle",this.el)[0],this._$fold=i(".bkg-sidebar-fold",this.el)[0],this._$viewport=i(".bkg-sidebar-viewport",this.el)[0],this._$content=i(".bkg-sidebar-content",this.el)[0];var n=i(".bkg-relation-name span",this.el)[0];n&&(n.style.top=-n.clientHeight-10+"px");var r=this._$intro.clientHeight+this._$content.clientHeight;this.el.style.height=r+"px"},f.prototype.show=function(e){if(s.hasClass(this.el,"hidden")){s.removeClass(this.el,"hidden");var t=this._$intro.clientHeight+this._$content.clientHeight;this.el.style.height=t+"px",o({type:"zhishitupushow",target:e,area:"sidebar"})}},f.prototype.hide=function(e,t){if(!s.hasClass(this.el,"hidden")){this.el.style.height=0;var n=this;setTimeout(function(){s.addClass(n.el,"hidden"),t&&t()},150),o({type:"zhishitupuhide",target:e,area:"sidebar"})}},f.prototype.toggle=function(e){s.hasClass(this.el,"hidden")?this.show(e):this.hide(e)},f.prototype.fold=function(e){s.hasClass(this._$fold,"bkg-hidden")||(s.removeClass(this._$toggle,"bkg-toggle-fold"),s.addClass(this._$fold,"bkg-hidden"),this._isFold=!0,this._forScroll(),o({type:"zhishitupufold",target:e,area:"sidebar"}))},f.prototype.unfold=function(e){s.hasClass(this._$fold,"bkg-hidden")&&(s.addClass(this._$toggle,"bkg-toggle-fold"),s.removeClass(this._$fold,"bkg-hidden"),this._isFold=!1,this._forScroll(),o({type:"zhishitupuunfold",target:e,area:"sidebar"}))},f.prototype._forScroll=function(){var e=document.body.clientHeight-this._$intro.clientHeight-100,t=this._$viewport.clientHeight,n=this._$content.clientHeight;this._isFold?(this._scrollbar&&(this._scrollbar.scrollTo(0),this._$viewport.style.height&&(this._$viewport.style.height=this._$content.clientHeight+"px",this._scrollbar.destory(),this._scrollbar=null)),this.el.style.height=this._$intro.clientHeight+this._$content.clientHeight+"px"):this._$content.clientHeight>e?(this._$viewport.style.height=e+"px",this._scrollbar||(this._scrollbar=new u(this._$content)),this._scrollbar.scrollTo(0),this._scrollbar.resize(),this.el.style.height=document.body.clientHeight-100+"px"):(this._$viewport.style.height=this._$content.clientHeight+"px",this.el.style.height=this._$intro.clientHeight+this._$content.clientHeight+"px")},f.prototype.toggleFold=function(e){s.hasClass(this._$fold,"bkg-hidden")?this.unfold(e):this.fold(e)},f.prototype._dispatchClick=function(e){var t=e.target||e.srcElement;i.matchesSelector(t,".bkg-sidebar-close")&&this.toggle(this._logParam),(i.matchesSelector(t,".bkg-toggle")||i.matchesSelector(t,".bkg-toggle-btn"))&&this.toggleFold(this._logParam);var n=t;while(n&&n.nodeName.toLowerCase()!=="a")n=n.parentNode;if(n){var r=n.getAttribute("data-area");o({type:"zhishitupulink",target:[this._logParam,n.getAttribute("title"),n.getAttribute("href")].join(","),area:"sidebar-"+r})}},n.inherits(f,t),f}),r("text!bkgraph/html/searchResult.html",[],function(){return'<!-- target: searchResult -->\n<!-- if: ${interests} -->\n<div class="bkg-search-interest">\n    <p>您可能感兴趣的关系图谱：</p>\n    <ul>\n        <!-- for: ${interests} as ${entity}, ${index} -->\n            <!-- if: ${index} < 4 -->\n            <li>\n                <a href="/tupu/${entity.id}.html" target="_blank" data-area="headerbar-interest" title="${entity.name}_人物关系图谱" class="bkg-interest-img">\n                    <img src="${entity.image}" alt="">\n                </a>\n                <a href="/tupu/${entity.id}.html" target="_blank" data-area="headerbar-interest" title="${entity.name}_人物关系图谱" class="bkg-interest-name">\n                    <span>${entity.name}</span>\n                </a>\n            </li>\n            <!-- /if -->\n        <!-- /for -->\n    </ul>\n</div>\n<!-- elif: ${entities} -->\n<ul class="bkg-search-list">\n    <!-- if: ${entities.length} > 0 -->\n        <!-- for: ${entities} as ${entity}, ${index} -->\n            <!-- if: ${entities.length} == 1 && ${entity.isme} -->\n                <li class="bkg-search-nodata bkg-search-isme">\n                    <p>您已经在${entity.n}的图谱中了,看看他们吧！</p>\n                </li>\n            <!-- elif: ${index} < 10 && !${entity.isme} -->\n                <!-- if: ${index} == 0 -->\n                    <li title="${entity.n}_人物关系图谱" class="bkg-active">\n                <!-- else -->\n                    <li title="${entity.n}_人物关系图谱">\n                <!-- /if -->\n                        <a href="/tupu/${entity.id}.html" target="_blank">${entity.n}</a>\n                    </li>\n            <!-- /if -->\n        <!-- /for -->\n    <!-- else -->\n        <li class="bkg-search-nodata">\n            <p>暂时没有Ta的关系图谱</p>\n            <a href="http://www.baidu.com/s?wd=${name|url}" target="_blank" data-area="nodata">百度一下 "<span>${name|truncate(14)}</span>"</a>\n        </li>\n    <!-- /if -->\n</ul>\n<!-- /if -->'}),r("text!bkgraph/html/headerBar.html",[],function(){return'<div class="bkg-bg"></div>\n\n<!-- <div class="bkg-logo"></div> -->\n<h1>${name}</h1>\n<!-- <div class="bkg-explore-percent">\n    <span class="bkg-explore-percent-prefix">您已经是TA的</span>\n    <span class="bkg-explore-percent-bar">\n        <span class="bkg-explore-percent-bar-inner"></span> -->\n        <!-- for: ${levels} as ${level}, ${index} -->\n        <!-- <div class="bkg-milestone" style="left:${level.position}%;"></div> -->\n        <!-- /for -->\n    <!-- </span> -->\n    <!-- for: ${levels} as ${level}, ${index} -->\n    <!-- <div class="bkg-level-${index} bkg-level" style="width:${level.interval}%; left:${level.position}%">\n        <div class="bkg-level-icon"></div>\n        <div class="bkg-level-title">${level.title}</div>\n    </div> -->\n    <!-- /for -->\n<!-- </div> -->\n<div class="bkg-search">\n    <div class="bkg-search-input">\n        <input type="text" placeholder="输入姓名 查看图谱">\n        <i class="bkg-search-btn"></i>\n    </div>\n\n    <div class="bkg-search-result">\n        <!-- import: searchResult -->\n    </div>\n</div>\n<div class="bkg-share">\n    <i class="bkg-share-btn"></i>\n</div>\n<ul class="bkg-share-area hidden bkg-hidden">\n    <li class="bkg-share-weibo" data-type="weibo"></li>\n    <!-- <li class="bkg-share-wechat" data-type="wechat"></li>\n    <li class="bkg-share-weixin" data-type="weixin"></li> -->\n</ul>\n<!-- <div class="bkg-share">分享</div> -->'}),r("bkgraph/component/HeaderBar",["require","./Component","zrender/core/util","etpl","../util/util","../util/log","Sizzle","../util/jsonp","text!../html/searchResult.html","text!../html/headerBar.html","../config"],function(e){var t=e("./Component"),n=e("zrender/core/util"),r=e("etpl"),i=e("../util/util"),s=e("../util/log"),o=e("Sizzle"),u=e("../util/jsonp"),a=r.compile(e("text!../html/searchResult.html")),f=r.compile(e("text!../html/headerBar.html")),l=e("../config"),c=l.levels,h=l.share,p=function(){t.call(this),this._graphCollapsed=!0;var e=this;i.addEventListener(this.el,"click",function(t){e._dispatchClick(t)})};return p.prototype.type="HEADERBAR",p.prototype.initialize=function(e,t){var n=this.el;n.className="bkg-headerbar",this._kgraph=e,this.setData(t);var r=this;i.addEventListener(this._$inputArea,"click",function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),r.filter(r._$input.value)});var s="keydown",u=navigator.userAgent.toLowerCase();if(u.indexOf("firefox")>0||u.indexOf("msie")>0)s="keyup";i.addEventListener(this._$input,s,i.debounce(function(e){var t=o(".bkg-search-list",this.el)[0],n=o(".bkg-search-list li",this.el),s=o(".bkg-search-list .bkg-active",this.el)[0],u=0;for(var a=0,f=n.length;a<f;a++)if(i.hasClass(n[a],"bkg-active")){u=a;break}switch(e.keyCode){case 13:var l=o(".bkg-search-list .bkg-active a",this.el)[0];l&&window.open(l.getAttribute("href"));break;case 38:s&&i.removeClass(s,"bkg-active"),u--,u<0&&(u=f-1),i.addClass(n[u],"bkg-active");break;case 40:s&&i.removeClass(s,"bkg-active"),u++,u>f-1&&(u=0),i.addClass(n[u],"bkg-active");break;default:r.filter(r._$input.value)}},200)),i.addEventListener(o("body")[0],"click",function(e){var t=e.target||e.srcElement,n=t;while(n&&n.nodeName.toLowerCase()!=="a")n=n.parentNode;n||(r._$input.value="",r._$searchResult.innerHTML="",i.removeClass(r._$share,"bkg-share-btn-active"),i.addClass(r._$shareList,"hidden"),setTimeout(function(){i.addClass(r._$shareList,"bkg-hidden")},300))}),i.addEventListener(this._$searchResult,"mouseover",function(e){var t=e.target||e.srcElement,n=t;while(n&&n.nodeName.toLowerCase()!=="li")n=n.parentNode;var r=o(".bkg-search-list .bkg-active",this.el)[0];r&&n!==r&&(i.removeClass(r,"bkg-active"),i.addClass(n,"bkg-active"))}),i.addEventListener(this._$share,"click",function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),i.hasClass(r._$shareList,"hidden")?(i.removeClass(r._$shareList,"bkg-hidden"),setTimeout(function(){i.removeClass(r._$shareList,"hidden")},100),i.addClass(r._$share,"bkg-share-btn-active")):(i.addClass(r._$shareList,"hidden"),setTimeout(function(){i.addClass(r._$shareList,"bkg-hidden")},300),i.removeClass(r._$share,"bkg-share-btn-active"))});var a=o(".bkg-share",this.el);i.addEventListener(this._$shareList,"click",function(e){var t=e.target||e.srcElement;if(t.nodeName.toLowerCase()=="li"){var n=t.getAttribute("data-type");switch(n){case"weibo":r.weiboShare(e)}}})},p.prototype.setData=function(e){this.render({name:document.title,levels:c})},p.prototype.render=function(e){this.el.innerHTML=f(e),this._$levels=o(".bkg-level",this.el),this._$inputArea=o(".bkg-search-input",this.el)[0],this._$input=o(".bkg-search-input input",this.el)[0],this._$searchResult=o(".bkg-search-result",this.el)[0],this._$share=o(".bkg-share",this.el)[0],this._$shareList=o(".bkg-share-area",this.el)[0]},p.prototype.setExplorePercent=function(e){e=Math.max(e*100,1),o(".bkg-explore-percent-bar-inner",this.el)[0].style.width=e+"%";for(var t=0;t<c.length;t++)i.removeClass(this._$levels[t],"bkg-active");for(var t=0;t<c.length;t++)c[t].position<=e&&(!c[t+1]||c[t+1].position>e)&&i.addClass(this._$levels[t],"bkg-active")},p.prototype.filter=function(e){var t=this,n={},r="";if(e){var i=this._kgraph.getDetailAPI();u(i,{act:"tpuser",mt:"use",ver:"v1",q:e},"callback",function(i){if(l.isPlat)return;n={entities:i.data||[],name:e},t._$searchResult.innerHTML=a(n),i.data||(r="nodata"),s({type:"zhishitupusearch",target:e,area:"headerbar",extend:r})})}else n={interests:this._kgraph.getRawData()&&this._kgraph.getRawData().interests,name:e},this._$searchResult.innerHTML=a(n)},p.prototype.weiboShare=function(e){var t=this._$levels;for(var n=0,r=t.length;n<r;n++)if(o.matchesSelector(t[n],".bkg-active"))break;if(n<0)return;var i=Math.floor(Math.random()*h.length+1)-1,u=h[i].replace("{name}",document.title.substring(0,document.title.indexOf(" "))),a={url:document.URL,appkey:"",ralateUid:"",title:u,pic:"",language:"zh_cn"},f=[];for(var l in a)a[l]&&f.push(l+"="+encodeURIComponent(a[l]));var c="http://service.weibo.com/share/share.php?"+f.join("&"),p=100,d=400,v=(screen.width-d)/2,m=(screen.height-p)/2;window.open(c,"newwindow","height="+p+",width="+d+",left="+v+",top="+m),s({type:"zhishitupuweibo",target:JSON.stringify(u)})},p.prototype._dispatchClick=function(e){var t=e.target||e.srcElement,n=t;while(n&&n.nodeName.toLowerCase()!=="a")n=n.parentNode;var r=this._kgraph.getRawData()&&this._kgraph.getRawData().mainEntity.id;if(n){var i=n.getAttribute("data-area");s({type:"zhishitupulink",target:[r,n.getAttribute("title"),n.getAttribute("href")].join(","),area:"headerbar-"+i})}},n.inherits(p,t),p}),r("bkgraph/component/KeyboardControl",["require","./Component","zrender/core/util","../util/util","../util/log"],function(e){var t=e("./Component"),n=e("zrender/core/util"),r=e("../util/util"),i=e("../util/log"),s=function(){t.call(this)};return s.prototype.type="KEYBOARDCONTROL",s.prototype.initialize=function(e){this._kgraph=e;var t=e.getComponentByType("GRAPH");if(!t)return;var n=this;t.el.setAttribute("tabindex",0),r.addEventListener(t.el,"keydown",function(t){var n=e.getComponentByType("GRAPH");switch(t.keyCode){case 87:case 38:i({type:"zhishitupukeyboard",target:"up"}),n.moveTop();break;case 83:case 40:i({type:"zhishitupukeyboard",target:"down"}),n.moveDown();break;case 65:case 37:i({type:"zhishitupukeyboard",target:"left"}),n.moveLeft();break;case 68:case 39:i({type:"zhishitupukeyboard",target:"right"}),n.moveRight();break;case 81:i({type:"zhishitupukeyboard",target:"zoomout"}),n.zoomOut();break;case 69:i({type:"zhishitupukeyboard",target:"zoomin"}),n.zoomIn()}})},n.inherits(s,t),s}),r("bkgraph/component/PanControl",["require","./Component","zrender/core/util","../util/util"],function(e){function o(e,n){t.call(this),this._onMouseMove=r.bind(this._onMouseMove,this),this._onMouseDown=r.bind(this._onMouseDown,this),this._onMouseUp=r.bind(this._onMouseUp,this),this._x=0,this._y=0}var t=e("./Component"),n=e("zrender/core/util"),r=e("../util/util"),i=r.addEventListener,s=r.removeEventListener;return o.prototype={constructor:o,type:"PANCONTROL",initialize:function(e){this._kgraph=e;var t=e.getComponentByType("GRAPH");if(!t)return;var n=t.el;this._target=t.getGraphRoot(),this._graphMain=t,i(n,"mousedown",this._onMouseDown)},_onMouseDown:function(e){i(document.body,"mousemove",this._onMouseMove),i(document.body,"mouseup",this._onMouseUp),this._sx=e.screenX,this._sy=e.screenY},_onMouseMove:function(e){var t=e.screenX,n=e.screenY,r=t-this._sx,i=n-this._sy;this._x+=r,this._y+=i;var s=this._graphMain.getZR();if(s.painter.getVMLRoot){var o=s.painter.getVMLRoot();o.style.left=Math.round(this._x)+"px",o.style.top=Math.round(this._y)+"px"}else{var u=this._target;u.position[0]=this._x,u.position[1]=this._y,u.dirty()}this._sx=t,this._sy=n},_onMouseUp:function(e){s(document.body,"mousemove",this._onMouseMove),s(document.body,"mouseup",this._onMouseUp)}},o}),r("bkgraph/component/Loading",["require","./Component","zrender/core/util","../util/util"],function(e){var t=e("./Component"),n=e("zrender/core/util"),r=e("../util/util"),i=function(){t.call(this),this._frameNumber=2,this._currentFrame=0,this._frameWidth=180};return i.prototype.type="LOADING",i.prototype.initialize=function(e,t){this._kgraph=e,this.el.className="bkg-loading",this._$animationEl=document.createElement("div"),this._$animationEl.className="bkg-loading-animation";var n=document.createElement("div");n.className="bkg-loading-tip",n.innerHTML="努力加载中",this.el.appendChild(this._$animationEl),this._$animationEl.appendChild(n);var r=this;this._interval=setInterval(function(){r._animationFrame()},500)},i.prototype._animationFrame=function(){this._currentFrame=(this._currentFrame+1)%this._frameNumber;var e=this._frameWidth*this._currentFrame;this._$animationEl.style.backgroundPosition=-e+"px 0px"},i.prototype.dispose=function(){clearInterval(this._interval)},n.inherits(i,t),i}),r("bkgraph/component/Tip",["require","./Component","zrender/core/util","etpl","Sizzle","../util/util","../util/log"],function(e){var t=e("./Component"),n=e("zrender/core/util"),r=e("etpl"),i=e("Sizzle"),s=e("../util/util"),o=e("../util/log"),u=function(){t.call(this),this._isMouseenter=!1,this._direction="left";var e=this};return u.prototype.type="TIP",u.prototype.initialize=function(e,t){return this._kgraph=e,this.el.className="bkg-tip-wrapper hidden",this._$arrow=document.createElement("div"),this._$tip=document.createElement("div"),this._$tip.className="bkg-tip",this._$content=document.createElement("div"),this._$content.className="bkg-tip-content",this._$tip.appendChild(this._$content),this.el.appendChild(this._$arrow),this.el.appendChild(this._$tip),this.el},u.prototype.setData=function(e,t,n,r){this.render(e,t,n,r)},u.prototype.render=function(e,t,n,r){this._direction=this._getDirection(t,n),e.arrowType=this._direction,this._$arrow.className="bkg-tip-arrow "+this._direction,this._$content.innerHTML=e,this._setPosition(this._direction,t,n),this.show(),r&&r()},u.prototype._getDirection=function(e,t){var n=e.entity.el.position,r=n[0],i=n[1];t&&(r=e.entity.getShape("labelLine").style.cx,i=e.entity.getShape("labelLine").style.cy);var s=this._kgraph.getComponentByType("GRAPH"),o=s.getZR(),u=o.painter.getLayer(0);r+=u.position[0],i+=u.position[1];var a=u.__zoom||1;r*=a,i*=a;var f=document.body.clientWidth,l=document.body.clientHeight,c=this._direction;return r>f*.75?(c="right",i>l*.85&&(c="bottom"),i<l*.15&&(c="top")):(i>l*.85&&(c="bottom"),i<l*.15&&(c="top")),c},u.prototype._setPosition=function(e,t,n){var r=t.entity.el.position,i=r[0],o=r[1];n&&(i=t.entity.getShape("labelLine").style.cx,o=t.entity.getShape("labelLine").style.cy);var u=this._kgraph.getComponentByType("GRAPH"),a=u.getZR(),f=a.painter.getLayer(0),l=f.__zoom||1;i*=l,o*=l,i+=f.position[0],o+=f.position[1];var c=s.getStyle(this.el);switch(e){case"top":i-=parseInt(c.width)/2+parseInt(c.paddingLeft),n?o+=t.entity.getShape("labelLine").style.r:o+=(parseInt(c.paddingBottom)+10)*l;break;case"right":o-=parseInt(c.height)/2+parseInt(c.paddingTop),n?i-=parseInt(c.width)+t.entity.getShape("labelLine").style.r*1.5:i-=parseInt(c.width)+t.entity.radius+10,i-=parseInt(c.paddingLeft)+15;break;case"bottom":i-=parseInt(c.width)/2+parseInt(c.paddingLeft),n?o-=parseInt(c.height)+t.entity.getShape("labelLine").style.r*2:o-=parseInt(c.height)+t.entity.radius+10,o-=parseInt(c.paddingBottom)*l+15;break;case"left":o-=parseInt(c.height)/2+parseInt(c.paddingLeft),n?i+=t.entity.getShape("labelLine").style.r*1.5*l:i+=t.entity.radius*l+10,i-=(parseInt(c.paddingLeft)-15)*l}this.el.style.left=i+"px",this.el.style.top=o+"px"},u.prototype.show=function(){s.hasClass(this.el,"hidden")&&(s.removeClass(this.el,"hidden"),o({type:"zhishitupushow",target:this._logParam,area:"tip"}))},u.prototype.hide=function(){!s.hasClass(this.el,"hidden")&&!this._isMouseenter&&(s.addClass(this.el,"hidden"),o({type:"zhishitupuhide",target:this._logParam,area:"tip"}))},u.prototype.toggle=function(){s.hasClass(this.el,"hidden")?this.show(this._logParam):this.hide(this._logParam)},u.prototype._dispatchClick=function(e){var t=e.target||e.srcElement,n=t;while(n&&n.nodeName.toLowerCase()!=="a")n=n.parentNode;if(n){var r=n.getAttribute("data-area");o({type:"zhishitupulink",target:[this._logParam,n.getAttribute("title"),n.getAttribute("href")].join(","),area:"tip-"+r})}},u.prototype.getDirection=function(){return this._direction},n.inherits(u,t),u}),r("bkgraph/bkgraph",["require","text!./util/asciiEcharts","./component/GraphMain","./component/SideBar","./component/HeaderBar","./component/KeyboardControl","./component/PanControl","./component/Loading","./component/Tip","etpl","./util/jsonp","./util/util","./util/log"],function(e){function p(e,t,n){c({type:"zhishitupuopen"}),typeof e=="string"&&(e=document.getElementById(e));var r=new h(e,t,n);return r}typeof console!="undefined"&&console.log&&(console.log(e("text!./util/asciiEcharts")),console.log("\n\n\n%chttp://echarts.baidu.com","font-size:14px;"));var t=e("./component/GraphMain"),n=e("./component/SideBar"),r=e("./component/HeaderBar"),i=e("./component/KeyboardControl"),s=e("./component/PanControl"),o=e("./component/Loading"),u=e("./component/Tip"),a=e("etpl"),f=e("./util/jsonp"),l=e("./util/util"),c=e("./util/log");a.addFilter("truncate",l.truncate),a.addFilter("trim",l.trim);var h=function(e,t,n){this._container=e,this._components=[],this._detailAPI=t,this._width=0,this._height=0,this._root=document.createElement("div"),this._root.className="bkg-viewport",this._root.style.position="relative",this._root.style.overflow="hidden",this._container.appendChild(this._root),this.resize();var i=new r;this.addComponent(i);var s=new o;this.addComponent(s);var u=this;c({type:"zhishitupuapistart"}),f(t,"callback",function(e){c({type:"zhishitupuapiend"});if(!e){u.removeComponent(s);return}e=u._fixData(e),u._rawData=e,u.initialize(e),n&&n(u)})};h.prototype._fixData=function(e){if(!e.entities||!e.relations)return;for(var t=0;t<e.entities.length;t++){var n=e.entities[t];n.layerCounter=n.layerCounter||0,n.layerCounter=parseInt(n.layerCounter),n.layerCounter===0&&(e.mainEntity=n)}var r={};for(var i=0;i<e.relations.length;i++){var s=e.relations[i];s.isExtra&&(r[s.fromID]||(r[s.fromID]=[]),r[s.toID]||(r[s.toID]=[]),r[s.fromID].length>=2||r[s.toID].length>=2?e.relations.splice(i--,1):(r[s.fromID].push(s.id),r[s.toID].push(s.id)))}return e},h.prototype.getRawData=function(){return this._rawData},h.prototype.initialize=function(e){var n=this.getComponentByType("loading");n&&this.removeComponent(n);var r=new t;this.addComponent(r);var i=new u;this.addComponent(i);var s=l.getURLSearch();e&&(s.relation&&(r.enableEntryAnimation=!1),r.setData(e));var o=[],a=e.mainEntity;for(var f=0,c=e.relations.length;f<c;f++)e.relations[f].fromID==a.id&&o.push(e.relations[f]);o.sort(function(e,t){return t.relationWeight-e.relationWeight}),s.relation?setTimeout(function(){r.activeEdge(s.relation),r.moveToRelation(s.relation),r.showRelationDetail(s.relation,!0)}):s.entity?setTimeout(function(){r.activeNode(s.entity),r.moveToEntity(s.entity),r.showEntityDetail(s.entity,!0)}):setTimeout(function(){r.showEntityDetail(e.mainEntity,!1),r.showEdgeClickTip(o[0].id)})},h.prototype.addComponent=function(e){this._components.push(e),e.el&&e.el.nodeType===1&&this._root.appendChild(e.el),e.initialize(this,this._rawData)},h.prototype.removeComponent=function(e){this._components.splice(l.indexOf(this._components,e),1),e.el&&e.el.nodeType===1&&this._root.removeChild(e.el),e.dispose()},h.prototype.getComponentsAllByType=function(e){var t=[];for(var n=0;n<this._components.length;n++)this._components[n].type.toUpperCase()===e.toUpperCase()&&t.push(this._components[n]);return t},h.prototype.getComponentByType=function(e){for(var t=0;t<this._components.length;t++)if(this._components[t].type.toUpperCase()===e.toUpperCase())return this._components[t];return null},h.prototype.resize=function(){var e=this._container,t=e.currentStyle||window.getComputedStyle(e);this._width=e.clientWidth||parseInt(t.width),this._height=e.clientHeight||parseInt(t.height),this._root.style.width=this._width+"px",this._root.style.height=this._height+"px";for(var n=0;n<this._components.length;n++)this._components[n].resize(this._width,this._height)},h.prototype.getWidth=function(){return this._width},h.prototype.getHeight=function(){return this._height},h.prototype.getRoot=function(){return this._root},h.prototype.getDetailAPI=function(){return this._detailAPI};var d={SideBar:n,KeyboardControl:i,PanControl:s,HeaderBar:r,init:p};return d}),r("bkgraph",["bkgraph/bkgraph"],function(e){return e});var i=n("bkgraph");for(var s in i)e[s]=i[s]});